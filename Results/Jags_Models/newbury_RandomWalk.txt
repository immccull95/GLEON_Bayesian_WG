######################################################################################################
######################################################################################################
#### JAGS model file written by runjags version 2.0.4-2 on 2019-04-10 20:18:39 
######################################################################################################
######################################################################################################

model{
for(i in 1:N){
#this fits the blended model to your observed data. 
y[i] ~ dpois(m[i])
#when comparing these values to the data, we need to exponentiate
m[i] <- exp(mu[i]) 
}
#### Process Model
for(i in 2:N){
mu[i]~dnorm(mu[i-1],tau_add) #mu's here are on log scale
}
#### Priors
mu[1] ~ dnorm(x_ic,tau_ic) 
tau_add ~ dgamma(a_add,r_add)
}
#monitor# tau_add, mu

######################################################################################################
######################################################################################################
#### Initial values 
######################################################################################################
######################################################################################################

inits{
".RNG.state" <- c(10972, 85, 4472)
"mu" <- c(-2.18182047053055, -0.394618910568206, 2.30948232109367, 2.59865180441633, 6.49971437539982, 4.59045944564615, 5.75767527034823, 5.70716864896593, 7.51252677037911, 8.32215326388262, 7.34104508364306, 5.18175170010215, -0.139195144871061, -0.0149141332867303, 1.86083311007585, 3.97306007315849, 3.4841963012495, 3.19705942002308, 5.14231372918421, 3.41073607602482, 5.45407396711517, 4.30585509697721, 5.38363782181692, 5.89288257489261, 4.64616288464065, 2.52809612482205, 3.81238049009596, 2.49736582672234, 3.10170811214055, -0.497493522743554, -1.65265598091264, -1.2610090367955, 0.0595140538185675, 0.729656989706706, 0.187338138541654, 2.21816232858594, 2.42329672915826, 0.392273900767694, 0.521610005260218, 3.01692369235514, 3.03237919232109, 6.05765083374661, 6.13492628562975, 5.32242509049414, 6.64791486889041, 6.86346475201213, 8.63765269309836, 4.41234738857228, 1.66261702328501, -2.06407639069967, 0.928334940081629, 2.80657427038875, 1.00614705149651, 0.68558157576403, 2.59373302079785, 3.42445920819919, 6.46046332752324, 4.18801654232037, 5.32480737687274, 5.27999273382674, 5.13388020379497, 3.97200025605921, 5.70479429646038, 6.39441391888719, 6.10966537001052, 8.15827378697086, 2.39613214733903, 2.83129241979873, 2.25371908933025, 0.337606551315507, -1.96705760970035, -5.29464976805516, -6.07311057556725, -7.26807530427843, -4.16645535620216, -1.72747499172574, 0.0879780139202418, 1.3297307977535, -0.20865619812259, 0.750523363885386, -0.481488290443087, 2.57951277708343, 3.87355243276005, 3.71594023421661, 4.9800368028811, 5.85176718981236, 4.9646236588962, 6.05941627068117, 4.22587500761277, 6.18145856708303, 2.13362745171632, 2.91781008951415, -0.252027985119893, -1.42695421817547, -4.18355680883908, -3.45880674064637, -2.16596758689318, -2.97060730947429, -3.49792313196041, -1.93698590985137, -2.58705192738879, -3.59348343482674, -1.15895595254436, -1.12183517633291, 1.68480702884985, -0.184352413078297, 2.85634042018917, 3.05141883519462, 4.71205979104171, 6.34727892071146, 5.05674655371365, 2.99655247929158, 4.07154562649897, 3.55897053208188, 4.586399018957, 3.86842818509537, 3.10654031556648, 4.21229473759462, 2.2644112458257, 0.896694367951386, -1.2119423900988, -2.96697481491454, -3.94596441104129, -2.81928311473197, -4.11721715014897, -3.18845595912311, -3.2294969609425, -1.85091414678537, 0.347511009846017, -1.19023798330512, 0.768186513880661, 1.53685493489202, 1.7102838705171, 5.67627478192082, 3.99529224146072, 2.32605265168235, 5.9143797315928, 7.06466589861376, 3.41451568963248, 5.91637836750691, 6.7557831704457, 7.36156948179831, 3.80622446052623, 4.43707273009058, 1.00132122326424, -1.39117841782063, 0.369060092426258, -0.0483935195633742, 3.85304011849802, 3.12513814317999, 1.83725725453436, 2.95555862810502, 2.45375487222923, 4.66864049086341, 4.44383097923055, 3.3947802020876, 6.45179617882207, 8.09150716187178, 6.74902486767219, 2.77200400009987, 4.42624225236327, 1.11965261300648, 0.374643450528516, -1.28368143314061, -3.32426349475193, -4.29449163999244, -5.03947383951697, -4.36696953482874, -2.5156454239449, 0.406391760148597, 1.958088992166, 2.80097672907931, 2.53310816191762, 3.72063632751363, 4.56663664405297, 3.34889798565183, 4.55541319468941, 4.31731635244603, 4.25905424142766, 7.53381786128433, 5.51752615311276, 8.21783145613382, 5.71572651080289, 2.66742828237503, 3.27524851243327)
"tau_add" <- 0.248988795385585
".RNG.name" <- "base::Wichmann-Hill"
}

inits{
".RNG.state" <- c(1639876247, 1162306420)
"mu" <- c(-2.14723803588817, -1.06572251237346, 2.02765900900364, 2.04237248271919, 6.4861380089785, 4.56479469415636, 5.66664192204196, 5.64500766613965, 7.55218369446382, 8.29683494940772, 7.34724260158811, 5.13243817874803, 0.572397548822042, -0.648342106209031, 2.63500566979033, 3.93526610776291, 3.07490696955157, 3.80109518721303, 5.0567081810142, 3.35766605716228, 5.4067730747967, 4.2861763306897, 5.43803529753389, 5.94756594083786, 4.38722811023595, 3.18188933029285, 3.63765587904528, 2.25374357917452, 3.0890682156188, 0.460036249428659, -2.46227794227828, -1.1649911570551, -0.702476706129304, 1.42961185844479, 1.10401640194958, 0.82319336277255, 2.13441729710108, 1.35545265358304, 1.32286314521051, 3.0438690275501, 3.11492549304438, 5.99553108270165, 6.05443189676233, 5.33023822985718, 6.70593638295815, 6.83272457161201, 8.65985451323785, 4.11604734746205, 1.44502393603193, -1.07127795322277, -2.82762070510859, 2.54754868170078, 1.25864742177882, 0.613583048872875, 2.82570768299116, 3.39680441050556, 6.45828113897972, 4.13465725572278, 5.32359046944119, 5.55048522239225, 5.10254281668788, 3.82525386974578, 5.66445261521987, 6.5052550600267, 6.13143947736621, 8.13454080667655, 2.39856632803143, 2.66957208777293, 1.42552286675127, -0.62618103229528, -1.02702893853227, -3.36876949807695, -4.67580508075074, -4.65137146340511, -6.3946018238447, -2.70977168194818, -1.20171300856011, 0.45325427869275, -1.05909771796551, 0.508721378273431, 0.0619549711843708, 3.48354792543484, 3.90468852124956, 3.60923994843642, 5.04292199067784, 5.86986248123505, 5.08877898398911, 6.11287631932554, 4.42818710193089, 6.14622393364417, 2.12312891526249, 1.76270646883721, -1.50067402151744, -2.73780843331929, -1.97473399826618, -0.81080653565321, -2.97790217839125, -2.68064099578903, -2.63095520344166, -1.57899335518761, -2.41305997731068, -4.93302542873407, -2.16416523089194, -0.808947022578621, 1.24835264130462, 1.37401979806777, 2.82858721478471, 3.20144886357674, 4.48147394300685, 6.32453658680195, 5.13353281054452, 3.03612435057908, 4.17172081220134, 3.48565229797929, 4.49578511767882, 3.91749326987208, 2.75443889265474, 4.19446778879462, 1.96628515290853, 1.04759507564279, 0.387126561960188, -3.5059891042229, -4.46259950017676, -3.38071432453902, -4.13823789219168, -3.77389825203975, -3.16194873731404, -2.18258134268648, 0.391188876530461, -0.82356422451994, 1.46246775053891, 1.69499246447356, 1.29210417258851, 5.42036200184254, 3.90906556608868, 2.92576061984246, 5.82436549987466, 7.13451646676461, 3.55520203141979, 5.74954011803039, 6.80721669607051, 7.4087617402602, 3.78581035444172, 4.43086618296622, 0.461539519905917, -1.64508191301507, -1.17986859147431, -0.473911232839298, 3.79862865870087, 3.482547894825, 1.6279357750912, 2.90189960183617, 2.72632357157046, 4.9129225064206, 4.23222954972105, 3.66648794110281, 6.44712620349235, 8.09081485231133, 6.79239759098649, 2.5043190340452, 4.53698773044503, 0.642148614300918, 0.920669893321084, -0.269703079272921, -1.390408576576, -1.29343928406689, -0.994790825473113, -2.66444539913053, 0.169465019140841, 0.450671397286244, 1.70069817528452, 2.35941310373345, 2.3227507377655, 3.82927401322612, 4.62588910186769, 3.75355382315358, 4.49666343202759, 4.27403701129673, 4.14836832073681, 7.51787034964432, 5.48322380244393, 8.21542196625852, 5.7558915106257, 2.99177741882369, 2.90124532642091)
"tau_add" <- 0.262777318107694
".RNG.name" <- "base::Marsaglia-Multicarry"
}

inits{
".RNG.state" <- c(-1333796459, -53018845)
"mu" <- c(-2.23105665586366, -1.36074125684856, 2.09151290407234, 2.73914408730461, 6.46343313174032, 4.54375839582412, 5.83429887932973, 5.64040179977693, 7.58773157750331, 8.30794344954628, 7.36468441332003, 5.07726705808728, 0.0092634344500746, 0.798883405588756, 1.77546701218674, 3.81343890050108, 3.15049081391316, 3.23696825049476, 5.11171867688697, 3.25745775761896, 5.3593717367914, 4.34976420510206, 5.32984089522955, 5.96529756631437, 4.49992675473755, 3.19072233535793, 3.52153017141167, 2.24793100953117, 3.07319424051172, -1.25558613538975, -2.14451218835551, -2.04946855106036, 0.0211018262379353, 2.45324816453856, 0.474063541636381, 1.76039105677852, 1.92045994711536, 1.33656178131699, 0.764714912593418, 3.17611822214173, 3.15633976492365, 6.01999913319533, 6.17192266715431, 5.26510902084044, 6.73475843554092, 6.92040170151182, 8.66403101731897, 4.25435952760971, 2.20447134761409, -0.69667947265141, -0.218731022193068, 1.62089638953945, 0.971666041025194, 0.417317666322513, 2.9127016260244, 3.01598238431875, 6.41492761512086, 4.18901659538615, 5.46778277643365, 5.35508395689688, 5.05603417031818, 3.94712148885412, 5.7016028537095, 6.52655589959894, 6.11320074592551, 8.14346324564306, 2.71996698913071, 2.66176682353699, 1.26588813591064, -0.336476070982989, -2.4512390027409, -2.87111085786296, -5.00959907956357, -4.50261999024435, -1.45029686211443, -2.63469014299903, 0.767422947026895, 0.936186770064188, -0.123954092720783, -1.11131123882799, -0.174797887256997, 2.9068920249937, 3.85545169983286, 3.73155971516195, 4.81858172681489, 5.93030818436141, 4.94747955411135, 6.09010254595734, 4.37872874388862, 6.13440949532828, 2.63714904249075, 2.65470005684099, 0.695969900951686, -0.752920854231532, 0.510764037469323, -2.00738313901843, -2.71688398300012, -1.91712080272604, -4.2780264635349, -3.03585116490092, -1.66627768058685, -4.37155689235489, -2.17642631832233, -0.900642551626924, 1.67961295146095, 1.42784763550247, 2.62226670575342, 2.99485091540825, 4.52742721757968, 6.30506725776957, 5.01747011506812, 3.27809730741409, 4.17766911889343, 3.30077930618867, 4.41549861267306, 3.70500474069119, 3.37447659739476, 4.07995043058144, 1.87584358032517, 1.41285523916039, 0.0740037963892748, -0.208699825751154, -3.34577407024711, -2.36126157784744, -1.49047792769114, -1.90815349855349, -0.0874183937854178, 1.21723410270547, 0.992667800631574, -0.176900677020764, 1.2913840568402, 0.142191603921866, 1.36597544418032, 5.57686249930597, 4.12065681994521, 2.76954659460599, 5.86083877802281, 7.06650837083064, 3.58863656450685, 5.84201631881025, 6.75080460967502, 7.42273034157761, 3.92042738903933, 4.56318439938931, 1.41864526627877, -1.4885765933726, -1.12548954483039, 2.64921981936416, 4.12080116715769, 2.99375471405011, 2.05979683190298, 2.93151009877906, 2.43781605664177, 4.93071054777061, 4.03537088832714, 3.56643473432153, 6.36416715444553, 8.08783410807284, 6.73758515935861, 2.59980025982692, 4.46351689425267, 1.2628349549049, 0.505821871859148, 0.121419378537214, -1.25678852558277, -1.23733949275895, -1.71618560171195, -3.83309412096968, 1.03280080584859, 1.16896420399685, 2.01442290375641, 2.55216567167555, 2.85851895432421, 3.68716644744063, 4.75589610631292, 3.31350236448354, 4.63647159682137, 4.07262943872183, 4.04832941030361, 7.54951328410019, 5.49003367071322, 8.19381579443733, 5.71167870487024, 2.92370757566629, 3.14269649550646)
"tau_add" <- 0.277710171202581
".RNG.name" <- "base::Super-Duper"
}



######################################################################################################
######################################################################################################
#### Data 
######################################################################################################
######################################################################################################

data{
"y" <- c(8, 0, 8, 10, 634, 95, 314, 289, 1913, 4086, 1552, 173, 0, 2, 10, 51, 26, 28, 165, 26, 230, 73, 224, 370, 95, 20, 44, 10, 22, 0, 0, 0, 1, 5, 1, 4, 8, 3, 3, 22, 19, 417, 489, 212, 802, 958, 5814, 68, 6, 1, 0, 11, 5, 1, 18, 25, 654, 64, 226, 224, 181, 43, 301, 617, 462, 3460, 11, 19, 7, 0, 0, 0, 0, 0, 0, 0, 1, 4, 0, 1, 0, 19, 46, 36, 152, 349, 136, 466, 84, 455, 7, 12, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 6, 2, 14, 24, 92, 570, 153, 23, 66, 28, 96, 45, 22, 60, 8, 2, 0, 0, 0, 0, 0, 0, 0, 1, 2, 0, 1, 5, 4, 260, 56, 13, 364, 1174, 30, 329, 872, 1575, 50, 96, 4, 0, 0, 2, 51, 23, 6, 18, 14, 119, 67, 33, 586, 3351, 877, 15, 87, 2, 3, 2, 0, 0, 0, 0, 0, 2, 8, 16, 14, 49, 102, 30, 92, 65, 71, 1902, 245, 3661, 313, 16, 21)
"N" <- 185
"x_ic" <- -2.30258509299405
"tau_ic" <- 100
"a_add" <- 0.001
"r_add" <- 0.001


}

######################################################################################################
######################################################################################################

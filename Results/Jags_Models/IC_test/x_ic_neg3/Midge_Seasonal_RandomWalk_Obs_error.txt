######################################################################################################
######################################################################################################
#### JAGS model file written by runjags version 2.0.4-2 on 2019-08-16 22:28:59 
######################################################################################################
######################################################################################################

model{
for(k in 1:max(year_no)){
for(j in 1:max(season_weeks)){
#this fits the blended model to your observed data. 
y[k,j] ~ dnorm(mu[k,j],tau_obs)
}
#### Process Model
for(j in 2:max(season_weeks)){
mu[k,j]~dnorm(mu[k,j-1],tau_proc) 
}
#Loops through number of years and defines prior for each year
mu[k,1] ~ dnorm(x_ic,tau_ic) #keep in mind you'll need to index like a matrix 
}
#### Priors
tau_proc ~ dgamma(a_proc,r_proc)
tau_obs ~ dgamma(a_obs, r_obs)
}
#monitor# tau_proc, tau_obs, mu

######################################################################################################
######################################################################################################
#### Initial values 
######################################################################################################
######################################################################################################

inits{
".RNG.state" <- c(837733335, 1732860463)
"mu" <- structure(c(-2.80440437876914, -2.96514331157904, -2.93150677056622, -3.13245221898409, -2.95417009049847, -3.14268108518847, -3.99004123948168, -0.515736896698924, -5.39583744695908, -4.29242527578146, -4.84731114696875, -4.33907149814503, -5.06759512696215, -2.68621726490191, -5.58393822445742, -3.05699530649288, -6.09240646752001, -4.24751613721881, -3.33446170906947, -4.03661877069029, -5.62275109287119, -1.9647993187643, -5.43785048919943, -2.17564706406067, -4.62988010118843, -1.92596745137521, -3.70317308056859, -1.68113718431032, -4.26892824061947, -0.705825565630636, -4.04655117754181, -1.34544274817113, -4.24746853646609, -3.28642917088204, -4.01182609855666, -0.584783994610918, -2.11675662415963, -1.22491426163573, -3.62279713314583, -2.43903023648392, -3.5041768579655, 0.293502762575746, -1.26538196116378, -0.271709054810036, -3.25982004934883, -1.68758170462924, -1.53393929292079, -0.253295890560489, -1.65682517582447, 0.134726721931506, -1.45825309562585, -1.86203594182435, -3.12590010038447, -0.547921925044251, -1.44397885062915, -0.698243891912957, -1.85379233723929, -1.18133209720202, -1.09239862166174, 1.2780330760978, -1.36797462252295, 1.29265476459365, -1.07370407239382, -1.62501777274231, -1.17082252743426, 2.21985773288562, -1.05835216179897, 1.65863951745261, -1.93086689230156, -1.49178338282705, -1.86471893900505, 0.872377254287294, -0.118457046143042, 3.3777706293932, -0.872907279133439, -2.48116537085094, -0.421412385593639, 1.23639234800284, -0.725772996721605, 1.2412357338965, -0.00770632209451641, -0.660087252667638, 0.980127701255431, 0.655416264361762, 0.71691001155035, -0.419920743745621, 0.300418572603861, 0.330551188337777, -0.115759378030114, -0.226249430029232, -0.885243755506663, -0.97909906325712, -0.994126425160313, -0.788383367415254, 1.76871781072841, -1.99585387592685, -1.25395937420003, 0.102743675249796, -2.4636187564592, -0.847670521725107, 3.01228294659305, -2.24723484247672, 0.731524568472759, -1.44712463158656, -3.48688579380911, -1.87772876935675, 1.80515349477052, -2.46239014197965, 2.35675605627237, -2.0101366341432, -4.80966694546235, -3.07338050420368, 0.254625002723228, -4.19465619433929, -0.144766951201241, -3.44889260429539, -6.57361285956958, -3.56184213045733, -1.23513121275202, -3.75911245748457), .Dim = c(6, 20))
"tau_obs" <- 0.78131320324714
"tau_proc" <- 0.696014184225768
"y" <- structure(c(NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, -3, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, -3, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA), .Dim = c(6, 20))
".RNG.name" <- "base::Super-Duper"
}

inits{
".RNG.state" <- c(110, -224864980, -529129015, -503765492, -1168670240, -1599851209, -758062388, -1512594533, 2119714940, -1441354489, -1360470731, -2076670933, 2063122135, 1395049647, 1718484519, -707531689, 926571826, 1475083794, -570008421, -657370678, -1188350156, -243920691, 1121610607, 1604786584, 45360641, 1520748971, 1438543166, 1334595278, 647127708, 442306559, 1788670304, -512816179, 1241153330, 387539425, 308718671, -961317271, -5054734, -1274179425, 1343111458, 1489990611, 765952669, -1874158358, 93878576, 171703869, -967094485, -1123484226, 517324802, 884760275, 1204978957, 1178794367, 493368949, -807321192, 322469578, -1020678026, 154180989, 1821543784, 464914536, -14928479, 1631933993, 2047926585, -2058864698, 12068349, 1661010620, -1865654509, -226464660, 1060600293, 98320592, -226295438, 1576773058, -2119609374, -47444667, -938179255, 1407711986, 690165165, 205350848, -1074807457, 1890785716, -125449187, -1505156840, -1290429421, -1660868748, -1528876518, -930894748, -1659083911, 376224470, -1071420215, 1669272948, -1996857191, -1327193868, 906651623, -2003561721, 39024437, 1678795747, 1633814633, -1450310756, -32787173, 705040259, 1191410525, 926372889, -558580062, -893007854, -692463642, -1183982520, 1102231220, 1914070340, -380712883, 1218559376, 1283088325, 273406467, 307963626, -1943589915, 1552267825, 1883745074, 1402445586, -1427915380, 779661884, -139873930, 1886615048, 122097981, -8079084, 965189640, -67189286, 685470134, 1380387342, -2110005525, 1283404496, 819717473, 673968735, 8459995, -158741543, -1867504737, -1971601671, 255720045, 1259430271, 1425024700, 1171838905, -1769944100, 239316970, -1379385717, 296309092, 1506075391, 196497497, -300126771, 1470542032, -534161600, -1969003986, 984284537, -764585010, 626637303, -1976004722, -1180271221, 1033379771, -447712833, 1591689351, 712629518, -399769996, -149063882, 99308442, -1134103160, 474322663, -1195728491, -1575214391, -2078819632, -20217562, 281615220, -781208060, -1651669398, 1757502904, 120361198, -1764226466, -348768356, 1426751335, 48349833, -1363231625, -2046996125, 332506009, 211938029, -226327675, 759416143, 67894888, 150022309, -1369954435, -1522888140, 745476445, 335017815, 370613609, 1836899849, 1229241356, -1921052023, 670810015, -88307218, -1443141086, -734917698, 1601211243, 1729978697, -970381984, 2108294854, -1442642805, -444606982, -289967194, 928471460, -170451509, -1864030984, 1729083126, 752445505, 1863087701, -770361154, 1208508807, -557096178, 675689956, 483706243, 603743938, 1240927165, -1041212747, 315071692, -455762014, -1248331594, -709410386, -1578367426, -1821513098, -876228404, 1745812214, 734720028, 1310982971, -963564738, -2452269, -140236207, -258933222, -2041027276, 1980778551, -986220178, -776803936, 371523223, 248983784, -2067717531, -1470273632, -2088804996, -1903052069, -1137785232, 1310581759, -1905602460, -760627744, -128143152, -1035739499, -2037687935, 480698851, -110706795, -2142459998, -1258183497, -940848642, -649646861, -1056518930, -1582860083, -711744740, -562847916, -311966239, 1298975797, 176824363, 1764482671, -316134043, -1299162836, 929495994, -310557136, -858938018, -1991363618, 1421138878, -1813538510, -1822618894, -941306345, 849956831, -1158680627, 1651721622, 1010091571, -486528607, 216601275, 666012061, 1262759686, -572515740, -719261865, 2105835094, -2094549851, 1740912225, 1913732550, 410665246, 1299501806, 576503070, 919251917, 895538000, 622501006, -1266644187, -1857461803, -1601287626, 2005057848, 442432188, -733671800, 284932554, -910151727, 828600354, -289468030, 1747961074, 1052853008, -1222819540, 629662869, 916337210, -218703304, -1887308421, -1762984836, -1494894991, 535830914, 331545058, 184984014, -1960917564, 403875585, -775149780, 783878386, -371010449, 526742291, -956546550, 1520687575, -936145349, 2057373325, 1791101050, -1848702080, -169722240, -912147439, -898080716, -1070503245, -1046052926, -1059201865, 1922507463, -2009410059, -930927267, 659623959, 1732628616, -2056664651, -444895804, -1153991623, 198508378, 972195444, -1728813865, -1622164547, 586875125, 1333764906, -846145408, 1622560042, -1417632994, 240292736, 980135931, -1256309720, 1724016237, -2055560495, 268261129, 63071822, 1607950919, 910406682, 1444874400, -261497818, -587034442, -1511513454, -1001483925, -836611133, -1732863603, -1759204839, -1062112248, 1530408750, -46122217, 917327027, -177431515, 830579102, -1286781679, -1715163643, -1794825103, -1050154530, 119535419, 1356137740, 1748565929, 1136455743, -312051891, -614432715, -1946474694, -2045304130, 1873253672, -1475680162, -1630526332, 332306137, 460624675, -1487748212, 1421137984, -1205351291, -289552848, 2049476977, -625018050, -77100454, 106131339, -8382600, 1651096783, -2121143458, -646146714, -911310683, 823846180, -1424397794, -1198111517, 944381314, -1712757178, 1183059992, -82039349, -53920323, -807310452, -330990084, 989804706, -459679344, 79654062, -1591315111, -1701388631, -913158537, -667266844, -1509551134, -224229095, 1354203043, 267783651, -1252513652, 2031790130, 1386819802, -287494827, -2093766983, 1339063429, -466143949, -264399183, 1034324641, -1441917319, -66513999, -1333546674, -1854267181, 1114847336, 1138912480, -2023411164, -1416141624, 113859295, -20812616, -1645020261, 1143708418, 1596179011, -599406765, 626929106, 246937282, -1798906151, -1612904820, 1402224357, 998599748, 992578470, -401673586, -164612734, -587415214, 330523918, 1969731926, 1453252098, -566586921, 1075688121, -897662227, -1302771497, -1746665556, 54813738, 173284141, -741182568, 856489170, 130805842, -729617287, 29377470, 1616084512, -465595749, 490037485, -1363322811, -1237762423, 261185376, 1160561684, 1974364664, 144202075, 24034116, -1463406050, 807239917, -2134060510, -520371946, 940652941, 52270778, -2012533343, 116953255, 1332126944, -401751499, -1066537815, 786351060, -1375217455, 667983028, 197687694, -31326289, -2022326444, -1790586902, 255349206, -1311464596, -459655091, -498014291, 2019661995, 1090587800, 1191208547, 168125963, 71197880, -936203083, -1863851231, -1813177044, 572188282, 2032094545, -628903581, 699950171, -719259967, -1467153951, -838159288, -1551535804, 1858862443, 1218697467, 493194466, 1939039789, -1935151651, 1848186911, 151482079, -1310873437, 475641178, 2031158044, -1138190720, -651030533, -207021506, -250039926, -1084258312, 422527436, 1276486510, -979195877, -537923090, 414816787, -2140416404, -996354025, -1412625031, 554683248, 964247140, -173718918, -342471195, 1494828806, 765245438, -826372283, -1872466987, 1001536560, -1708083089, -215104355, -1101128546, 981321955, -1180102918, -1674941145, -618527657, 41315038, -1408985484, 1475067913, -1462614086, 1227842168, 1684784560, 378462605, -1904863501, 1579847589, -407300519, -256403662, -1686192549, 1713225791, -2040185470, 497798350, -406767762, -935063927, 1675447602, -2092929034, -1274088403, 520812520, 87333074, -927600924, -923616719, 1906186524, 1840850216, 861444424, 1193087206, -2053020262, -2141731657, 1741719181, 1367813120, -1122033507, 196793699, -1438282318, -1263227140, -580190616, -1085112563, -381399624, -1822893595, -1139201096, -1796886923, 1606268407, 361368870, 925488703, 868326168, -1569595657, 1563091127, 549926980, 1710233025, -748017619, 338825258, -1034001859, -2119661304, 1457953320, -1880972837, 249819930, 1910761325, -1126531015, -402409919, -62226309, -1559560682, 994366259, -279135679, -1007261344, 2049852734, 1759206246, 423069776, 27716548, -533659664)
"mu" <- structure(c(-3.00023626743602, -3.06093392433849, -3.0483631809208, -3.09854662051375, -3.00036834428562, -3.06934319552972, -3.52043802530685, -2.29824576373818, -4.66789668306963, -3.84897829389406, -3.84783789999129, -4.05903299310712, -3.56638143552887, -3.24013249944342, -4.54146876536485, -3.81118034874433, -4.09924316917436, -4.55885323581517, -3.78948905268474, -3.44813187026675, -5.29592049197461, -2.83247049955022, -4.10972069893665, -2.07391054035611, -3.67235325833375, -2.87510942841344, -5.31632036782025, -2.08551476308805, -3.28575143569011, -1.69798702383374, -2.24996894074255, -1.79481547318193, -4.69563752086665, -3.17477921116387, -2.43209269160373, -1.55897199194263, -3.01605923965395, -1.94025168028654, -3.7549755277479, -2.03574032208514, -3.0844431613648, 1.07206748843079, -2.1933184711756, -2.16420944857258, -1.88543090193191, -1.83997155460147, -2.42111574469122, 1.09558387182508, -1.93682895164407, -1.17217323719941, -2.25568599206127, -3.30186311079418, -2.3921827367681, 1.44042782521829, -1.2091407842537, 0.301541676475189, -1.06146513815422, -0.476021156560286, -1.82207496858121, 0.669977074148417, -0.553144310948784, 1.37730164134671, -1.49637682672429, -0.0663045777067788, -0.94381623473314, 0.677701708296975, -2.47339364085171, 2.24232392819332, -0.503672989413303, 0.0652302008457508, -0.00180879969105463, 0.570020437332109, 0.0028228423094209, 1.41224526115606, 0.00812867306451542, -1.10905741119165, 0.723476895718238, 0.700366512646895, 0.03883920472261, 1.44456110674204, 0.629198516596816, -0.886489813962855, 0.766880926728146, 0.107757779147436, -0.582083041292763, 0.111584027850798, 0.748464072481676, -0.854131681005763, 1.51860296201655, -0.0878355526434993, -2.01980178269864, -1.92251021243967, -2.15375152923578, -0.450969848486026, 1.01491860574593, -0.821273523189198, -0.604896345869642, -2.18563614717955, -4.02997351854459, -0.859131894991813, 1.00191571701378, 0.184995547685347, 1.20179636739581, -2.82345466284424, -3.56215315157725, -0.31482177079013, 1.64628486182031, -2.05868315760397, 2.76750449263664, -3.21279630197271, -4.93267219180787, -3.84917754969916, 0.216114283856055, -2.96956397563534, 0.166463488787499, -3.77437288703334, -4.75258508981838, -3.65169956228188, -1.19386345973463, -2.25288423169465), .Dim = c(6, 20))
"tau_obs" <- 0.992333756367511
"tau_proc" <- 0.788537844164189
"y" <- structure(c(NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, -3, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, -3, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA), .Dim = c(6, 20))
".RNG.name" <- "base::Mersenne-Twister"
}

inits{
".RNG.state" <- c(7847, 25959, 2470)
"mu" <- structure(c(-2.98974522367611, -3.0893991812839, -2.98122461735159, -3.17595917672388, -3.12901570769084, -3.09202302107147, -2.97231912900363, -4.27871822364116, -4.28368025261023, -4.59987509786573, -3.97869126042028, -3.33786504599132, -4.73608422238833, -3.44067893340305, -5.44348605955498, -1.77576880960571, -3.75054695119167, -2.17699227458544, -3.78605324937715, -2.85108674750711, -5.47734746548646, -1.33504236447302, -2.59650469251457, -0.869824275554943, -3.90925598324734, -1.86816387613281, -3.37691504179127, -1.59137327814821, -2.88943789746337, -0.655768537532585, -5.15197564365294, -0.980317145108499, -3.76020380017257, -2.77903537637653, -2.48210232220292, -1.27613768877019, -3.23579389462126, -1.67683804890979, -3.84954508185471, -2.82029530861179, -1.51934013326538, 0.445591498674329, -1.61616471474023, -2.91577408650985, -2.6357187270682, -2.74542851415069, -2.34922998662704, -0.49943480165537, -0.384025851334791, -2.22290785095226, -3.1328601586941, -0.385053756372336, -2.51677190584145, 0.0570495295199914, 0.0465341283976503, -1.63684491834909, -3.23328506444265, -0.0984575672092767, -2.02033755287524, -0.469296295019617, -0.136943076793579, 0.306155660081802, -1.7158390738919, -0.750037419343937, -0.713441993886149, -0.635195720356588, 0.578273262072865, 1.62331560759403, -2.13874854181485, -0.900712620235167, -1.26098286324238, -0.877584018090613, 0.30386341386013, 2.06374258912601, -1.06155777737512, 0.571003180382914, -0.642169244670631, 0.460359640881228, -0.0529371528123878, 0.754887062305689, -0.370872940197307, -0.204440783290358, 0.564681382695165, -0.78314354250308, -0.292979905075792, -0.296232158095051, -0.96841493862649, -1.660572430193, -0.0797515436887151, -0.84333742065659, -0.612981943585988, -1.51040430579471, -0.66946795842507, -1.01238246294157, 0.726530980162334, -0.697025266186737, -0.32050237948389, -1.40261942541769, -2.67649209122111, -1.76073044446964, 1.94671862189118, -1.63884061740187, 0.21388234330136, -3.2167801728584, -4.68466563421994, -2.09231357183283, 1.68706687054927, -3.18825420501808, 0.0450152199024212, -3.46051782498758, -6.14675094779551, -3.87248790447649, -0.573818472346804, -3.2054237287775, -0.865784107573772, -3.76116182425604, -5.33383691324539, -2.67960882142189, -1.90608352744941, -2.32608048562324), .Dim = c(6, 20))
"tau_obs" <- 0.714267596577987
"tau_proc" <- 0.975017523810652
"y" <- structure(c(NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, -3, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, -3, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA), .Dim = c(6, 20))
".RNG.name" <- "base::Wichmann-Hill"
}



######################################################################################################
######################################################################################################
#### Data 
######################################################################################################
######################################################################################################

data{
"y" <- structure(c(-4.06591991745718, -2.94665209430014, -5.80914299031403, -5.80914299031403, -5.80914299031403, -5.80914299031403, -4.59783674154387, -1.88686814833501, -4.59783674154387, -5.80914299031403, -5.80914299031403, -4.59783674154387, NA, -4.06591991745718, -5.80914299031403, -2.94665209430014, -5.80914299031403, -5.80914299031403, -3.26053097886945, -3.72054301540761, -5.80914299031403, -1.93466900116998, -3.72054301540761, -1.98486998368036, -4.06591991745718, -2.60726358981506, -4.59783674154387, -0.668845883547919, -3.72054301540761, -1.47248282297889, -5.80914299031403, 0.655974922329534, -5.80914299031403, -4.59783674154387, -3.72054301540761, 0.281988862342713, -2.51565896414186, -2.70811366311588, -5.80914299031403, -1.18037030439171, -2.70811366311588, 1.31661982654987, -1.53614971441768, -2.82028710501947, -1.53614971441768, -2.15263466474332, -2.60726358981506, -0.0653754237762429, -0.589253733521219, -0.711150923698861, -1.8412483567478, -1.25195872848308, -2.51565896414186, 0.543420073956604, -0.211473338919426, -2.21545316410442, -1.47248282297889, -0.696849461552251, -1.01127799732093, 0.265852896722762, -1.03091569138165, 2.75676687558721, -0.168704041457194, -0.382628870687186, -0.615086916013517, 0.535170022761435, -2.60726358981506, 3.57821555646438, -1.75581432451179, 0.163154257134424, -0.833582703939862, -0.53950714937723, 1.18076288241878, 3.79205461642565, 1.4123738990455, -1.8412483567478, -0.60208690792214, 0.8962786165969, -0.013864711444381, 1.55353770544924, 0.869955466752787, -1.27700755822547, 1.06823942041139, -1.18037030439171, -0.576583164939999, -0.696849461552251, 0.0554034869116419, -0.382628870687186, 0.462152453642488, 0.138825724259713, -1.32906996434575, -0.900920880514602, -0.770494290290964, -0.56407113301186, 1.43788878016486, -0.900920880514602, -2.28248391223017, -1.88686814833501, -2.82028710501947, -0.43587591418692, 2.24561904248638, 0.677760368893093, 1.5185224738127, -2.94665209430014, -4.06591991745718, -1.1135661849228, 4.40231277434833, -2.28248391223017, NA, -4.06591991745718, -5.80914299031403, -3.72054301540761, -0.770494290290964, -4.06591991745718, -0.274600501197854, -3.09132676577126, -5.80914299031403, -3.46431559990757, -1.44210761092232, -2.0377249228153), .Dim = c(6, 20))
"year_no" <- c(1, 2, 3, 4, 5, 6)
"season_weeks" <- c(1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20)
"x_ic" <- -3
"tau_ic" <- 100
"a_proc" <- 0.001
"r_proc" <- 0.001
"a_obs" <- 15.37
"r_obs" <- 7.84


}

######################################################################################################
######################################################################################################

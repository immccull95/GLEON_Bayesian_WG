######################################################################################################
######################################################################################################
#### JAGS model file written by runjags version 2.0.4-2 on 2019-10-05 20:12:16 
######################################################################################################
######################################################################################################

model{
for(k in 1:max(year_no)){
for(j in 1:max(season_weeks)){
#this fits the blended model to your observed data. 
y[k,j] ~ dnorm(mu[k,j],tau_obs)
}
#### Process Model
for(j in 2:max(season_weeks)){
mu[k,j]~dnorm(x[k,j],tau_proc) 
x[k,j] <- mu[k,j-1] + yr[year_no[k]]
}
#Loops through number of years and defines prior for each year
yr[k] ~ dnorm(0,tau_yr)
mu[k,1] ~ dnorm(x_ic,tau_ic) #keep in mind you'll need to index like a matrix 
}
#### Priors
tau_proc ~ dgamma(a_proc,r_proc)
tau_obs ~ dgamma(a_obs, r_obs)
tau_yr ~ dgamma(0.01,0.01)
}
#monitor# tau_proc, tau_obs, mu, tau_yr, yr

######################################################################################################
######################################################################################################
#### Initial values 
######################################################################################################
######################################################################################################

inits{
".RNG.state" <- c(1856512646, 445012941)
"mu" <- structure(c(-5.09022324761228, -4.91437954849291, -5.17864311627114, -4.94767097356534, -5.03032950332239, -5.05656542659623, -5.22438033358313, -3.11954463001065, -5.37322125273697, -5.56538372390866, -5.45746557321157, -4.65249838677534, -4.96651616561224, -3.60367075579913, -5.63119267490604, -3.8843714777618, -5.23178993257964, -4.26964261300764, -4.12641123616362, -3.02857327987466, -4.96725638043969, -1.73664626542835, -4.46355691344649, -2.81666529995507, -4.11550008705415, -2.29178121430719, -3.78780640157159, -2.11820680610356, -3.38727828916203, -1.21292991189017, -4.63169023260646, 0.385510648718148, -5.02880028078302, -1.86461031876381, -4.27863900214665, 0.256820920998158, -2.43034725911555, -2.50397323685399, -5.21961794175195, -1.26997501851584, -4.44881407432964, 0.348723950665305, -0.458012809260678, -1.73020002388968, -1.9673460131601, -1.98189683017087, -3.14801590415767, 1.00545563298645, -0.194992539994558, -1.67952213505731, -0.419873088385312, -3.39503124801613, -2.43078308963667, -0.258497275845882, -0.780060960640169, 0.62374715653483, -2.1516164995783, -2.02957522084695, -1.12180693749375, -0.624006408787004, -0.135471225862904, 1.19366078280427, -0.793725345802159, -1.43031445689297, -1.07152166022471, 0.319296322746155, -1.2632578753144, 2.71822140387944, 0.056142467582783, -0.542238297933818, 0.157869094977411, -1.04917774045137, 0.841396080252948, 3.53912874831783, 0.653699500200796, -0.295672665637403, -0.0426952514491098, 0.763406801679809, 1.4140351365508, 0.93563133914646, 0.84388066362339, -0.626746612249373, -0.213854430893051, -0.289457816806735, 1.09509636727302, 0.174931314883806, 0.814258342580806, -0.347811155500678, 1.20983375553487, 0.157759417457665, 0.529291563057243, -0.153790658724874, -0.913393065202289, 0.334223975153683, 1.64786536447854, -0.951788014763258, -0.192896464889643, -1.35561490028999, -2.92396598915626, -0.839842137170974, 1.71519021828636, 0.55993140495072, 1.006907428948, -2.59903125009837, -5.1407064254092, -0.649676508672963, 2.68227575939246, -2.5907710300998, 1.33990384166281, -2.94247338335384, -5.32861509401881, -2.09074397808015, 0.401952476945893, -3.55275121056112, 1.92234050650701, -4.17025598655184, -4.81528246164222, -2.28424680465625, -0.310683900054863, -1.81961654263669), .Dim = c(6, 20))
"tau_obs" <- 1.08062461252316
"tau_proc" <- 0.57609978647052
"tau_yr" <- 24.781634627041
"y" <- structure(c(NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, -5, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, -5, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA), .Dim = c(6, 20))
"yr" <- c(-0.000402720174290022, 0.0588224872649749, 0.264105959221975, 0.105317905725155, 0.250643141688576, 0.019976881218118)
".RNG.name" <- "base::Marsaglia-Multicarry"
}

inits{
".RNG.state" <- c(-1300239782, 238647445)
"mu" <- structure(c(-5.01950753728762, -5.10521661144471, -4.80698143240362, -5.08831253274758, -5.00793537983415, -5.19572656275827, -4.81730614694791, -4.12626958640064, -4.35338700994332, -6.13655728005855, -3.9672983294068, -4.24424808198888, -4.57258554060036, -4.76157771197952, -5.01687544343025, -2.69172377724179, -5.37167702160155, -5.47691525443063, -4.23577935938391, -4.88720913263818, -5.67659780383852, -1.32573054735543, -4.40082536124504, -2.52934757096172, -4.25068860904363, -2.38334134861109, -5.37846482128133, -1.02034715071926, -3.68368593060559, -1.15566820543433, -5.37268228528164, 0.168025347421531, -4.18704822193145, -4.47705424750872, -3.9786881527739, 0.0104111168275237, -2.78561949018902, -2.01932436607062, -4.94610387570165, -1.80198951866198, -3.71430816706188, 0.698561388290091, -0.440605507609853, -2.1741453351166, -3.54820179181581, -1.64735214169088, -2.80910639837277, 0.960887935142622, -0.953106812684, 0.375826878779228, -1.12856200226988, -0.902768353694229, -2.94766802687479, 0.625559402032028, -0.162948580519679, 0.0565931041943957, -0.28510835689214, -0.444409501554411, -1.36898830768615, -0.391570672991195, -0.681641466729377, 2.34335503217096, -1.00852890895032, 0.156650207591117, -1.4603831853325, 0.361064474030667, -1.52263431213929, 3.55826419108685, -1.5333602138173, 0.900092461913622, -0.97135881269837, 0.419574233419375, 0.590135510662145, 3.02374754717662, 0.410279040354719, -0.755204561574717, -0.802489033483675, 1.23422628450004, 1.59953193925401, 1.45116158721504, 1.58302915330196, -0.0559770403323894, 1.42456595573411, -0.545035337734664, -1.15240091162178, -0.94351877458348, 0.548137271528629, -0.358805542754836, 0.918136229015884, -0.617499685956699, -2.31464587141339, -1.31096168437264, -1.57185889264959, 0.0801908260994015, 1.36075512687376, -0.614242807108654, -2.63789514730679, -2.92624701370527, -3.10684670703536, -1.03930843943698, 1.80824339397661, 0.193317969673936, 0.484092955828175, -4.10785583039483, -5.08302403758007, -1.8187129441038, 3.18308674745522, -1.22382428583509, -0.346750465907198, -3.28569077891059, -6.55314535634948, -2.72197755590627, -0.155105345673313, -3.09104937422554, -0.501807619095814, -2.8882047192185, -5.240143406357, -3.50075437124282, -0.726359704850359, -2.76249447972487), .Dim = c(6, 20))
"tau_obs" <- 1.12658542580304
"tau_proc" <- 0.584904541721125
"tau_yr" <- 11.5794823003811
"y" <- structure(c(NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, -5, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, -5, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA), .Dim = c(6, 20))
"yr" <- c(0.406232338458191, 0.0435493938728771, -0.129835578908448, 0.469928811787477, 0.0101589115432209, -0.042819801365187)
".RNG.name" <- "base::Super-Duper"
}

inits{
".RNG.state" <- c(72, 1832516818, 301179305, -1679528293, 1511191776, -673445098, -830954787, 472175895, -513076690, -2077974835, -208565071, 662963771, -148248337, 263392567, -412474509, -385664238, -605625299, 1105423349, -1281042734, -1299886810, -2144833897, 2054682195, 278081819, -1946144818, 1136342587, -758576420, 354184989, -1606525706, 1117016971, 723895770, 521200324, -143845367, -2123732428, -1729976691, -989970404, 1765156971, 421809289, 421881409, 2070942573, 117034433, -2031274518, 606733487, 743667087, 1109286302, -743085778, -165855805, 167943766, -1309002103, -2014561156, -1124628026, -933424825, -1194359951, -1064138766, 2131436696, 919257167, 583919634, -1334951979, 70878343, 1892708995, 1541166383, 1046581021, 1520074075, 798675766, -2010785969, -1164813645, -1765252719, 1756607071, -1402394114, -834214215, 472336581, -982289063, -577210190, -466875675, 369036938, 1907739439, 217359848, 1529348758, -2070601517, 1766230224, -34836350, 1723440418, -278598443, -2025139975, -68661672, 573127222, -799487452, -449926851, -1146440483, -589127421, -166058309, 403339394, -1805503295, 1928910553, -480474040, 1552468005, 1440428169, 636674637, -1893089410, 1848406276, -1631440343, -1080691571, 247693943, 659800464, 1872857273, -2012651000, -719451, 33647014, 917536299, 1505537757, 1822554983, 737160776, 672854682, -603539309, 540253973, 12208498, 1115853060, 1918177863, 223434696, -511641932, 606633420, 2044659970, -651053689, 1617362155, -1307011974, 766524033, 765350257, -2017336218, 1424029491, -1122079877, 1314626330, 359329488, 1117627617, 325644754, -247811806, 908427410, 1647545544, 1151245813, 34881469, -1013985841, 202201447, -218311076, 1456775717, 1976321802, -478253457, -1602388308, -2107744668, -1920794286, -1767689184, -46739495, -1841543901, 1533133073, -820489723, -1741977055, 998895741, 529815654, 496960684, 2029584049, 314932449, 225608244, -1230454867, -651971891, 1807435043, 2053292445, 1364791554, -47997054, -247783796, -426124544, 370330763, 1344724100, 401346885, -1258804353, -441486957, 1311082860, -1021999375, -653943223, 1300968140, -1855985665, -930774510, -1028822762, -2037971130, 1822023938, -1989744953, 1860713331, -966080192, 1405628001, -120666160, -1204572598, -773732566, 529213822, 412336976, -1751423983, 1590252222, -1959372410, 757364609, -335988915, -1900852929, 330749974, 479897430, 1624852158, 150459427, -1860154645, -1353375293, 207299520, 1445883861, -1584185483, -1185736930, -159028216, -2109646849, -257938728, 2028318584, 401707282, 1041796805, -694404131, -1618672529, -2111579625, -1608134885, 1360558332, -1944939272, -418880718, 1288164149, 21357462, 1808253880, 1224917581, -1700676168, 1285130778, 1195166989, -1135561229, 1044310439, 1924590639, 1813810465, 1207251023, -554343211, -1353937143, 1606540783, 209384370, 79501387, 1621797559, 356893376, -1610632603, 1564389800, 131916785, -1719560714, 144519368, -233292704, -1955252294, -670423181, 503307511, 415639792, -1377778989, 101709685, 82891061, 349752068, 1381941998, 1876352595, 1840681617, 1676492336, 778758364, 1190272032, 331908561, -1882965585, -1088487172, 2078960407, -223775325, -1354300237, 890085013, 701187612, -1721828966, 1808852895, 127734915, -431691058, 122969742, 1846484667, 891073450, 30959874, -1116239329, -1419429828, -1412020292, -748264235, 739087132, 26401288, 1227994842, 1145451518, -146698414, -588851250, 18995305, 186517149, 1685674557, 1529392183, 952083757, 2054941243, 218859263, 250098889, -1620962354, 716227818, 1417401472, 1016411534, -2110887911, -525597646, 1665684852, 872457785, -389711198, -1628291249, -2019248696, 1878726488, 1633157239, -232666211, -1035386697, -622719381, 257446956, -59271548, 498982635, -538719728, 982653922, -350725815, 1672977047, 1482459410, 2008004117, 1558299681, -47237336, -2122274863, -1274850177, -1312806525, 1642986783, 1329105049, 226399245, 1373047064, -1825923111, 285819663, 1308864869, -175947381, -1766328132, 1925852173, 1993346281, 1861951937, 214592616, -3472601, -455517794, 1900570367, 1753611254, 121623769, 408857680, -1944570587, 306282675, -304910871, 676438400, 1008047423, -684202700, 630302507, 1146531006, -2039415758, 333048210, 8236826, -1849587802, -1449059198, 1006084595, -287225996, -2078649649, -231159264, 324491600, -1289003498, -1548976924, 966903637, 490326039, 2123065380, -1185129946, 31828377, 877673151, -1513015951, -2135849581, 1340758435, -1344332898, -456800701, 719885380, 151926389, -8744637, -2134266181, 354892341, -933454259, -1842682885, -94970584, 557681387, 1603301481, -970655441, 900037064, 660240717, 1459633381, 1657380574, 325272821, 266244768, -1711986552, 111910782, 11367926, -1599651721, 1463862765, -1254421147, -789275253, 1636962264, 2066291969, 89899052, -871746739, 611058112, 1764773000, -324712942, 1952965065, -1564008888, -1607690442, 1139504391, 1045563772, 362901441, 682075508, -2043506798, -1693694611, 275207280, 1786471432, -1136770900, -2017986216, -725865650, -1693408213, 1975342014, 319809260, 1178209959, 1020810250, -1433513100, -1178238321, 1805553657, 539424365, -1917156613, -114160455, -786475374, -1923537336, -1173639141, 1505016646, 1183299789, -485986605, 548968665, 1353471107, 1010788835, 1126939146, 1849456774, -586237011, 2104474966, 59568892, -2046384019, 1723140807, 1648984134, 1695499496, 1594194663, -1022462763, 848149138, -86628528, 473359680, -278578930, -1968017529, 633048452, -1414189558, 681627869, 402018206, -73451488, -441496306, -18923814, -1646936850, 1654842156, 1917153424, 1075357322, -156866870, -895953954, 1946324836, 167378442, 721049908, 891429283, 387270428, 198145503, 83626933, 398239706, -1774553279, 1096962263, 485408644, -1905724599, -2112803262, 2007880126, 608034776, 827185631, 177566931, 1735896158, -1573545960, 1423190897, 520632673, 100926985, 1172167605, -899331048, -2019309059, 1748276593, 1568857278, 1183304959, -1548921734, -39816744, 1158468853, 1349543554, -1282907250, 1052650402, 146264754, 298420457, -456562452, -65618946, 1038738107, -684251992, -1795080273, 2044789721, -1800720654, 2002014520, -1158888697, -882873472, -1373651023, 2072089000, 1343684024, 1368227151, -503696544, 1107709405, -1483837641, 1281802587, -1276674590, -649428643, 484123777, -1953839545, 1986901915, -961011869, 1934356327, -1618649754, -1327807923, 1995271853, 1950662531, -1179444050, 644130062, 1549990104, 2126707778, -421081627, -1817377984, -239922369, 2050961182, -737576733, 1581280682, -1548808002, -269783046, -405198539, 153630623, -1614555366, -1675705660, -99466140, -349609350, 861016543, 836746297, -607765868, -1286539112, 950656437, 1788477640, -199401008, 994485357, 1192312704, 781194182, 1669120290, 838938951, -2066884567, 2068445892, 701135468, -1655485781, -1493328943, -1351637468, 1168072880, -162899538, 652407124, -1914415778, -1221321963, -615943614, -1836569596, 876517542, -619559270, -2096280994, 1069741375, -582974764, -906853864, -779870301, -1932944679, -834520164, 358538824, -408117601, -668413439, -1155525101, 948128736, -569373059, -125066624, 1733770055, -1283751091, 176664186, 536350627, -1766464765, -508568545, -1733077435, -1821690935, 2098476483, 1750185949, 1712788363, -1761626233, -842322254, 191471016, -1483728176, -508451526, -1151532189, 1937066916, -1026635882, -757273868, -1205087229, 1134216328, 1964618498, -2025723878, 373493635, 338223124, -1661854313, 969320467, 13538635, -1213208772, 921043853, -52702685, 1078889122, 292122690, 230024040)
"mu" <- structure(c(-4.9888625325015, -5.06248248102182, -4.99422948345155, -4.85269054911984, -4.98825625464352, -5.06118904494163, -4.91963421478544, -2.60612363363852, -3.91799229647268, -5.77896483112659, -6.04416526454814, -4.59970319397119, -2.92606034607215, -2.91239137975613, -5.20550956477966, -3.1561766141976, -5.57545822061688, -3.98107201895324, -2.51241651307523, -3.47514289455744, -5.91243101774835, -2.36939234058357, -3.99341503369098, -1.04876885877626, -3.8209749202776, -2.2316202868392, -5.06179785884862, -2.36381963790329, -3.78696299560456, -2.67698015899442, -3.30014955006119, -0.0800692643557462, -5.84372377904292, -2.13322394048403, -5.28081982925912, -1.5148168844342, -1.68612353009977, -2.26160733762261, -4.78544921602839, -1.87766074375042, -3.15450708466684, 0.498327025441587, -1.64708261662906, -1.92332174603972, -2.11399970350318, -2.2217828087463, -2.67015832623655, 0.134104458894647, -1.64842353923552, -0.0668422182801406, -1.80200327996388, -1.30481416414845, -1.35064994571365, 1.32538603616542, -1.080280518886, -0.500676022507775, -0.84930063058565, -1.19382395254632, -1.26069581649662, -0.26862722899753, -1.23137253230985, 2.25607516888326, -0.891051445974116, -0.728393927359028, -2.01058476231847, 0.16596512451849, -2.03978336647845, 2.55157276614332, -1.07006851013576, -0.990311638932191, 0.0114314295454128, -0.338492124722671, 0.319389886062075, 3.14792703044617, 0.472895843426029, -2.14622409299791, 0.292554107344714, -0.429005335754947, -0.367534247865471, 1.24716343539627, -0.158662754896907, -1.78896428253859, 1.56908700935534, 0.0785156021185908, -0.462604843080784, 0.32780993792405, 0.884298105890653, -1.49553818753428, 0.739671987427875, -0.0404264995661873, -0.262427843985795, 0.517839868497945, -1.16637054286758, -1.65951210605038, 0.958831781242294, -0.427060562725516, -0.218286054639054, -2.29649338754526, -3.55032600087346, -1.46341071012136, 1.88996035055019, 0.0307745222259544, 0.754491270326234, -3.11624274264655, -3.78573505526355, -1.03141508871731, 2.98824987726365, -0.559996017987125, 0.272608577238906, -3.6589063269974, -4.47863980137371, -2.51900448916708, 1.32722478996994, -1.92515799110843, -0.249798627734779, -3.3129837818407, -4.49608765321477, -4.09129129760206, -0.343537469663163, -2.37855496606302), .Dim = c(6, 20))
"tau_obs" <- 1.15326495518057
"tau_proc" <- 0.804672244227079
"tau_yr" <- 106.776169638568
"y" <- structure(c(NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, -5, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, -5, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA), .Dim = c(6, 20))
"yr" <- c(0.0803174530069781, 0.0445279896258506, 0.0501993672734107, 0.127669417418371, 0.148041721475928, 0.0563025471334597)
".RNG.name" <- "base::Mersenne-Twister"
}



######################################################################################################
######################################################################################################
#### Data 
######################################################################################################
######################################################################################################

data{
"y" <- structure(c(-4.06591991745718, -2.94665209430014, -5.80914299031403, -5.80914299031403, -5.80914299031403, -5.80914299031403, -4.59783674154387, -1.88686814833501, -4.59783674154387, -5.80914299031403, -5.80914299031403, -4.59783674154387, NA, -4.06591991745718, -5.80914299031403, -2.94665209430014, -5.80914299031403, -5.80914299031403, -3.26053097886945, -3.72054301540761, -5.80914299031403, -1.93466900116998, -3.72054301540761, -1.98486998368036, -4.06591991745718, -2.60726358981506, -4.59783674154387, -0.668845883547919, -3.72054301540761, -1.47248282297889, -5.80914299031403, 0.655974922329534, -5.80914299031403, -4.59783674154387, -3.72054301540761, 0.281988862342713, -2.51565896414186, -2.70811366311588, -5.80914299031403, -1.18037030439171, -2.70811366311588, 1.31661982654987, -1.53614971441768, -2.82028710501947, -1.53614971441768, -2.15263466474332, -2.60726358981506, -0.0653754237762429, -0.589253733521219, -0.711150923698861, -1.8412483567478, -1.25195872848308, -2.51565896414186, 0.543420073956604, -0.211473338919426, -2.21545316410442, -1.47248282297889, -0.696849461552251, -1.01127799732093, 0.265852896722762, -1.03091569138165, 2.75676687558721, -0.168704041457194, -0.382628870687186, -0.615086916013517, 0.535170022761435, -2.60726358981506, 3.57821555646438, -1.75581432451179, 0.163154257134424, -0.833582703939862, -0.53950714937723, 1.18076288241878, 3.79205461642565, 1.4123738990455, -1.8412483567478, -0.60208690792214, 0.8962786165969, -0.013864711444381, 1.55353770544924, 0.869955466752787, -1.27700755822547, 1.06823942041139, -1.18037030439171, -0.576583164939999, -0.696849461552251, 0.0554034869116419, -0.382628870687186, 0.462152453642488, 0.138825724259713, -1.32906996434575, -0.900920880514602, -0.770494290290964, -0.56407113301186, 1.43788878016486, -0.900920880514602, -2.28248391223017, -1.88686814833501, -2.82028710501947, -0.43587591418692, 2.24561904248638, 0.677760368893093, 1.5185224738127, -2.94665209430014, -4.06591991745718, -1.1135661849228, 4.40231277434833, -2.28248391223017, NA, -4.06591991745718, -5.80914299031403, -3.72054301540761, -0.770494290290964, -4.06591991745718, -0.274600501197854, -3.09132676577126, -5.80914299031403, -3.46431559990757, -1.44210761092232, -2.0377249228153), .Dim = c(6, 20))
"year_no" <- c(1, 2, 3, 4, 5, 6)
"season_weeks" <- c(1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20)
"x_ic" <- -5
"tau_ic" <- 100
"a_proc" <- 0.001
"r_proc" <- 0.001
"a_obs" <- 15.37
"r_obs" <- 7.84


}

######################################################################################################
######################################################################################################

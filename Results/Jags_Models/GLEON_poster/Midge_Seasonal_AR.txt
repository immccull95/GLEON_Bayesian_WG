######################################################################################################
######################################################################################################
#### JAGS model file written by runjags version 2.0.4-2 on 2019-10-04 14:22:14 
######################################################################################################
######################################################################################################

model{
for(k in 1:max(year_no)){
for(j in 1:max(season_weeks)){
#this fits the latent Gloeo to your observed Gloeo 
#run this on logged data
y[k,j] ~ dnorm(mu[k,j],tau_obs)
}
#### Process Model
for(j in 2:max(season_weeks)){
#process model for Gloeo
mu[k,j]~dnorm(lambda[k,j],tau_proc) 
lambda[k,j] <- beta1 + beta2*mu[k,j-1] 
}
#Loops through items in seasonal for-loop and defines initial conditions
mu[k,1] ~ dnorm(x_ic,tau_ic) #keep in mind you'll need to index like a matrix 
}
#### Priors
tau_proc ~ dgamma(a_proc,r_proc)
beta1 ~ dnorm(beta.m1,beta.v1) 
beta2 ~ dnorm(beta.m2,beta.v2) 
tau_obs ~ dgamma(a_obs,r_obs)
}
#monitor# tau_proc, beta1, beta2, mu, tau_obs

######################################################################################################
######################################################################################################
#### Initial values 
######################################################################################################
######################################################################################################

inits{
".RNG.state" <- c(1747088698, 520542191)
"beta1" <- -0.554202656258829
"beta2" <- 0.680194141094449
"mu" <- structure(c(-4.85371743268517, -4.97841622978594, -4.93848253234648, -5.14626679831868, -5.08677544028188, -5.03194524468335, -4.23212918444772, -3.55265449149814, -4.73404608305721, -6.17501390713186, -4.90580182441262, -5.06562432546011, -4.18912202721786, -4.38994318971699, -5.0599214783463, -3.84563695395042, -5.76029050014855, -4.20445543620086, -3.37757060304965, -4.04499906028575, -5.07803312469944, -2.04758578774568, -4.65721760959904, -1.34151221437616, -3.57558592938911, -2.24069572511044, -4.40732845659654, -1.98382158109482, -3.0365800508544, -1.79756606424194, -4.79226494688925, -0.413234241546339, -4.81234493118932, -3.07073648733173, -3.9872975670182, -0.48371934676678, -2.82853252901522, -2.59156679541091, -4.12190716751771, -3.02542926256265, -2.42260765936707, 0.438705530601666, -0.814243995146655, -1.6387545250676, -1.31329074926615, -1.41819753100011, -1.42325879873686, 0.538424395946603, -0.806644906458436, -0.309480611946827, -1.174953587384, -1.5212685080665, -1.83976797984422, 0.510177360574318, -0.602054841101989, 0.0642340553758416, -2.67741217176968, -1.84264126353448, -1.80940916986925, -0.0631867622113077, -1.36597377425536, 1.5111098659217, -0.86634695345868, -1.00132864902031, 0.79836403524622, -0.0269271402976224, -1.17501080000811, 2.53021661259833, -0.582512987498738, -1.81514557039322, -0.680409054903978, -0.976232479336674, 0.635294508004862, 2.96726134740159, 2.13812974083634, -2.87881643489384, -0.69788988001456, -0.687499144021307, 0.71722251270624, 0.881560114489125, 0.789059324923999, -1.50332763498912, 0.720973722257602, 0.134106796785826, -0.616600773581762, -0.740962226338907, 0.996163873881833, -0.88557874337823, 0.212853143911763, 1.04594119970312, -1.08042840214088, -0.0324797471710667, -0.78662827453769, -1.10306258407571, 1.51496847026555, 0.226702815177908, -0.419741717345794, -2.48280151174816, -3.57850731880228, -2.81859347802729, 1.29110204562518, -0.618817935816309, 0.258514957696407, -3.31634974233982, -4.73129116312952, -2.95743562999699, 2.21527131679633, -1.29093424227836, 1.22001688124161, -4.43876970273331, -5.0377350146876, -3.915806614104, 0.068234021741161, -3.98699523711527, -0.121322772204445, -3.38640483602827, -3.62419423705123, -3.30789345771484, -0.857056781096677, -2.02698161607988), .Dim = c(6, 20))
"tau_obs" <- 1.21844063217951
"tau_proc" <- 0.858028883408389
"y" <- structure(c(NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, -1.5, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, -0.333351135253906, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA), .Dim = c(6, 20))
".RNG.name" <- "base::Marsaglia-Multicarry"
}

inits{
".RNG.state" <- c(-723637014, 1540375683)
"beta1" <- -0.359885289432445
"beta2" <- 0.734210664032871
"mu" <- structure(c(-4.84221215355384, -5.02824661924581, -5.13784699204054, -4.88681222019227, -4.92916890875261, -5.03069548891549, -4.67047815229819, -1.33066853147913, -4.72226366158558, -4.60471418001504, -6.30209597937936, -5.03778452936432, -4.54562835810666, -3.74318643613892, -5.53959536241509, -3.69975261274718, -4.80841006303316, -5.07042511769115, -3.40057729139901, -3.21867619668598, -5.99288071804204, -2.14276138107375, -4.14082942948706, -2.10375276769817, -4.20821213345171, -2.56506307825055, -5.619498453422, -1.62230473698797, -4.38216201853258, -1.08677344363312, -5.14608128895813, 0.60577656118739, -5.66795989833395, -4.14794503605356, -4.0622108368097, 1.1752424496846, -2.61895436472996, -2.56982977129026, -4.7233661167008, -3.3303552686724, -1.9672771516431, 0.23075316564389, -0.606719228362993, -3.65741564719615, -0.828885267820434, -2.74045268550542, -2.23993344002334, -1.07183744013606, -0.473429905691188, -2.02513944464395, -1.69067227003947, -1.18622333697874, -2.14316210743852, 0.770740811352983, 0.147223443796455, -0.745079338632128, -0.898985987018712, -0.91591455234981, -1.31612935143661, 1.65920668095565, -1.13418703002933, 3.48743121224568, -0.809393846208764, -0.906810491403771, -0.815750742338493, 0.348123917719124, -1.2278684668272, 3.55255532352839, -1.29225498322491, -0.622588681052078, -1.74742765431603, -0.359811212740807, 0.816260786673812, 3.68822280750624, 0.473925176112361, -1.27937372048925, -1.11154626558304, 0.932604497959186, -0.0919440648620228, 1.14645748840351, 0.162057175678166, -0.946452245136196, 0.396694412945893, -0.725853738973396, -0.112716459441126, 0.933291318245394, -0.31491833785834, -1.18857919978918, 1.73976090884046, -0.287123054650634, -2.68217086075133, -0.0993030024997154, -0.837272221782741, -0.917275155177665, 2.63778350217565, -1.33416866559756, -1.55759643739761, -1.24860580700001, -3.49983624375437, -0.564101806529146, 1.41394730898883, -0.936575729018486, 1.24398682152425, -2.58185723564592, -3.84223362746094, -0.908835662796618, 2.48633350226873, -3.2375635274226, 0.919496677529795, -3.0572539953707, -5.27206012724838, -3.59937562337214, -1.35867527206035, -4.13074972461145, -1.00813004123415, -3.34805249415275, -4.84567297729675, -3.61256982863209, -1.39458301013895, -1.94284207113185), .Dim = c(6, 20))
"tau_obs" <- 2.31339511642188
"tau_proc" <- 0.568476257839444
"y" <- structure(c(NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, 0, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, 0, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA), .Dim = c(6, 20))
".RNG.name" <- "base::Super-Duper"
}

inits{
".RNG.state" <- c(70, -496884577, 188683288, -1368950513, -6008048, 716107839, 422958268, -894188772, -1439840277, -1239453956, 1124909898, -776914773, -23815429, -850887009, 1110241005, -710078414, 1622826348, -773573863, 1559385300, -1474703132, 1855824354, 1846033899, -539901003, 1606072778, -1385417994, -255776201, -1876041330, -2050548173, -1221961900, 911111269, -1959746934, 1146964970, -205342930, 1697304392, -1240631736, 1421329090, -1800081703, 1033353497, -372466075, 932689536, -417071964, -1402237193, 263915429, 810013749, 1302674762, 1530980746, 1299381706, 2048384864, -475312483, 826480389, -488837398, -1082174178, -2087015974, 1004462218, 2052224569, 1080569607, 1855961202, -1312048520, -153857738, 1292477472, -1498836519, -1636434197, -987417609, -630938036, 775582253, 100135205, 1105048136, -673124476, -304975471, 981632085, -1745686287, -170352737, 2099753253, -145951505, 134771879, 60088889, -904763199, -2023780415, 307783304, 1501864447, -772184431, 1168044559, -1634420092, 5615098, -707586872, -1596084993, -40985028, -527084249, -1158070429, -339456222, -2091912058, -1883770094, -1580731982, -1092987666, 2006444338, -2141238586, -2072613539, 226121749, -1344140509, -1721675784, 88508231, -673781971, 336515265, 1070210172, 1028924674, -839733072, 1307009670, -567024518, 1863365278, -2077030161, -1010242797, 357641070, 517644594, -2028227242, 295961841, 1561879121, 680658552, 1150766456, 26769011, 972935732, 856493380, 2111593869, 246293907, 175915236, 1602344449, 1048808552, -2055949358, 1752699623, 1574736534, -2120236450, 953594118, 2119638007, 1352500828, 111069436, -2027266215, 1855069411, -1357217100, 468838991, -1481017036, 2141005251, -265949187, 578813778, -123297071, -173477012, -752632186, 7294349, -1216962180, -2033932324, -1472848595, 945772844, 1137250272, 1366144526, 1841709196, -891008263, -1885404869, -1346935963, -992038501, 1347741949, 140037137, -440440991, -116639244, -1080561723, -1540254659, 1150382815, -1928752096, 371400093, -501301405, 621474721, -281371352, 1776617068, 2059183366, -1208231173, 532764587, -606779291, 1985199165, -2043532181, -1864761029, -625699920, 222451074, 94923205, -404615449, -1530033132, -435084330, -1990088422, 704681042, 1035995539, 1825946842, 563973743, 2004820453, 128757846, -1206715103, -1050054924, -1257010355, -1701948022, 1780125528, -1263400500, -1411151664, 683653551, 1561940212, -1106564859, 624214318, -1373866115, 1080633739, 857753002, -2065478728, 771717829, -1736050416, -2099964452, -986533768, 1821434032, -827205927, 260751367, 1971938929, 1024920378, -1460336453, -101392298, 389840488, -612752750, -1442245462, -336790543, -670131541, 1251697737, 1178657546, 1547923632, 1655406812, -1312818195, -1546310773, 1463115264, -1411486296, -2056567600, 1078946665, 1370469756, -1933173712, 1414670559, -2131053396, 1891153292, -627803355, 847715159, -400116415, -1849413569, -1141861850, 1415982154, -1152978274, -1471033911, 1847358388, -733373134, 446792167, 1213135073, 2105054623, -499107557, 369353863, -1796770852, -1985077256, -968573732, -1413320563, 1068919684, -621894260, -931219791, 1651898524, 599361130, 182819116, -794819315, -1163503195, -1151698047, -737170143, -1780806067, -1506177435, 941002874, 568424772, 1172024325, -65242916, -1481815764, -1503240964, -413351059, 326819368, 1544606343, -383131430, -323044038, 1037015227, -818627191, -1068644389, -219862406, -1889764867, 481019220, 1154140325, 1973146992, -1483616833, 1258530120, -462071859, 1246589480, -2078314061, 1558786595, 1459983472, -170224805, -1538361925, -1948729771, 667460399, 1705969920, 2144193341, -1531057784, -1726237375, -1580418549, 228388121, 1675401623, 1571653484, -405777702, 1588210192, -1871728194, -460992949, 2088096252, -68867683, 424410721, -1167718592, -907756681, 2024517912, -619391210, -234649991, -1067130861, 452393088, -238083144, -797739428, -169402183, 1175301242, 976625836, -337389834, 2119322713, -1122690942, -1562349108, 958644026, 1900742458, -823361534, 1566486095, -860320475, -699015958, -1567919333, -861370890, 540747169, 1619445845, 1446924, 1792230645, 470319339, 2131871253, 215494071, -1728930182, 1239076033, -1095542896, -278908326, 1088779800, 962467724, -824351495, -624406891, -215214325, -317594436, 2090455408, 1454965893, -722279760, -1672155147, -189647957, 352313456, -1061955025, 1125237776, 94947554, -440227069, -867794816, 382848309, -430666510, -673380994, 904780724, -1670315266, -1162743775, 1242671067, 2183488, -1418084147, 1788178433, -2110797625, 1205014726, 891138554, 1024330553, 2119424660, 2116474097, -1738963943, -1940093700, 1409022828, -852146083, 1310297700, -1897452959, -1884896220, 1993474883, 611701339, 910713024, -1465179513, -854242215, 716345948, -1514955781, -1113475319, 557836423, -1002716802, 1406719240, -515555411, 494256313, -1088025250, -1407255022, 1754663850, -506592586, -1414014155, -14557743, -1556222589, 1187827847, 1269051034, -1552664998, -504362707, 1970118549, 371367213, 10928906, -1772382309, -1733347485, 1974034766, -1373119116, 144698472, 1162074135, -492039634, -1556796166, 105689234, -1631788925, -1146766159, -1867073299, 1961873560, 2135004564, 1099254073, -1856326451, -298961309, 1359340966, -1588731995, 1830250235, 1950512202, 1966914979, -286905556, 1035633077, -512904805, 266603588, 847877585, 1331603257, 1914875641, -1935431888, -1826948014, 381759797, 851438131, 1675418353, -1085865440, 1061245890, 1158656501, 1189998303, 494091296, 227353149, -657783469, -1510513023, -439251868, 543074120, -1314699603, 1049205963, 1785218100, 2097974339, 1098143902, -324982229, 333684231, 1059167467, 457202254, -1515277264, -1994555051, 10361807, 1026415321, -1833114753, -98275028, -1313457134, -417701790, 497516530, -135640892, -1578832545, 1587147832, -1333729378, 1150949068, -1727505577, -631040308, 1214868195, -28213897, 1837599698, 1865862445, -1675498439, 456776977, -43202755, -356755427, -762318364, -802476608, 325224055, -1094773691, -176663503, 641561187, 1007243898, -266737404, 643985780, 1484269553, -1186802579, -504675283, -1911741581, 498088786, 1132378533, -2015887132, 5074022, -1802081672, 1147301805, 483691983, 569215819, -574857305, 1225939153, -1953734957, 1758192908, -814012908, -1804256766, -311117711, -1209357337, -965019350, -839693252, -1283008910, 252729078, -1795327152, -597423573, -414855373, -1628038773, 688381037, -1579339198, -1968958172, -1250059842, -848194052, 1685781009, 44705571, 1662882800, 232168350, -446960280, -1888854169, 721314449, -1444155496, -1273513499, 552627730, -1647907749, -774202911, 966365110, -1226074286, -718386180, -627158380, -1435002983, -1533518073, -965600849, 2045274914, 1358929673, 814675134, -660068101, 253280403, 337830353, -348124447, -851618931, 175044920, -1052440209, -1577787360, -967951888, -2138689516, 605818764, -956386204, 1497606536, 2026822204, -670899821, -1518980997, 454411164, 1516208439, 1303997022, 762396686, 407513382, -1852243241, 1881233540, -893251526, 103769943, -490842199, -840102515, -1038114628, -1739954593, 1108907307, -885466222, -2143934892, -1344331648, 1949988028, 915268320, -1326227607, -887923503, -2060358803, -223224401, -1619157046, 526279889, 1496639179, -1496828523, 1214138633, 536387538, 1502650510, -1131690490, 1168727883, -906543356, -681800985, 1026319186, 583442401, -559607779, 1743855521, -1705974567, 917567921, 834641063, -1549594298, 2031577313, -443544394, -1826852090, 528456755, -445487506, -1349694801, -367383719, -65702944, 1067531930, 585818224, -9027198, -1142851688)
"beta1" <- -0.535825442382049
"beta2" <- 0.703335274022215
"mu" <- structure(c(-5.03788189925901, -4.92095553224525, -5.13040657215133, -4.93522884675381, -5.13056639479036, -5.19699158089294, -5.6826049835351, -2.72471240281083, -4.25515289423584, -4.98240836797803, -4.6868868011748, -4.61805516862136, -2.92059959341337, -3.35825689885595, -5.80277686479422, -1.65491834297401, -5.43434215408949, -5.58314922095218, -3.48090711695998, -3.44601485782028, -5.13504852091539, -2.485994001341, -3.78763210410022, -2.3708966634415, -4.07123399030958, -1.78961405921511, -4.48408261572212, -1.23226636003884, -4.24446201126183, -0.26579445645474, -5.05447743411481, 0.601831341902421, -6.21987178702704, -3.19029287329195, -3.27803941389124, 0.332742518206519, -3.339966831147, -2.08473860310407, -4.31440625198228, -1.89863055253914, -3.34002109703558, 2.38052686138713, -1.25567428360155, -2.35189907686938, -2.37889824617776, -1.57125189126441, -3.1301325800117, -0.947960725867425, 0.59871257104693, -1.56181831836932, -2.07271636920275, -2.57034102217002, -2.38610999431799, 0.00995171252522298, 0.25504214738394, -1.4415640496183, -1.18859630072493, -0.858839785635276, -0.547757036919165, -0.258511681771798, -1.35099320841478, 1.87493654647325, -0.469987754988894, 0.168798884097951, -0.891896227129028, -0.635978488606361, -1.53429507740416, 3.22098716317546, -1.35273244975591, 0.252043563527149, -0.655404711611471, 0.578479315295552, 1.07705389807758, 2.81276940729848, 1.07278671598889, -1.441118208655, -1.07908508246823, 0.655638462561481, -0.055276589046712, 0.975575203633603, 0.385020426338494, -1.59366607296735, 0.00887753979819739, -1.13849103215525, 0.0300044781386843, -2.78222825629852, 0.13896371587966, -0.850892998921373, 0.0787224631831648, 0.320107726064139, -1.95539113215838, -0.723718356105905, -1.18641761072477, -0.973755220923993, 1.13601550710199, -0.439293994736953, -2.83503036786105, -1.02073265545265, -3.27834923784305, 0.181803377977876, 2.79473797016493, -0.213118880756493, 0.84038675922, -2.91545688141516, -4.46960935405152, 0.113091173922002, 3.09594429711402, -2.67817562921303, 0.325823854312919, -3.52344722073862, -5.23445389959631, -2.68199148056071, 0.671607652564393, -3.91608203475808, -0.345150894704897, -3.26259802760908, -5.15280431181399, -2.87557781357306, -1.92650223815953, -3.10488293092145), .Dim = c(6, 20))
"tau_obs" <- 1.97689873433069
"tau_proc" <- 0.479560245018618
"y" <- structure(c(NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, -0.5, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, 0.999977111816406, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA), .Dim = c(6, 20))
".RNG.name" <- "base::Mersenne-Twister"
}



######################################################################################################
######################################################################################################
#### Data 
######################################################################################################
######################################################################################################

data{
"y" <- structure(c(-4.06591991745718, -2.94665209430014, -5.80914299031403, -5.80914299031403, -5.80914299031403, -5.80914299031403, -4.59783674154387, -1.88686814833501, -4.59783674154387, -5.80914299031403, -5.80914299031403, -4.59783674154387, NA, -4.06591991745718, -5.80914299031403, -2.94665209430014, -5.80914299031403, -5.80914299031403, -3.26053097886945, -3.72054301540761, -5.80914299031403, -1.93466900116998, -3.72054301540761, -1.98486998368036, -4.06591991745718, -2.60726358981506, -4.59783674154387, -0.668845883547919, -3.72054301540761, -1.47248282297889, -5.80914299031403, 0.655974922329534, -5.80914299031403, -4.59783674154387, -3.72054301540761, 0.281988862342713, -2.51565896414186, -2.70811366311588, -5.80914299031403, -1.18037030439171, -2.70811366311588, 1.31661982654987, -1.53614971441768, -2.82028710501947, -1.53614971441768, -2.15263466474332, -2.60726358981506, -0.0653754237762429, -0.589253733521219, -0.711150923698861, -1.8412483567478, -1.25195872848308, -2.51565896414186, 0.543420073956604, -0.211473338919426, -2.21545316410442, -1.47248282297889, -0.696849461552251, -1.01127799732093, 0.265852896722762, -1.03091569138165, 2.75676687558721, -0.168704041457194, -0.382628870687186, -0.615086916013517, 0.535170022761435, -2.60726358981506, 3.57821555646438, -1.75581432451179, 0.163154257134424, -0.833582703939862, -0.53950714937723, 1.18076288241878, 3.79205461642565, 1.4123738990455, -1.8412483567478, -0.60208690792214, 0.8962786165969, -0.013864711444381, 1.55353770544924, 0.869955466752787, -1.27700755822547, 1.06823942041139, -1.18037030439171, -0.576583164939999, -0.696849461552251, 0.0554034869116419, -0.382628870687186, 0.462152453642488, 0.138825724259713, -1.32906996434575, -0.900920880514602, -0.770494290290964, -0.56407113301186, 1.43788878016486, -0.900920880514602, -2.28248391223017, -1.88686814833501, -2.82028710501947, -0.43587591418692, 2.24561904248638, 0.677760368893093, 1.5185224738127, -2.94665209430014, -4.06591991745718, -1.1135661849228, 4.40231277434833, -2.28248391223017, NA, -4.06591991745718, -5.80914299031403, -3.72054301540761, -0.770494290290964, -4.06591991745718, -0.274600501197854, -3.09132676577126, -5.80914299031403, -3.46431559990757, -1.44210761092232, -2.0377249228153), .Dim = c(6, 20))
"year_no" <- c(1, 2, 3, 4, 5, 6)
"beta.m1" <- 0
"beta.m2" <- 0
"beta.v1" <- 0.001
"beta.v2" <- 0.001
"season_weeks" <- c(1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20)
"x_ic" <- -5
"tau_ic" <- 100
"a_proc" <- 0.001
"r_proc" <- 0.001
"a_obs" <- 15.37
"r_obs" <- 7.84


}

######################################################################################################
######################################################################################################

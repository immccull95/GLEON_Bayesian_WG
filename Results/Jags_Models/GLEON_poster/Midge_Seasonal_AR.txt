######################################################################################################
######################################################################################################
#### JAGS model file written by runjags version 2.0.4-2 on 2019-10-05 20:19:46 
######################################################################################################
######################################################################################################

model{
for(k in 1:max(year_no)){
for(j in 1:max(season_weeks)){
#this fits the latent Gloeo to your observed Gloeo 
#run this on logged data
y[k,j] ~ dnorm(mu[k,j],tau_obs)
}
#### Process Model
for(j in 2:max(season_weeks)){
#process model for Gloeo
mu[k,j]~dnorm(lambda[k,j],tau_proc) 
lambda[k,j] <- beta1 + beta2*mu[k,j-1] 
}
#Loops through items in seasonal for-loop and defines initial conditions
mu[k,1] ~ dnorm(x_ic,tau_ic) #keep in mind you'll need to index like a matrix 
}
#### Priors
tau_proc ~ dgamma(a_proc,r_proc)
beta1 ~ dnorm(beta.m1,beta.v1) 
beta2 ~ dnorm(beta.m2,beta.v2) 
tau_obs ~ dgamma(a_obs,r_obs)
}
#monitor# tau_proc, beta1, beta2, mu, tau_obs

######################################################################################################
######################################################################################################
#### Initial values 
######################################################################################################
######################################################################################################

inits{
".RNG.state" <- c(456, -346590295, 1049356942, -1618412049, 912942266, 1809260864, -833702330, -826701712, 1115367640, 1913379919, -241605912, 397940207, 1481388990, -1420857707, -600756488, 291053882, 1376437008, -1336797686, 644983685, 1955206071, 815643622, -1265444597, 1932708708, 951784588, -2065104411, -641115944, -2111296157, -83396108, 978315465, 329741987, 1371681854, -210716842, -1664927586, -951916009, 1321636380, 626938763, -1877206504, -106413302, -1669439866, -1955633235, -2025143471, 1377754438, 929155735, -1851436528, 112749576, 307327504, -88629359, -1942486962, 419060515, 978573457, -1664746483, -1225182798, 1980479374, -602678803, 232435036, 850066224, 2028010587, -1853982946, 481449199, 763510554, -112949481, -560960980, -1631828587, -488063668, -1780075271, -363934324, 761224739, 748989413, -1966183777, -1502134771, 478791102, -136706565, -910588217, 1830174853, -674610676, -470540614, 442147399, 2043378218, -1979992331, 1349731583, -252970532, 181830756, 1335942706, 1264724618, 638772519, -1015455292, 1798328324, 289720959, 1164178674, -753252920, 1595964808, -1119115553, 1379019480, 1041375699, -1326966147, -225542693, -269238947, 890103601, 1144141955, 1384944195, 916459784, -1388127778, 269159315, -82449029, 1572203675, 315628809, 621668680, -1465571920, -1211257400, -1958751993, -1051313716, 1903421896, -1458408001, 819447618, -51251382, -835491077, 242489463, 1265846051, 799417019, -867685464, 1967009516, 1525986999, 1000077508, -803825501, -760173979, 1768386137, -1895583629, 862600008, -1359221721, -1356754168, 1770892527, 541082730, -568315259, 777939, 163193865, 1826458305, -153019514, -2050924409, -2075227652, 1845181975, 611375279, -1292300137, 2000909743, 776325792, -1792857242, 547466542, 589477648, 342993393, 1375987955, -1019459861, -1746149405, 579853645, -436641871, 1347351126, -849097617, -717985043, 1078505972, -117905249, -1241147567, -833844849, 1064642153, -1459457950, 1506632965, 1781754329, 1667748484, -717531243, -394680780, 1823992685, -1091983653, -1355176454, 416433200, -1108946507, 995967290, -986418256, 1811240212, -125766463, 1129192080, 1282393094, 617150729, 1344508683, -1153719571, 440958092, -309109589, 1913416769, 119690906, 446988399, 943047771, 1968327591, 1208314845, -689264107, 747502231, 359652050, -1555345760, -1960003624, 1052014072, -1482730011, 1620915872, -1468227402, 1257512121, -27207567, 629273061, -1477997130, -2115747284, -1915568018, -512788746, 1282827663, -2087708816, 832892279, -1969432718, 1859563101, -503950651, -636388323, -1769266117, -938807635, 657612462, -989427423, 861327085, -875502990, 1286016779, 532818185, -1198843282, 1987283381, 1637344870, -473780584, -409476807, -1986330690, -1499942650, 473232072, -334372966, -1754812515, 21089272, 982035602, 2010470412, -581752658, -2044495073, -1384871642, -503626370, 183987248, -1103313330, -596909424, -183391532, -654365853, 928942029, 1910265837, 2030129755, -2078631954, 902856981, 1158088505, 1072210414, -206325734, 1164622489, 656431868, -28375605, 214353175, -582240429, 370434155, -1810658523, 422882642, -141222914, -1620545657, -1991130904, 375468782, 21423099, 120804508, 1147438555, 1220390885, 1227900634, -1938594336, -1593695610, -1370004232, 167414574, 2026068131, -2083274157, 2015328743, -867050297, -1232112807, 1299219567, -2115764026, -2040165503, 370334911, -1753256320, -1672808316, 574507209, 77100113, 1000007337, 327722115, 1604681235, 181781501, 1811576963, -644870747, 1320225641, 153391098, 344030103, 1929524131, -2091829382, -1548017261, -952725957, 439903913, 665922750, 1789253260, 128876730, -1223836669, 1027333023, 2002259068, -359347636, -614775373, 1902514467, 1458163518, 1210633293, -1529031952, -1176850273, 285050748, 788705655, -1994446033, 2128868340, -144889570, -1106821194, -1071594051, -718567072, 94568112, 7229865, 503355969, -849368576, 904509618, 472822141, 221231016, -1364525880, 1062949046, 673055986, 1061090478, 1761056579, 951990910, 149894711, 680795109, 1398216646, -1131144051, 1701616526, -435620777, -682635706, -362557631, -1959283090, 169441368, 2082209362, -1706796563, 2008041973, 514774770, 319090844, -105935065, 1404313212, 511789099, 2086096573, -1253834744, 723565989, -1475982450, 1106276840, -1223297387, -1559003245, 1340087839, -1295400529, 1300891223, 171848039, 1943029630, 2033600647, -432119799, 1045168265, 826902746, -98373518, -1010549787, -1923570350, -118856951, -62271403, 404734762, -1255462421, 106443441, 2024148217, -1963668381, -310993997, 1421073128, 1050418844, 838163004, -372776607, 1592877441, -1089684438, -1675549831, -845962566, 38835729, 1562936061, -391193824, 1406942851, -1714111079, -1303505510, -1146991327, -1305098201, -1420120118, -1180885893, -1707024462, -2108728767, -707766323, 935639168, -1796125989, -479555, -607859859, 1632968338, 85464523, -1700866500, -273531753, 1183561700, 613201954, -197620767, 168526094, -256982594, 187450563, -365429593, 658826968, -1794187176, 1662039851, -837867433, -54329367, -2079752515, -1713233900, 213655433, 1477713531, -628351553, 952969664, 1222745694, -1463962221, 184629632, -573175180, -773027382, 455827176, 1727338099, 2000973980, 1319720787, -1444804824, -373153904, -1752357460, 1385626366, -262845012, -823521628, -447971498, 1294976028, 927464242, 113278018, 141405971, 1774292523, 1027038138, 1106610189, -1366076041, -99139873, 84042554, -1633892005, 1779165582, -714459829, 1693800107, -900033627, 947316845, 1193234233, -1799365498, -1876937840, 1663410257, 250391662, 908970805, -700205374, -428433711, 885586864, -1130606762, -175423038, -1696032126, 548001776, -1290148964, -1456659355, 773598174, 727226170, 2135147419, 1725657241, 1291229889, -1681708848, -1005711533, -912479214, -216346427, 1910384333, 1061466603, -219409351, -166260990, -1440596062, -1131661843, 1302751358, 2054048994, 1088780445, 367827438, -186999279, 1102561985, 1118823163, 1000980062, -66325416, -1929678973, -296357679, -2048544062, 1714530645, 1136278972, -1720116988, 2023797370, -281625349, -1926440054, 576892097, -951565810, 1336761066, -59098834, -1899224039, -1302803096, 534749703, 1872678507, 1366128488, -1738049461, 1266310305, -1467467164, -475626106, 1229655030, -1310712165, 1528660180, -484693614, -1188755720, -1752112217, -231777315, 482634420, 1407242110, -296597818, -658597080, -832643014, -931341474, 873745957, 198380703, 1844730627, -1808145236, 111827395, -1473559069, -1117416573, -595466335, -1489721103, -841452064, -1348954295, -735746859, 1538566355, 733014670, 426616391, 626507256, -288781521, -1285144501, 1627179023, 1290169226, -808955164, -503490755, -438825421, -498296964, 1580728764, -1814265990, 204598527, -127817263, 1035150, -1106328081, 872949608, 2011747395, 303629244, 1706464793, -935853816, -615624405, 1687489084, -827922521, -472238192, -48948227, -743980273, -1923782284, 996426048, -524669167, 1803292409, -1122489720, 98294747, -165275990, 246235106, -1520764682, -1735357219, 831844607, -2006110164, -1895787830, -1444357480, 2141256519, -163790891, -209363552, -458162784, 611241964, -1248457336, 1927593199, 1679324392, -840301960, 495631648, -1308940861, -1413251138, -1429582421, 100655760, 1819498426, -2055873140, -358730632, -1859070867, 1818544469, 1380058168, -2007753362, 737382249, 1457791647, -2005654219, -274614942, 751833869, 2110900706, 1691236454, 1207471678, -827228358, 579486729, -697181116, -659941526, 1096293672, 1188450635, 1157735591, -1180696162, -1858774209, -1725245645, 2037604038)
"beta1" <- -0.387372239602523
"beta2" <- 0.72378341458947
"mu" <- structure(c(-4.94401962314812, -4.83692988375637, -5.10166166212591, -4.89694751152344, -5.13643799154509, -4.96633570036469, -3.83021536635457, -2.63836862753915, -5.47311664561825, -4.02713353624418, -5.89070810906347, -4.65663385558457, -4.62525261725029, -4.44120385615409, -5.34551414067528, -3.30296978729096, -4.47299469692984, -4.39231278925654, -3.77313247542242, -3.70844809069861, -6.04601735682231, -2.99816455086321, -3.51800827846544, -3.08727106375836, -5.38709972282444, -3.20578719238315, -5.83879179933248, -0.200539614116733, -3.4975798192393, -0.829309498051248, -5.06559904899263, -0.173127818884115, -6.33579759300135, -2.4935792936373, -3.81349557387466, 1.10975006806436, -1.57806474417584, -1.48026444702004, -4.83696020822869, -1.35387588521812, -3.77422208997075, 1.15247218552375, -1.55856423483036, -1.08148403601289, -1.91115845186681, -2.65104339875533, -2.57104721224868, 0.199855178843179, 0.00319945397192511, -0.664330265700425, -2.50885057232752, -0.38190993108912, -0.587480378712396, 0.117988424191038, -1.34264576411919, -1.05758237733679, -2.49574393936171, 0.195221750787985, -0.844575963297956, 0.699561575957085, -0.864837863027344, 2.54443221553424, -1.36607692146603, -0.703819973119369, -0.8856864471398, -0.202308710731339, -1.67632895143179, 2.89700902874176, -2.79635331721169, 0.167769622540579, -1.39287807972414, 0.190864159254114, -0.138110401082136, 2.18879071745886, 0.396567602599857, -0.197343821206509, -1.11870098535318, 0.474574450551436, 0.785912464539838, 2.57570202740401, 0.305295492256534, 0.239842267835554, -1.15122617298595, -0.422988870505501, -0.605104862634162, 0.344061236881499, -0.687933345835725, -1.08094352115803, 0.617802150025704, 0.671106373212323, -0.650439468653074, -0.800720067310055, -1.23323339286951, -0.140215042812956, 1.88333694322036, -0.937358799958169, -1.58019029904022, -2.17426836180737, -2.73753472688267, -0.429763946668766, 3.55351593738324, -0.818435592489288, -0.348230771098243, -3.25443394284884, -3.58447143289336, -1.11872227017615, 3.73204249616426, -1.54301414522557, -0.301417518539298, -2.67053851659131, -5.99887863213854, -3.48359943725719, 1.38932990493446, -4.31899264620168, -0.197052103050999, -1.21379873474503, -5.29017452623642, -3.43112405418487, -1.02421217176955, -1.61479035529949), .Dim = c(6, 20))
"tau_obs" <- 1.32178570038724
"tau_proc" <- 0.807270424596752
"y" <- structure(c(NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, -1.5, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, -0.333351135253906, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA), .Dim = c(6, 20))
".RNG.name" <- "base::Mersenne-Twister"
}

inits{
".RNG.state" <- c(14169, 22287, 23171)
"beta1" <- -0.153128410397108
"beta2" <- 0.750381172599301
"mu" <- structure(c(-4.86692453462, -4.97960525992623, -4.97579170912949, -4.85752110683264, -5.10318776767381, -5.04432987773372, -4.0341953083974, -1.801752782425, -3.58648343681823, -5.20033254373206, -5.2783457004916, -4.50847779380016, -3.2786118927376, -3.28324509121969, -3.92207481535433, -4.23777281608468, -5.93058900853275, -5.50961742213895, -3.99062086362342, -3.97345779607587, -5.01775586030494, -3.60232560446582, -4.10593369353322, -2.37323398842735, -4.6992545349211, -2.57101650730542, -4.73402242430687, -1.84771219046436, -4.46611568721907, -1.11228199278658, -4.77205752860473, 0.843831199044952, -7.0520474582306, -3.83068119568264, -4.22760448259774, -0.172757063418273, -2.49488405201596, -3.69099254354524, -4.69630340879367, -1.71340828220762, -3.4354473632538, 0.747722898576979, -2.86516224079464, -2.16219874564321, -1.79423459912878, -2.24709942840859, -1.71115147715482, -0.573481991349935, -1.97592799355566, -1.68781585980293, -1.74162121861445, -0.596256159523793, -1.15677776681836, 0.154742460472878, -0.60841011829325, -0.831382566908844, -1.27795185769565, -0.728569093349369, -0.458451021151632, -0.0898385731104285, -2.09252424610356, 1.7716166206352, -0.702644472520921, -0.232019221355341, -1.39368164409906, 1.53912611431233, -3.60993126160464, 2.76249944911408, -1.83054857257092, 0.971942598440326, -1.08901056531604, -0.346473654018254, 0.621133030559701, 4.02539723187247, 1.17189602204936, -2.30459051883768, -1.12416773219785, 0.848995609419705, -0.586592861228933, 1.6931711800941, 0.938076982428045, -1.21587505243278, -0.0218651584102058, -0.900366798057642, -0.855202868295591, 0.28191780411654, -0.990630885829341, 0.0367094189254069, 1.09182525237797, 0.0501954351662852, -2.48482603870765, -1.09563142940845, -1.05969790525824, -0.00397352197061906, 0.896802127439846, -0.0507572223619214, -3.05057837496095, -2.53884707040815, -2.42381424466167, -0.743678199253849, 2.71042200491072, 0.721863522999412, 1.61053578833477, -2.98347115312849, -4.37832507938643, -0.606551619103709, 3.64924452213492, -2.37771530379565, 2.70498944928684, -4.14075431096268, -5.29249413070257, -3.10283159539345, 0.0658837624469883, -3.98611726410663, -0.406174057862596, -1.96323056710753, -6.0725442185548, -4.18174320954704, -1.55794148308773, -1.5533075299866), .Dim = c(6, 20))
"tau_obs" <- 1.70913396865399
"tau_proc" <- 0.485941501920392
"y" <- structure(c(NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, 0, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, 0, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA), .Dim = c(6, 20))
".RNG.name" <- "base::Wichmann-Hill"
}

inits{
".RNG.state" <- c(1631153176, 676062711)
"beta1" <- -0.44283480511243
"beta2" <- 0.763801862171807
"mu" <- structure(c(-5.00688644260278, -5.10466636087755, -5.0991942487579, -5.03348283521368, -4.9569954936943, -4.94341758900343, -4.72996476168348, -2.82507276933556, -4.66621742148461, -5.31060834684305, -5.58142438111078, -5.25409974641034, -3.8820013074743, -4.19093111653727, -5.44591714747734, -2.99481230669356, -5.24157064051716, -5.19195365416254, -4.0448190520761, -3.26464914638689, -4.37046878942918, -2.65620525096689, -5.21087152686008, -2.4776310855718, -3.93130399490645, -3.14936803174538, -4.84385335767982, -1.53961423419783, -4.03022335602099, -1.50504515216385, -6.14455091623595, -0.269532790579901, -5.79876365251992, -3.0487167172418, -4.73831339282839, -0.341683638813856, -3.46834726142968, -2.57563212355679, -6.0113565834367, -1.66788488363273, -2.33298836277273, -0.283297112497419, -1.82325236731973, -2.14154549080362, -1.99021376816473, -2.27810949841454, -3.05788987472106, -0.0417050639322915, -0.833691944857423, -1.56801189970738, -1.95410077811895, -0.699412240216406, -3.15712051971225, 0.0871524687617179, -1.12268970413826, -1.08445280842198, -2.22420957876693, -0.29732459604343, -1.75432968431386, 0.685641161895593, -0.893621501920425, 2.97525226458021, -0.334158480196138, -0.305658774173234, -0.519955241361703, 0.504042333537364, -2.0007934406038, 4.01623836400016, -0.810451213263305, 1.0013603706242, -0.956939092845221, -0.454110864438057, 0.29011634937523, 4.31718491694952, 1.12279816496657, -1.56697649863094, 0.239192261398962, -0.272878060938476, 0.273822767496724, 1.58594283279671, 1.15720681046323, -0.452077096069563, 0.681086257129847, -1.55890038748971, -0.126645568509814, 0.0750314879678464, -0.317445287675853, -1.34268650633614, 0.172074992101379, -0.250533856767589, -0.638187096915717, -1.2250304631903, -1.32330332048027, -0.628960948511211, 0.888482888326337, 0.182717409997199, -1.28415739463358, -1.87105497410766, -3.27041105160781, -0.187145906198678, 1.7933729423189, -0.643812826918575, 0.453093470061517, -3.43562555998592, -4.89030245326018, -1.25145023390187, 3.77868645717957, -2.26751455426977, -2.4771197489556, -4.26514902488643, -5.68709957318274, -3.12687983118306, -0.776465910721282, -3.34330120042662, -0.525478917994573, -2.67197335907244, -5.14379964676781, -4.54327030153513, -0.512951128115138, -2.42277038430364), .Dim = c(6, 20))
"tau_obs" <- 2.24347312491193
"tau_proc" <- 0.438720175741074
"y" <- structure(c(NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, -0.5, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, 0.999977111816406, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA), .Dim = c(6, 20))
".RNG.name" <- "base::Marsaglia-Multicarry"
}



######################################################################################################
######################################################################################################
#### Data 
######################################################################################################
######################################################################################################

data{
"y" <- structure(c(-4.06591991745718, -2.94665209430014, -5.80914299031403, -5.80914299031403, -5.80914299031403, -5.80914299031403, -4.59783674154387, -1.88686814833501, -4.59783674154387, -5.80914299031403, -5.80914299031403, -4.59783674154387, NA, -4.06591991745718, -5.80914299031403, -2.94665209430014, -5.80914299031403, -5.80914299031403, -3.26053097886945, -3.72054301540761, -5.80914299031403, -1.93466900116998, -3.72054301540761, -1.98486998368036, -4.06591991745718, -2.60726358981506, -4.59783674154387, -0.668845883547919, -3.72054301540761, -1.47248282297889, -5.80914299031403, 0.655974922329534, -5.80914299031403, -4.59783674154387, -3.72054301540761, 0.281988862342713, -2.51565896414186, -2.70811366311588, -5.80914299031403, -1.18037030439171, -2.70811366311588, 1.31661982654987, -1.53614971441768, -2.82028710501947, -1.53614971441768, -2.15263466474332, -2.60726358981506, -0.0653754237762429, -0.589253733521219, -0.711150923698861, -1.8412483567478, -1.25195872848308, -2.51565896414186, 0.543420073956604, -0.211473338919426, -2.21545316410442, -1.47248282297889, -0.696849461552251, -1.01127799732093, 0.265852896722762, -1.03091569138165, 2.75676687558721, -0.168704041457194, -0.382628870687186, -0.615086916013517, 0.535170022761435, -2.60726358981506, 3.57821555646438, -1.75581432451179, 0.163154257134424, -0.833582703939862, -0.53950714937723, 1.18076288241878, 3.79205461642565, 1.4123738990455, -1.8412483567478, -0.60208690792214, 0.8962786165969, -0.013864711444381, 1.55353770544924, 0.869955466752787, -1.27700755822547, 1.06823942041139, -1.18037030439171, -0.576583164939999, -0.696849461552251, 0.0554034869116419, -0.382628870687186, 0.462152453642488, 0.138825724259713, -1.32906996434575, -0.900920880514602, -0.770494290290964, -0.56407113301186, 1.43788878016486, -0.900920880514602, -2.28248391223017, -1.88686814833501, -2.82028710501947, -0.43587591418692, 2.24561904248638, 0.677760368893093, 1.5185224738127, -2.94665209430014, -4.06591991745718, -1.1135661849228, 4.40231277434833, -2.28248391223017, NA, -4.06591991745718, -5.80914299031403, -3.72054301540761, -0.770494290290964, -4.06591991745718, -0.274600501197854, -3.09132676577126, -5.80914299031403, -3.46431559990757, -1.44210761092232, -2.0377249228153), .Dim = c(6, 20))
"year_no" <- c(1, 2, 3, 4, 5, 6)
"beta.m1" <- 0
"beta.m2" <- 0
"beta.v1" <- 0.001
"beta.v2" <- 0.001
"season_weeks" <- c(1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20)
"x_ic" <- -5
"tau_ic" <- 100
"a_proc" <- 0.001
"r_proc" <- 0.001
"a_obs" <- 15.37
"r_obs" <- 7.84


}

######################################################################################################
######################################################################################################

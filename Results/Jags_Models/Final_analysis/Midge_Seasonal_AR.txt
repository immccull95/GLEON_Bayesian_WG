######################################################################################################
######################################################################################################
#### JAGS model file written by runjags version 2.0.4-2 on 2020-02-06 11:43:05 
######################################################################################################
######################################################################################################

model{
for(k in 1:max(year_no)){
for(j in 1:max(season_weeks)){
#this fits the latent Gloeo to your observed Gloeo 
#run this on logged data
y[k,j] ~ dnorm(mu[k,j],tau_obs)
}
#### Process Model
for(j in 2:max(season_weeks)){
#process model for Gloeo
mu[k,j]~dnorm(lambda[k,j],tau_proc) 
lambda[k,j] <- beta1 + beta2*mu[k,j-1] 
}
#Loops through items in seasonal for-loop and defines initial conditions
mu[k,1] ~ dnorm(x_ic,tau_ic) #keep in mind you'll need to index like a matrix 
}
#### Priors
tau_proc ~ dgamma(a_proc,r_proc)
beta1 ~ dnorm(beta.m1,beta.v1) 
beta2 ~ dnorm(beta.m2,beta.v2) 
tau_obs ~ dgamma(a_obs,r_obs)
}
#monitor# tau_proc, beta1, beta2, mu, tau_obs

######################################################################################################
######################################################################################################
#### Initial values 
######################################################################################################
######################################################################################################

inits{
".RNG.state" <- c(135, -1514333178, -1343431406, 1086670748, -69234656, -2096076696, 1875113933, -215089799, 1968230461, -735867716, -451000881, -187303125, 778578678, 1073296997, 679858609, -609937547, -1518360536, -1596878904, -179535972, -964772803, 80084371, 2046347799, -99565457, 897840110, 1665472405, -539257242, 4014823, 1040784940, -148833241, -1052988045, 1272277347, -659335504, 841880048, -115860045, 1204356794, 286555905, 1312990383, 1859900453, 602530976, 2027286305, -1532219686, 719920553, -282513648, 1150899822, -942883899, -136219842, -797550058, -1623791812, 1399644048, -372191670, 624768659, -532753220, -765082499, -201888436, -609103737, -1434720502, 1423553880, 2095130245, -1428269359, -1946050014, 1419511305, 969007930, 501459047, 1289513835, -1344392866, 2011085012, 929855205, 134342818, 892497657, 963570871, -544086615, -230881954, 110543535, -406929042, 1909917457, 1986316332, 1511376668, 339278663, -939615461, 663934817, -394197129, 1443991308, 1813333231, 1550260159, 1248203785, -1817570564, 1522946005, 1453996389, -633874756, 2033882867, 434133433, -650149095, -586909393, 1791917367, 1554440418, 1471301942, 1063564032, 2079414606, 707357190, -631295056, -595516805, 1273129403, 1933327417, -263125049, 1661275123, 1121734166, 1021832129, 582627532, -1716131613, -679363923, 46771721, 1329275056, 606956893, -1127130968, 292753675, 2099985407, -963053277, -1954549447, 1324409295, -1790048951, 928337398, -1953741663, -1633541521, 1461761653, -1665898240, -602956230, -1431648012, 1289862946, -351725179, 1511295872, -1130647657, -1010190079, 149878823, -1154708988, -1368555157, 2029972857, 1323984797, -900905773, 179130120, -927177814, -863267808, -234908052, -419397883, -803688875, 1949856585, -719113449, -1394111167, 1442093981, 54471037, 1076930315, -802840674, 1335794737, 589535544, -609992559, -244502542, -1975892112, 1705669848, -1666779771, -2111360172, 839403798, 1247018497, -217461233, -1072011282, -161617519, 784190432, -1174780182, 906286632, -1578475136, -425032195, -1976690938, 1341088152, 1526024827, 1438996956, -644115238, 988081316, -944759227, 705135562, -1360827873, 2006726059, 1233049788, -1018037242, 1767651188, -709421630, 1789444928, -226727012, -174663107, 604268807, -1483238514, -87953826, -482798861, 4032508, -721922864, 386773714, -374360980, -939027224, 1015651525, -1879347769, -331535952, -1914713596, -1783417426, 1683069362, -13531543, -1868279777, -1123738827, -1661529390, -332771676, 1640630906, -1143609210, 1604713353, -1405851364, -1308342021, -1754900742, -1510938892, -1041174475, -288217926, 628176602, -798558097, -1237871436, 1884409772, 1904964725, -1439006077, 943240738, 2055745443, 1492942367, 971082865, 158857875, 121828350, -891080903, 1428141976, -498494612, -1292994884, 2081264023, 963392227, 396006728, -343526604, 585443326, -1137987143, -493750113, 330969390, -279657373, -1042109411, -333870756, -1691240417, 1913707898, 1921837127, 71442027, 2074820808, -113472706, 1725362746, 34175298, -946768303, -136926682, -868427520, -219406852, 1696956399, -1229651426, 157989321, 918281168, 742866722, -1915632094, -2087401158, 1805907560, -1040199769, 1847260060, -532942213, -1316633378, -837971516, -599375058, 1793844646, -1116180434, -191789452, 459378048, 1669090469, -211487768, -681788379, -701057493, -180764652, 1942670870, 1872506378, 507336373, -142079741, -2009172919, 1151848207, 2071557112, -489751970, -398841735, -1429451079, -1424660917, -831113593, 1197055388, 505154469, -256574223, 1612538637, -140215869, -1671331461, 1378315091, -96594959, 840262151, -271987993, -1835000854, -165050754, 1488419676, -200940803, 1125352265, 456148178, -1435941509, -932784862, -613546503, -303386815, 160523968, 1820930385, -1716333437, 1014771362, 833004284, -385186866, -1436350974, -271910911, -266296189, -2025983172, 484749575, 2092707687, -377614121, 221952926, -1315723606, 155760651, -682651586, -362335734, -352079707, -403247336, -1226536049, -1478237301, -438542973, 986997655, 954714909, 633619306, -834319097, -1910215342, 1066711234, -1881726847, -377684008, 331636297, -930277301, 199674137, 769010526, 885796000, 1397842919, -248920983, -1206344153, 431701471, -1471792922, 365510503, 1986022979, -815731040, -664550196, 1797755517, 1410232717, -953444513, 1326266537, -49118678, 1409492816, -848850905, -1416839263, 256199252, -511656698, 1181506252, -1487905451, 595049656, -1827265258, -79140749, -1607441210, 1100756908, -2014345238, 1269933384, -562060719, 2044144150, 1940779489, 1597075175, -1436342437, -231907495, -913963957, 1063393405, -2105826834, -2045862268, 1219636228, 606742513, -1107316586, 698657689, -1439255628, -372349194, 2121633668, -1221827855, -665752939, 184494537, -1517490108, 219809195, -1445543748, -54809729, 262136921, 1468345630, -2045136154, 660792152, -204323603, 487929934, 208388907, -1377298151, 1082133106, 1498711769, 1603822174, 713926962, -1261529230, 224445565, 1011492517, 556606382, -1242885930, -673573723, 291316396, 1198753421, -1039642662, -815802198, -607418373, 1957384879, -146522361, -1490758022, 2045004807, 1136338785, -2073346988, 2059778341, -899813909, 1841695962, -971531105, 1431198133, 1734192986, -924056549, -1619660665, -1446687078, -119285050, 2049812685, 1482118648, 643296190, 1788397083, -65906755, -1434146523, -860655098, -562657254, -1813775760, -790709882, 250483537, -1355511165, -67081741, -275493429, -1461473315, 1225554592, -1279276870, 58993832, 94471259, -1005709763, 1544206845, -1904929637, -54142877, -1478734066, -741827054, 1544836074, 737649101, -1442054107, -212446435, -886535876, -796201959, 920035566, 354249348, 522396439, 1186112620, 741713276, 1551025929, 310747837, -1489063443, 413764246, -1268624644, -243444446, -793958769, -27252026, 62823067, 252862398, -1917832091, -27960011, -1524235234, 773963157, 126342708, 230353488, 194255387, 2012588951, -1638781929, -1863355098, 1294125066, 900970842, 449245136, -76068491, -2057221911, 1438055755, -1933948644, 1670916168, 224186361, -55867090, -2035869880, -2023323983, -1528404401, -348868315, -457962452, -1845959438, 859333987, -1283854370, 117179917, 359843766, 1283972355, -1715693921, 802972250, -1564195319, -1584969380, -1815108619, -717940771, -81998998, 1781968945, -1908305664, 320545929, -1388714442, -556886720, 314142435, 1742545293, -1273716669, 990180897, 284266921, 614086928, -2017760687, -1671117415, 329893316, 1590491007, -1382525602, -631430411, -2006892996, 1572301923, -1085038070, 1318161803, -610653888, -1128889524, 1812188814, 1079024702, -2020472593, -1406292520, -1481450451, -1788284316, 570129025, 1030273624, 444490882, -1290922051, 2012261873, -1722886950, 78965845, -846987860, 362335185, -311711949, 857560805, 636503018, -1196150679, -1305220268, -1320171298, -1790524455, -1602444038, 292900665, 919239737, 1533559888, -178561299, -1462859260, 1689722042, 138614070, 755029169, 2066907403, -1618638364, 213563200, -1377138405, 1116971429, -1081815543, -1572669944, 1639924745, -494541663, 1628833058, 743951416, 1096013974, 224292831, -1732801034, -1938228113, 291816475, 1092854768, 57704427, -836034598, -1804683972, 2145897202, 935184430, -1401801196, -950403832, -2030372239, 2110768130, -1401678458, 1296490586, -399108198, -607898418, 15186611, 1694599021, -1075355270, -2116097734, 1895390633, -1127233712, -646642277, -1864034101, 1913584732, 9330725, 1640373935, -1936592267, -857275194, -1842068299, 1836531997, -682654443, 675403880, 1436863532, 259547682, -1432985609, 490826330)
"beta1" <- -0.150446293110455
"beta2" <- 0.885270519369069
"mu" <- structure(c(-4.9580351813364, -5.06866575026565, -4.92063303045503, -4.86589013578993, -5.22307276296599, -5.04224718914249, -4.95042918375596, -3.34044038716115, -4.77422337035336, -5.67532396510659, -5.25656091586221, -4.33780932396426, -6.73295414633745, -4.34441189915263, -5.76098064888405, -3.41565844563521, -5.59912418661711, -6.08858901128955, -3.13334428642658, -4.31655089604653, -5.31553827626733, -2.72696191513625, -4.07274713450809, -1.78178078014457, -5.47827766100244, -2.599549365492, -4.95727517217826, -2.54457908433621, -3.42136518656133, -0.560924027088959, -3.87068744290551, 0.255393854125837, -5.27921311394303, -3.5779443428051, -4.30222719012818, 1.05359927585074, -1.63537839146746, -1.46749922459223, -5.9832543853835, -0.783429721110001, -4.1353628437379, 0.440199283565008, -2.33203653247466, -2.21681320579109, -3.11725833187679, -1.3416128356375, -2.86055232398479, -0.351343620849892, -1.66153962445097, -0.978160409761559, -1.10034026354964, -1.52145691072763, -2.52881854180831, 0.111396032893627, -0.960406954425135, -1.8638373606106, -2.23372609688468, -1.58711186023595, -1.75886182057114, 0.390984691865862, -0.900133180645182, 1.95712205065088, -0.552304452861975, -0.530503035855815, -0.22529691763014, -0.0950567536660493, -1.48420693599739, 3.38472467893636, -1.45165068851608, -0.198105776987066, -1.34811652249236, -0.460829670428469, 0.0736821680727063, 3.20470468953294, 0.368508526449283, -2.5764598570108, -0.0761388321599846, 0.300431609982764, 0.422319493557209, 1.7419105552073, 1.43513231964144, -1.04890798797584, 0.849177112553628, 0.113965345855982, -1.78359210723155, 0.0906060807110821, 0.418919062964736, -1.36166715163076, 1.13502904502978, 0.584391861794268, -1.81181645608132, -0.140697112266246, -1.12280779896895, 0.0395556790417124, 1.76363774771987, -1.84812643857294, -1.44500195829064, -1.78128138359458, -1.96334910947978, -0.528398004579055, 2.35079667467704, -0.843992525638425, 1.26200339266959, -3.7962356476578, -4.55691758047094, -2.51438840632168, 4.13410558993891, -1.86808299909816, 3.12254119496807, -3.4638323650002, -6.23797725655276, -4.16117643425309, 0.0635214813413366, -3.39326434793923, 0.726558720055491, -3.61712743371722, -5.44707458334565, -3.93466809374914, 0.236905203761137, -1.9522183935), .Dim = c(6, 20))
"tau_obs" <- 1.96328590785732
"tau_proc" <- 0.539335421092486
"y" <- structure(c(NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, -1.5, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, -0.333351135253906, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA), .Dim = c(6, 20))
".RNG.name" <- "base::Mersenne-Twister"
}

inits{
".RNG.state" <- c(12677, 17853, 24756)
"beta1" <- -0.132573476718746
"beta2" <- 0.82522321330617
"mu" <- structure(c(-5.02320408838777, -4.8525142333053, -4.8518967148921, -5.11603867206872, -5.03595687836688, -5.11369309766222, -5.22527304974038, -2.93073596250297, -4.96448182726132, -5.04045562216152, -5.33925700944481, -5.70149575602579, -4.8115634336377, -2.59201985616987, -5.75259322170466, -3.38757010440756, -6.48559054584264, -4.20152933753073, -2.43233696571719, -2.91190057338902, -6.32314839752063, -2.18309186608687, -4.53718367471205, -2.52053630190102, -4.02225265191801, -1.17400311954259, -4.38776305661326, -1.32277814438238, -4.80477161653412, -2.04425236772612, -5.08998534648552, -0.0877640334290541, -6.05051643669443, -2.409175045743, -3.61426218310556, -0.512439861511077, -3.34272451573198, -2.11737148892127, -4.76225625834742, -1.20015788948406, -1.77757174085151, 0.427537684223044, -2.64877812774895, -2.04675642216543, -2.45249640578885, -2.72030718076019, -1.87671424869414, -0.591199728153731, -1.19399011184174, -1.64794670681334, -2.00840383830948, -0.95708851755491, -2.27492695700505, 0.424246027984083, -0.560467081006079, -0.218913854202847, -1.46752968194949, -1.715413729429, -0.831701790903926, -0.126875114645714, -1.49205660051776, 2.28798843482907, -0.328259079774138, -0.706128922670884, -0.0896039391077013, 1.53130655461242, -1.74455710119198, 3.25596445696779, -1.02850607860056, -1.04312257682573, -0.120450181177598, -1.2493006815653, -0.391981276934731, 3.22467708901854, 0.675707107875824, -1.25948257406919, -0.226788650638362, -0.69287465464623, 0.46607321180312, 1.12602442648593, 0.67670894736394, -1.09351421158851, 0.390096778971276, -0.729383721995009, -0.241009359093926, -0.616953909754487, 0.145942213247463, -0.230831806548234, 0.753010136639845, -0.432029026615005, -0.495060144842, -1.7214805099431, -0.648053395011978, -0.523775789510477, 0.898268443090419, -0.3476248861522, -1.62644531371363, -2.14554253562321, -2.67149277269031, 0.166241815408653, 2.5382510003539, -0.95957386475172, 0.67487208995057, -4.26574513335723, -3.43902684407086, -1.06987888609442, 2.64527483860465, -0.789575811349964, 0.395203591359618, -4.85458339368264, -4.77452267137053, -2.83109121441711, 0.160306469828365, -3.51223093476512, 1.51925906947164, -2.68778143929201, -5.60339457528904, -3.80264281397534, -0.659671711450646, -3.05649003085747), .Dim = c(6, 20))
"tau_obs" <- 1.7571961637028
"tau_proc" <- 0.823110315590266
"y" <- structure(c(NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, 0, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, 0, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA), .Dim = c(6, 20))
".RNG.name" <- "base::Wichmann-Hill"
}

inits{
".RNG.state" <- c(1471835002, 207665532)
"beta1" <- -0.541733015999841
"beta2" <- 0.752796159977624
"mu" <- structure(c(-5.16790713548726, -4.94537309825354, -4.99367731598283, -4.85093223673977, -4.88441066577856, -5.01078931364046, -4.6869533899521, -2.99478808823782, -5.26454998235475, -4.35501673696802, -5.23465924374316, -3.48418626305283, -4.68384436041837, -3.93332136750016, -5.9252581315269, -2.75365896210116, -5.90915920603128, -5.2605847240502, -3.18451457268193, -3.0852960983466, -5.89636743520542, -3.28643757927344, -4.71652635641762, -2.74796805419732, -3.02134058559253, -2.4191468736062, -5.74532534164593, -0.857083600755423, -3.49627922330402, -1.86193623596812, -4.81451345626212, 0.566835689800635, -5.08028336318305, -3.76325513905983, -3.36313737206113, -0.477114667291754, -2.17293916980191, -2.51532693759781, -3.98634255775246, -2.20074191647543, -4.18840123133453, 0.40575177093541, -0.899063711658857, -2.80013131221695, -2.57149214050568, -2.65734252953692, -2.86254495626745, -0.0974164874774522, 0.0126002618293934, -1.95765239087988, -1.9161143014775, -1.54886655128662, -0.948100880150063, 1.15920826590352, 0.295696978838509, -0.708505971054672, -1.99525056228195, 0.0634775116250205, -1.02611712192235, 0.452045645458195, -0.911901472740916, 2.2841526204049, -0.808253775241886, 0.67701601751141, -0.761150763970638, 0.245417101772115, -2.10083609974774, 3.32893240106786, -1.71053672547436, -1.05840585878074, -1.58063153418724, -0.959089907396308, 0.504537419220885, 2.44556330911152, -0.386252655303859, -3.29151595525438, -0.765947500956759, 0.364064362212707, -1.52296727353248, 2.67387810396478, 1.93330948681799, -1.60392752654836, 1.24467165044477, -1.18987410297705, -0.702562247584855, 0.150090364049635, -0.171031074873424, -1.24346101170883, -0.44524971618928, -0.449929218617296, -1.40783141307727, -0.381583331424839, -0.798788596110052, -0.255912337462091, 0.643361966975245, -0.874344157724776, -0.881334710949157, -2.49942738141171, -2.98155680035072, 0.13288066655912, 1.8826230889478, -0.606332727239466, 0.220524489950749, -1.98977290715386, -4.33109568629922, -0.926879341149998, 2.89422455277391, -0.799925799723158, -2.31875213017471, -4.15915657453086, -4.52946336469787, -3.05290012459533, -0.527154019257577, -2.85686640073671, 0.0827744884541175, -3.35624287009307, -6.01321067348621, -3.98545969139759, -1.53182398886559, -1.83768816890828), .Dim = c(6, 20))
"tau_obs" <- 1.6258088981864
"tau_proc" <- 0.719413997174694
"y" <- structure(c(NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, -0.5, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, 0.999977111816406, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA), .Dim = c(6, 20))
".RNG.name" <- "base::Marsaglia-Multicarry"
}



######################################################################################################
######################################################################################################
#### Data 
######################################################################################################
######################################################################################################

data{
"y" <- structure(c(-4.06591991745718, -2.94665209430014, -5.80914299031403, -5.80914299031403, -5.80914299031403, -5.80914299031403, -4.59783674154387, -1.88686814833501, -4.59783674154387, -5.80914299031403, -5.80914299031403, -4.59783674154387, NA, -4.06591991745718, -5.80914299031403, -2.94665209430014, -5.80914299031403, -5.80914299031403, -3.26053097886945, -3.72054301540761, -5.80914299031403, -1.93466900116998, -3.72054301540761, -1.98486998368036, -4.06591991745718, -2.60726358981506, -4.59783674154387, -0.668845883547919, -3.72054301540761, -1.47248282297889, -5.80914299031403, 0.655974922329534, -5.80914299031403, -4.59783674154387, -3.72054301540761, 0.281988862342713, -2.51565896414186, -2.70811366311588, -5.80914299031403, -1.18037030439171, -2.70811366311588, 1.31661982654987, -1.53614971441768, -2.82028710501947, -1.53614971441768, -2.15263466474332, -2.60726358981506, -0.0653754237762429, -0.589253733521219, -0.711150923698861, -1.8412483567478, -1.25195872848308, -2.51565896414186, 0.543420073956604, -0.211473338919426, -2.21545316410442, -1.47248282297889, -0.696849461552251, -1.01127799732093, 0.265852896722762, -1.03091569138165, 2.75676687558721, -0.168704041457194, -0.382628870687186, -0.615086916013517, 0.535170022761435, -2.60726358981506, 3.57821555646438, -1.75581432451179, 0.163154257134424, -0.833582703939862, -0.53950714937723, 1.18076288241878, 3.79205461642565, 1.4123738990455, -1.8412483567478, -0.60208690792214, 0.8962786165969, -0.013864711444381, 1.55353770544924, 0.869955466752787, -1.27700755822547, 1.06823942041139, -1.18037030439171, -0.576583164939999, -0.696849461552251, 0.0554034869116419, -0.382628870687186, 0.462152453642488, 0.138825724259713, -1.32906996434575, -0.900920880514602, -0.770494290290964, -0.56407113301186, 1.43788878016486, -0.900920880514602, -2.28248391223017, -1.88686814833501, -2.82028710501947, -0.43587591418692, 2.24561904248638, 0.677760368893093, 1.5185224738127, -2.94665209430014, -4.06591991745718, -1.1135661849228, 4.40231277434833, -2.28248391223017, NA, -4.06591991745718, -5.80914299031403, -3.72054301540761, -0.770494290290964, -4.06591991745718, -0.274600501197854, -3.09132676577126, -5.80914299031403, -3.46431559990757, -1.44210761092232, -2.0377249228153), .Dim = c(6, 20))
"year_no" <- c(1, 2, 3, 4, 5, 6)
"beta.m1" <- 0
"beta.m2" <- 0
"beta.v1" <- 0.001
"beta.v2" <- 0.001
"season_weeks" <- c(1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20)
"x_ic" <- -5
"tau_ic" <- 100
"a_proc" <- 0.001
"r_proc" <- 0.001
"a_obs" <- 15.37
"r_obs" <- 7.84


}

######################################################################################################
######################################################################################################

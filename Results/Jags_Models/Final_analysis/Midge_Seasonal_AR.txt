######################################################################################################
######################################################################################################
#### JAGS model file written by runjags version 2.0.4-2 on 2020-03-03 23:47:32 
######################################################################################################
######################################################################################################

model{
for(k in 1:max(year_no)){
for(j in 1:max(season_weeks)){
#this fits the latent Gloeo to your observed Gloeo 
#run this on logged data
y[k,j] ~ dnorm(mu[k,j],tau_obs)
}
#### Process Model
for(j in 2:max(season_weeks)){
#process model for Gloeo
mu[k,j]~dnorm(lambda[k,j],tau_proc) 
lambda[k,j] <- beta1 + beta2*mu[k,j-1] 
}
#Loops through items in seasonal for-loop and defines initial conditions
mu[k,1] ~ dnorm(x_ic,tau_ic) #keep in mind you'll need to index like a matrix 
}
#### Priors
tau_proc ~ dgamma(a_proc,r_proc)
beta1 ~ dnorm(beta.m1,beta.v1) 
beta2 ~ dnorm(beta.m2,beta.v2) 
tau_obs ~ dgamma(a_obs,r_obs)
}
#monitor# tau_proc, beta1, beta2, mu, tau_obs

######################################################################################################
######################################################################################################
#### Initial values 
######################################################################################################
######################################################################################################

inits{
".RNG.state" <- c(1302125646, 718160362)
"beta1" <- -0.260673038303665
"beta2" <- 0.74744354415521
"mu" <- structure(c(-4.94127055712469, -4.85399834906642, -4.87966493945774, -5.05455753966589, -5.11143771208874, -5.10440630693674, -4.80848870037852, -3.98397413687575, -5.3641059894697, -5.25688419324699, -5.17153475898913, -4.15870207016471, -3.47656946539015, -3.72507063056089, -6.12815063865201, -2.38396304088615, -4.99695562268804, -4.73942837834398, -3.29291893714617, -4.00597873881952, -6.13930986992005, -1.77079715750695, -3.28237625342848, -2.43858923265333, -4.61836638062087, -3.46948013006146, -5.78409835020744, -2.43025353490455, -4.06190169573536, -1.36239833391964, -5.17669176728017, -0.893175824417554, -5.13265918788365, -3.6634388117, -3.40890361464491, 0.162584585687425, -2.64795937037603, -1.3966274475356, -5.86158391177132, -1.123120429263, -2.53457586596659, 1.71202920091177, -0.990101268115109, -1.01771175916926, -2.81759973886033, -1.31680433427826, -1.63313195282545, 0.715138792591663, 0.0492523144919315, -1.26642188992339, -0.989512990168556, -2.74772476010008, -1.64578749137382, -0.0587513623023626, -0.694773738210801, -1.3424734387045, -1.16967996525254, -0.762391358255477, -1.26212011520661, -0.0751658149905762, -0.890745021950902, 2.02221399502549, -0.986641423599538, -0.966469538856586, -1.10983921299505, -0.377831882734793, -0.91341404572212, 3.35354210479206, -1.27679119030961, -0.593806423954076, -0.70129442466448, -0.484568483209513, 0.127155664423508, 3.17816158756251, 0.284720329023674, -2.29674405578171, -0.595429624010987, 0.645446722679093, 0.51687305223305, 3.11460137315716, 1.40181505506215, -1.03030818195988, 0.315022450349465, -0.522227031666368, -0.284217051929644, -0.0769848487548612, -0.124129306220473, -0.861329155088679, 0.0548897600412918, -0.509916502187431, -0.675274405331633, -1.51057361671735, 0.033934732060392, 0.468605811284417, 0.930433308384879, -0.616695843947597, -0.949448615347259, -2.72766856996568, -2.98487672825998, -0.206985169838994, 2.70133660575473, -0.86967506768187, -0.193540733614645, -4.06280906844581, -3.32314449172281, -2.1869172956934, 3.19650472161204, -2.31126151685728, 0.153567256914921, -3.95521408761043, -5.49426064978874, -3.5095619466663, 1.07585221368279, -2.94197034321866, 0.623212341031226, -4.01843537954668, -6.24516046962216, -3.31234125172291, -0.784058280322556, -1.75195198105677), .Dim = c(6, 20))
"tau_obs" <- 1.76471438065894
"tau_proc" <- 0.648572488205454
"y" <- structure(c(NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, -1.5, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, -0.333351135253906, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA), .Dim = c(6, 20))
".RNG.name" <- "base::Marsaglia-Multicarry"
}

inits{
".RNG.state" <- c(-1142414620, 617514053)
"beta1" <- -0.267043979258967
"beta2" <- 0.783321930114668
"mu" <- structure(c(-5.0377143316467, -4.84158634644787, -4.91066814735117, -5.09060801405821, -5.08253026883576, -4.96028724282701, -4.44308872233608, -4.19491911744362, -4.4194942911108, -5.209873366167, -6.20886801511933, -4.49015541609768, -4.62378204750035, -3.59268499617884, -6.45089304447202, -3.69387076340089, -5.47611341629805, -5.29239865203812, -2.60589742116995, -2.95432348831763, -6.61826512724932, -1.65491819699073, -3.82499943687022, -1.99017370930204, -3.33312557699845, -2.23473186385027, -5.39384573219866, -1.40471040958775, -4.02913891422245, -1.86648756347231, -4.23011987886661, -0.4288645684067, -5.99442139614312, -3.51587948125655, -4.47406394313414, -1.27823498361292, -2.85673699515144, -1.33645265212444, -5.79001258925692, -2.0923831078098, -3.15880327895494, -0.245883878091423, -1.78957869955137, -2.28057020205133, -2.03180583683745, -1.0061033539079, -2.87009283407794, 0.723754438588378, 0.042182813116543, -0.991541483003773, -3.11227783044864, 0.0601551023093831, -2.7285360106665, 1.04374561773118, -0.536731512484428, -0.914973273074413, -0.716944080976444, 0.164250516530998, -3.10455709800782, 0.998538271073641, -1.02982725768615, 0.874917964741698, -0.631860636358414, 0.08011321293713, -2.01079876109133, 0.274553380803723, -1.69709857036057, 2.04891282565889, -0.61198073609068, -0.370681879799293, -0.715798004152562, 0.286712082354166, 0.665664660547716, 4.09790972126431, 0.0810847374449269, -1.63635832927744, -1.31414759546711, -0.958680275067906, 0.483064985107555, 2.58314911220222, 1.01487617572386, -1.85038004599915, 1.14914089014761, -1.4070168738687, -1.08591948876938, -0.469781149565551, 0.150005438630025, -1.15939121387638, 0.978638721068874, -0.486458758604523, -1.69254803957776, -0.595003121331738, -0.553484066269423, -1.16676847604187, 0.899370863103131, 0.531107006061702, -1.50231424550148, -2.93380635948051, -3.32980978974927, -1.01403808393556, 2.80280480970341, 0.745082775979682, -0.360925109844606, -2.70144071551885, -4.08882831911659, -1.85003716379069, 3.4024078716635, -1.00481270143651, -1.80756260960158, -3.07791576889553, -5.95858143568437, -2.67094033188159, 0.7533708880103, -3.10767566769849, -1.18570127809491, -2.34764535289156, -4.15518481452486, -2.6487026873927, -0.648534637016289, -3.12574014819472), .Dim = c(6, 20))
"tau_obs" <- 1.28476061094127
"tau_proc" <- 0.820574450579027
"y" <- structure(c(NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, 0, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, 0, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA), .Dim = c(6, 20))
".RNG.name" <- "base::Super-Duper"
}

inits{
".RNG.state" <- c(341, -1602855832, 747678220, 1829163985, -857600115, 1884091991, -1787462444, 2105073847, -2087617709, 386204200, 704206716, 769517870, -1762741684, -781130365, 1200739970, 1275449878, 704456824, -895061983, 1102603472, 911781687, 1668029037, 1560927088, 281711972, 1929514532, -1525487766, 730746219, -1891143971, 82113693, 1274754964, -200134063, 2061468049, 49192560, 814002930, 1079818070, -176328080, 221532800, -1760214259, -1965861448, -679189776, 68765924, 1739226035, -859489373, -1068295768, -723349325, -300122599, -1367368488, -229364715, -763245950, -2060548044, -1771389679, -736758512, 1889348824, 867445995, 1918293491, 1590458544, -1655054450, 1801848031, -1152115088, -1733759084, -645932406, 246209570, 339424201, -478661794, 2071095496, -648392428, -1790777720, -700658673, -1257547337, 977478998, 1617579864, -414036530, -815767009, -114985842, 1520883354, -78941741, -299932782, 1411601493, 488491025, -38447025, 1750378465, 395453557, 1135503738, -1182064633, -583044475, 1307024888, 2057531511, -562717367, 837380663, -168787670, 1459174309, 247849168, 867673141, 787700217, 1734340467, -1749101271, 140705375, -1751977462, 930720581, -474826951, -2118092756, -106085248, 73782412, 38537690, -29389746, -596051150, -2138549011, -1702941141, 1956775073, 1121657024, -1442192667, -815581953, 1679707407, -1340263525, 1802682107, 1312348153, 198757770, 980895808, 1302898001, 1814102192, 925466010, -1942142166, -1772713175, -1166260139, 1505534303, -891880600, -595795910, 461128531, -1805351922, 93490747, -1364569683, 739063503, 107742039, -1906667481, -1937331480, 568039298, 1653221875, 2114610336, 1280756987, -1033932847, -1465788427, 860602203, -1387698950, -1923939528, 1893166531, -568071398, -191415656, 1003738617, 712666693, -602245617, 1698754480, -282588286, -2129234549, 1564355051, 379188007, 1879341161, 1000968948, 556725795, -491391690, 209012166, 934793475, 745431212, -1332606324, -340721853, -3080895, -619565001, -1376452969, -2002300495, -498499005, -633757510, 1346714359, 550703254, 1468512358, 1446086888, -1354584197, -409485196, -1365386790, -120253241, -776548401, 618070976, 111935083, 64340253, -762312353, 120920444, -388715582, -1172980369, 1215673917, -1811873003, 70327800, -945364499, 753272628, -1172837224, 341498782, -1729970715, -1924743063, -2082010962, 677610462, 1002650438, 1066108064, -317196779, -1363349350, 324592601, -807193274, 1354928677, -1699684582, 1934031153, -981043106, -1703069004, -1699865467, 97638650, 302551427, -1011824951, -1633335267, -1102639264, -288852534, 1301870421, -190418302, 1173633874, 1041183818, 571643353, 1732830108, -1997019001, -1257799065, 1547332528, -774198305, 508426751, 432869667, -1254484084, 2131235261, 111675365, 1757655219, 329996150, -882453405, -1609940654, -470118836, -520718264, -223146431, -364172817, -6704618, 403580795, 16613039, -529123457, -1938337757, -1131827251, -252240150, -184298524, 500017935, -865889572, -2052845776, 1770174159, 767294444, -1183770078, 1246138241, 591157796, -1694739790, 362185623, -2089035545, 1182357905, -75111772, -417745460, 2067586361, 21006942, -98396010, -1345351239, 375495689, -1844024155, 981908148, 1253122183, 859917249, -1523523738, 1484315473, 210061320, -36665214, 1485531247, 1101136691, -1052927480, -1745780791, 1034614083, -1122493424, 1433898977, -1599581583, -1902459630, -1385091895, 268182996, -1615412811, -1869346630, 1659615990, 282221732, -125185087, 725186968, 1121072926, 1567591075, -114855056, 2012254390, -1043711679, 1590059505, -1268187162, -603174960, -1040562365, 2057612145, -1996056813, 1735702663, 1207960324, 300719369, 966284711, -337310873, -1567303498, -980670431, -242547622, 1653547517, -770044186, 1576924680, -1852040312, -2105084310, 417109165, 1985908411, -2060774286, 325483351, -177908492, -1146930973, -1684572826, 1884860657, 1776757253, -1286563132, 66132373, 863701015, 809193212, -837526288, 1291406814, -1789891588, -202522757, 899195850, 1541501844, 1672937954, 588483370, 657467324, 836232896, 469212881, -1408656427, 974323586, 2111485604, 886482421, 1004549538, 2062914966, 376385404, -973709221, -561645445, 288995547, -200659850, 217141387, -690151322, 1860016862, 2072778323, 382951159, -853026972, 1158032748, 1370581425, -1723218281, 1712897401, 1992464904, -641464419, -1614204620, -301151746, 1406624847, -1240249214, 1637109121, -570566671, 366878469, -665092354, 614231897, 160883380, -1807910467, 1640007238, -752672219, 1683162663, 878436992, 876386383, 951339846, 2059185391, -679420658, 271371034, 1315027508, 866029886, -1930550758, -1298912729, -828784151, 306191897, -1179185342, -1540124451, -2031703539, 92615259, -1020146090, 1450706615, -2048490831, 2044083530, 564722291, 1878520997, -1240286395, -2045321908, 1188547619, 176106486, 2109024531, -2106755153, -1841396103, 183656533, -60550617, 396218491, 148709422, -1909300275, 1080978641, -1630322839, 933462947, 2145324327, -898768484, -2066706728, 981685790, -1282512649, -1261046647, -1701553487, -142348738, -1598172022, 1450185170, -1812425103, 1316154224, 802244672, -1100474932, -742144511, -240685196, 1996281125, -21525728, 463042578, 396700604, 894408178, 1397470805, 1918758450, 648342271, 71596486, -159246723, -906296831, -1850434907, -2024289901, 350031508, -825425728, -1031722204, -2085571742, 2005840450, -1578837559, 2128312992, -2107171376, -1945116383, 1218848013, -277005398, -214306393, -563028155, -102277800, -1651825226, 545158828, -233271115, 1753034302, -792716651, 867832196, -2086836167, 698655738, -1173058124, -1152848799, 370759333, 790941820, 1424891280, 347919716, 915058592, 293027550, 181844673, -1819256583, -104916474, 204858137, -222116123, 144276516, 1400367879, 2045556911, -1875230498, 1774625145, -1885756243, 505117890, -519214841, 2012681805, -1505006300, -393149551, 1199130811, -707426546, -1096179408, 1498325996, -1741269637, 1395412252, -1611541616, -1298685135, -1309313927, 786949672, 1417664651, -1348597675, -997060024, 474985308, -1537160760, -1226992856, 345480887, -224648777, -264837128, -78892280, -447336245, 961307116, -237989970, 511348228, -1777342721, -1440817187, 1067220204, 1794403956, 367308767, 240131054, -2014607248, -651245931, -297045272, -544496869, -898036985, -1564414158, -896294420, -569574148, 514203102, 339667689, 652265366, 361073509, -441974348, -654841259, 1559729155, 746013856, 1818494453, -1208716243, 651924599, 472691058, -156217487, -770820859, 921526317, -95703579, 573980078, 1362165793, 1174842315, -583274602, 940697081, 205566692, 1204260817, 1492668963, 663819888, 87381072, 2027599503, -1885274964, 779185811, -61710962, 1078808355, 1130731204, -1148488260, -420356162, 488933749, -1174571132, -1792565891, 1998782707, -1184082037, 603410477, -1607347980, 492191683, 544678175, -305419192, -259384771, 1031216958, 1162454991, 265021562, 1939114377, -357908588, -183533302, 1325446859, -1655627639, 1467288193, 1760538069, 1053109162, -1954103166, -773577401, 1516177536, 1410186168, -790565492, 1121923464, -1278150476, 141581459, -560975815, 1812869789, -1030495697, -1256373063, 568544583, 1887302799, 742682286, 161818652, -740190897, -97946850, 1528119457, 88500245, 835759184, -1294809693, -481958714, 1481011223, -2054980138, 345531, -1206379225, -2120075158, 551710008, 1131720850, 12913399, 238622148, -679318873, 427559780, -70325101, -1978643637, 1975024455, 1965428743, -222512648, -859017216, 114674392, -745168525, -609844411, -1341075289, -701631624)
"beta1" <- -0.360137761272226
"beta2" <- 0.786598582375239
"mu" <- structure(c(-4.86482955207058, -4.99416476437624, -4.90640309880736, -5.15772202541207, -5.03304682113612, -4.86998796199673, -4.72476384511993, -1.98218657957026, -3.81767806142563, -4.97578608425278, -5.31402645303669, -5.14677012014349, -6.23108842301062, -3.69903207984875, -5.34736754718511, -2.77254023160826, -4.62028591561303, -5.20773542899814, -3.87512144817288, -4.38051131987799, -5.41498605051285, -1.95083118177197, -3.6805158881232, -2.27849197800422, -4.535647727637, -1.77883300591916, -4.59751703214585, -0.763319334978341, -3.50001250435502, -1.49679575998278, -5.24534343955588, 0.77551097421532, -5.16440451511431, -3.34033006521028, -3.72227581085968, -0.834649744604229, -3.43999140431338, -1.7740917155988, -6.50252553446476, -1.04652867378427, -2.33975984063413, 0.547546453298845, -1.36118026343979, -2.7134230827981, -2.53548055220245, -0.853310790327163, -2.63634818720944, -0.744730741426656, -0.289956062716566, -2.1740611811646, -1.76508609886557, -2.56851296068919, -3.37972603111278, -0.0900369879023736, 0.681397676668401, -1.28500583634014, -2.25922134150642, -0.562718378903513, -1.68999761455165, -0.345937100842661, -1.06187811462292, 2.50262049540475, -0.105570556898093, 0.101960049524941, -0.951453935313753, -0.428034940162453, -0.897396816354402, 2.20382701974407, -0.287799050294355, 0.623464917774654, -0.452118838879627, -0.101444115164658, 0.930721557891515, 3.45237297836898, 1.02836187541062, -0.943792939967642, -1.40682469413086, -0.890265536800302, -0.0523294173681277, -0.263634755480725, 1.13475106809188, -1.1870241641053, -0.183709085725098, -1.02305868882273, -1.3315983243707, -0.933237059980687, -0.719941242755201, 0.930065594910971, 0.238012376988953, 0.299844336323342, -0.994167779039833, -0.451043414096202, 0.185972370922153, -0.0040012739765124, 1.51752915489394, -0.659554004999396, -1.74689573146685, -1.94787713137192, -3.3773666372017, -0.617728938088238, 1.31860085618882, -0.0752026281081518, 1.15999381548326, -3.39886040183614, -5.17463546443065, 0.0190141176933993, 2.17085551784639, -2.57873857776084, 0.706117937383541, -2.76773509865473, -5.90216110219881, -2.77003883130247, -1.18390515874166, -2.24334082923532, -0.194707842421985, -2.61030344584556, -5.63053082108207, -3.82109508383844, -2.2229296545889, -2.2807327259867), .Dim = c(6, 20))
"tau_obs" <- 1.52692325743983
"tau_proc" <- 0.482130653876919
"y" <- structure(c(NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, -0.5, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, 0.999977111816406, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA), .Dim = c(6, 20))
".RNG.name" <- "base::Mersenne-Twister"
}



######################################################################################################
######################################################################################################
#### Data 
######################################################################################################
######################################################################################################

data{
"y" <- structure(c(-4.06591991745718, -2.94665209430014, -5.80914299031403, -5.80914299031403, -5.80914299031403, -5.80914299031403, -4.59783674154387, -1.88686814833501, -4.59783674154387, -5.80914299031403, -5.80914299031403, -4.59783674154387, NA, -4.06591991745718, -5.80914299031403, -2.94665209430014, -5.80914299031403, -5.80914299031403, -3.26053097886945, -3.72054301540761, -5.80914299031403, -1.93466900116998, -3.72054301540761, -1.98486998368036, -4.06591991745718, -2.60726358981506, -4.59783674154387, -0.668845883547919, -3.72054301540761, -1.47248282297889, -5.80914299031403, 0.655974922329534, -5.80914299031403, -4.59783674154387, -3.72054301540761, 0.281988862342713, -2.51565896414186, -2.70811366311588, -5.80914299031403, -1.18037030439171, -2.70811366311588, 1.31661982654987, -1.53614971441768, -2.82028710501947, -1.53614971441768, -2.15263466474332, -2.60726358981506, -0.0653754237762429, -0.589253733521219, -0.711150923698861, -1.8412483567478, -1.25195872848308, -2.51565896414186, 0.543420073956604, -0.211473338919426, -2.21545316410442, -1.47248282297889, -0.696849461552251, -1.01127799732093, 0.265852896722762, -1.03091569138165, 2.75676687558721, -0.168704041457194, -0.382628870687186, -0.615086916013517, 0.535170022761435, -2.60726358981506, 3.57821555646438, -1.75581432451179, 0.163154257134424, -0.833582703939862, -0.53950714937723, 1.18076288241878, 3.79205461642565, 1.4123738990455, -1.8412483567478, -0.60208690792214, 0.8962786165969, -0.013864711444381, 1.55353770544924, 0.869955466752787, -1.27700755822547, 1.06823942041139, -1.18037030439171, -0.576583164939999, -0.696849461552251, 0.0554034869116419, -0.382628870687186, 0.462152453642488, 0.138825724259713, -1.32906996434575, -0.900920880514602, -0.770494290290964, -0.56407113301186, 1.43788878016486, -0.900920880514602, -2.28248391223017, -1.88686814833501, -2.82028710501947, -0.43587591418692, 2.24561904248638, 0.677760368893093, 1.5185224738127, -2.94665209430014, -4.06591991745718, -1.1135661849228, 4.40231277434833, -2.28248391223017, NA, -4.06591991745718, -5.80914299031403, -3.72054301540761, -0.770494290290964, -4.06591991745718, -0.274600501197854, -3.09132676577126, -5.80914299031403, -3.46431559990757, -1.44210761092232, -2.0377249228153), .Dim = c(6, 20))
"year_no" <- c(1, 2, 3, 4, 5, 6)
"beta.m1" <- 0
"beta.m2" <- 0
"beta.v1" <- 0.001
"beta.v2" <- 0.001
"season_weeks" <- c(1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20)
"x_ic" <- -5
"tau_ic" <- 100
"a_proc" <- 0.001
"r_proc" <- 0.001
"a_obs" <- 15.37
"r_obs" <- 7.84


}

######################################################################################################
######################################################################################################

######################################################################################################
######################################################################################################
#### JAGS model file written by runjags version 2.0.4-2 on 2020-03-03 23:40:31 
######################################################################################################
######################################################################################################

model{
for(k in 1:max(year_no)){
for(j in 1:max(season_weeks)){
#this fits the blended model to your observed data. 
y[k,j] ~ dnorm(mu[k,j],tau_obs)
}
#### Process Model
for(j in 2:max(season_weeks)){
mu[k,j]~dnorm(mu[k,j-1],tau_proc) 
}
#Loops through number of years and defines prior for each year
mu[k,1] ~ dnorm(x_ic,tau_ic) #keep in mind you'll need to index like a matrix 
}
#### Priors
tau_proc ~ dgamma(a_proc,r_proc)
tau_obs ~ dgamma(a_obs, r_obs)
}
#monitor# tau_proc, tau_obs, mu

######################################################################################################
######################################################################################################
#### Initial values 
######################################################################################################
######################################################################################################

inits{
".RNG.state" <- c(336, -331413277, 352462403, 904627554, 1003504612, -1791441297, 632151676, 68885274, -985686075, 1307903296, -1873993557, 1848946865, -1804756213, 438047152, 541900385, 824501061, 89178860, 587718842, 621972492, -914246945, -1266910187, 451769423, -1001055818, -1781058285, 222429230, 207170872, -555719734, -688138087, 95518561, 868682392, 219362275, 355956696, 1512795238, -373598223, 699002380, -821507630, -439498085, 1362579797, -266204425, -2143442133, 85929104, 1855827018, -203510449, 705473983, -1465811290, -363858972, -643387608, -1016639655, -932005571, -1970873710, 1682312304, 2094024057, -2005724875, 736221714, -1358286608, -1862689638, -726105299, -1281309026, 1668543152, -39527010, 1151106107, -573367712, -1465553403, -1842180256, -1835096944, -10448409, 817940712, 2061779477, 1617351552, -238643413, 620201322, -718464003, 2013423861, 342556929, 809359635, -171958087, -1260079924, 1161143246, 198689793, 525649875, 341893031, 1992685856, -1802109356, 351081511, 565880916, 7061402, 983020337, 872474742, -424424389, 1878016071, -171354772, 192741229, 696839921, -795193203, 559770373, 2133011871, 1726235915, 1911129533, 1192612300, -975600169, 1792991515, -1285556474, 831869652, 1481211236, -1319174236, 733959688, 346880931, -81214204, 191673808, 927688853, -53614494, -2032695800, -1332630972, 209523829, -818695526, -1497829813, -768260044, 1378684334, 623044749, 1570938789, 1194609699, -1017630805, 1806942531, -892758193, -1703648482, -425442494, 1375251648, -799873009, 380081828, 545257389, 2012055618, 2144759202, -1503088510, 698560654, 268914210, 1331944526, -169558599, -598502613, -1395695404, 424747260, 1358079145, 1048551094, -976735656, 1687868032, 1226299565, -1976796101, 1694488921, 1764887058, -1288197797, -1102289317, 1382397616, 1063779652, -2078236975, -1852235080, 2111535232, -2042296209, 1573788280, 105896056, -2091434977, -370569908, -1261402866, 975980397, 1614836315, 1804104121, 2088861729, -392053033, 145663582, 1813528805, 1462281030, -879054984, 81992683, 961739988, 520730906, 85829066, -151226564, -1677633397, -598076543, -590714843, -1194109644, 1755341076, -2006231290, -1918065231, -1975203198, 1961817150, 346586401, 871168742, -475201154, 770253572, -1528929556, -2145096066, 2127512693, -1572058069, 1877031293, -1392176697, 358299726, -916691376, 1693498607, 1157873735, -1954980651, 1294651946, 2098982198, -1718100211, -340830134, -803888968, 160919810, 862349845, -2034508099, 1171407131, 30171207, -1402141431, -516909742, -49706708, -2041824017, 2110637824, -519374741, 1272888031, -1083658088, 1204162530, 1503044665, -682959646, -1279879258, 2122569930, -1028992974, 1610358639, -332060588, 699727058, 1285165301, -682067743, 1314316852, 1659320779, -983080768, 1029283421, -155368806, 1964343297, 1048210609, 647126347, 2107903121, -1564490510, 1641916595, 1583719281, -1646834616, 247987060, 365812056, -1454203551, 1165233147, 1741107521, 1442624367, 1039370080, -1090196459, -1250880811, 1274458543, 1194777972, -747313221, 1144503182, 1399236976, 749540081, -1995603113, -1278508911, 845802735, 1900145973, 322541734, -1670999538, -813722996, 1580252932, -790812197, -797242008, -1748028907, 904042809, 950870471, -907345571, -3467547, 850274967, 436302199, -1028913863, 1669511343, -6516771, -1301703286, -1313793997, 357445476, 1754901527, -1936562727, 1112350140, -957522744, -1175388346, 1366007975, -697802905, 891417488, 1126640935, 267739670, -161020961, 1503857141, -880768340, 984240853, 563084831, -218542055, 51462719, -870895287, -106955892, -969152962, -57986528, 284963710, 1612411308, 950656461, -1088182585, -329794307, -1046043856, 1550463679, 934612403, -1070307666, -13905796, -821720594, -1713291280, 2101489870, 1352748669, 1048704502, 1944886240, 185328121, 257427375, 898696843, 764400482, -1205297703, 190592686, 54400628, -644008337, -1661497300, 365272072, 833415188, 535589403, -587739089, 1020422628, -1409052994, -1817424383, 1374718170, 322882200, -2013713843, -1883430273, -1901885219, 2104365774, 1973807102, 317258306, 1555977762, 1482967201, -725243146, 988303159, 1007650208, -2109323037, -738961371, 1470116434, 1438981069, -838859219, -1526457402, 277574877, -2141471262, -543969808, -871293903, -297832388, -800753108, 34945678, -102748943, -1034730161, 876193490, 1825060504, 1741841501, -1828695619, 1626189214, -601904843, -1308157230, 608028833, 2090059736, -2124580445, 1768111545, -1711135941, 322750920, -2031574938, 1142456244, 807948843, 1613395138, 1770460541, 1822477380, -466067409, -1947958554, -810199290, -790495196, 414391791, 994886072, -1340831201, 848820173, -247977575, 1510278665, -222409319, -879314983, 812960996, 1934443, -1163727000, 138667854, 930475704, -1563709085, -1235448719, 1735321047, -433082394, 277858282, 1880101182, -1086204634, 2085450409, 2058809274, 434532786, -675443548, 387885831, 708924429, -852742960, -792038435, 563422587, 1289119073, -1604113410, -1308806187, 109148802, 1887172811, 551797288, 145353994, -1331196565, -1246035120, -149457742, -335889646, -1644672536, -2145663802, -166464991, 1629212634, 818628760, 512247881, 266773243, -2098761885, 765383733, -1228238260, -11104769, -673395519, -104958614, 1033655889, -1587787575, 2011365927, 2033790554, -1356912326, -1772462086, -835343078, 1330623874, -79072248, -1557992032, 1790807559, 1631009538, -2119874785, 898150440, 904935863, -225835900, -254527474, -1165058427, -1995155791, 42553193, 863084247, -2040070203, 476099024, 650787088, 518217312, -666972137, -22912360, -2127932800, -1665877178, -804269535, 316791056, 1135537727, -1977622338, -1262601430, -1138108641, -2030881169, 1465599894, -351733156, -1906213433, 1313323483, -1259051738, -2145864522, -22550238, -1114984306, -78393315, 641787402, 477295854, -724036071, -1653349504, -1070966475, -1673815167, -367056274, 1595568240, -63470825, 259822644, -1227114924, 617673034, 297954265, -375232635, -782219940, 1611043421, -1346432284, -170239009, 1348185220, 312463545, -110089951, 1253640720, -1248705848, 571350910, -188586422, -857946065, 1579654162, 1598013728, -47242513, -502937630, -195960957, 1932132776, -2094141775, -1949526604, -1953889127, 963710821, -2101132360, 495855210, -1206021416, -1524112427, -344335081, -1058111011, -1756140289, 250539158, -259787514, -55717997, 1952114243, -1899447074, -2031879559, -1217207879, 309690003, 2059550571, 1526662954, 172469898, -948419891, -7928007, 584640560, -1450441478, -198795156, 1326509326, -395536078, 1693393723, -2058723636, 870613656, 1934226142, 1624989353, -1066883327, -55355198, 814600494, -176305130, -2051892897, -289526903, 1685486501, 938644581, 1138145107, 204562392, 462993209, 200590438, -2087256307, 282513192, 403698984, -1015813966, 1786159197, -1273974910, 1962199335, 614147590, -1973434393, 152671614, -87760528, 846903645, 142448254, 558769018, 1982832797, -351245942, -1472201332, -1853550829, -1615357502, -992240637, -2016488036, 856253550, -1369425516, 1248542530, 1815068738, -902830764, 1309703865, 2024458448, -893903889, -773169502, 996341383, -1548883117, 471355166, -1029600928, 1283612733, 1260511756, -525232532, -544967929, -600224454, -905530376, -1527425355, 543190636, 2106699747, 1304944325, 667989229, -110100636, 39818205, -1538177302, -800135293, 144991751, -733415842, -883574301, -1223690712, -1628284006, 590989566, 830164461, -1374402900, -671850061, -570284240, -1927073191, -582712300, -629368835, 1629642855, -215978251, -1864393556, 424392927)
"mu" <- structure(c(-5.1907620901018, -5.06821691617588, -5.08621776119441, -4.95892670584796, -4.95878074749707, -5.04107150986751, -4.15166925609043, -3.1364561606835, -5.90164155016782, -5.41730828482516, -5.8557497965777, -6.31310624573266, -3.84395749750776, -3.00900494739649, -6.02062230985906, -3.51676955511677, -4.12963402748892, -5.17368778715984, -3.1342188914943, -1.70119622320987, -6.07714614028001, -1.74991646998661, -3.40358196414199, -2.80966387241628, -4.09628113273675, -1.88778209286168, -5.44521535837406, -1.66142673729965, -2.72132441123918, -1.53056733319773, -4.55228463675625, -0.0140471338723105, -5.35775257676607, -4.21287955811659, -3.81396198705151, -0.220479120911085, -1.92149841989657, -2.73277731525191, -4.80778268452261, -2.44634447209858, -3.86753247263758, 1.30240945298865, -1.32993445700642, -3.32386968971118, -1.50960756248117, -1.71734900483635, -3.29420168726118, -0.00827190705562275, -1.68195821916566, -1.57369719921804, -1.50240907625287, -1.16328323907845, -1.1890090311018, -0.818116793689156, -0.722991754733454, -0.225084358624574, -1.06579693546625, -0.0278612503361724, -0.589625108818568, 0.0540692034848224, -0.681673818819098, 1.67387059903822, -0.836578635565932, -0.881839987420006, 0.0951520779338486, 0.536417332213058, -1.56015171458245, 3.70921381830495, -0.645599564266458, -0.474188751200824, -0.075406820081352, 0.00471738478155917, 0.71529281980213, 2.64872514193823, 0.741337584226538, -1.89269038977972, -0.413148319179563, 0.24829713187731, 0.328343684930423, 1.96902393202637, 0.870180068388591, -0.497369833744837, 1.61623155978788, -0.567354811483026, -1.06807234205077, 0.35996881900228, 0.27199664307694, 0.766643800616437, 1.15679506437231, -0.135409477074971, -2.09650344392308, -0.869974118895077, -1.38357308712117, 0.59270225179862, 1.35311713398761, -1.84485363319344, -1.77022361067626, -1.84321650258329, -2.05242960713773, 0.331229608840966, 3.11941249131999, 0.0876889236672881, 0.896637258234023, -2.30679976495896, -4.04513324021396, -1.76482453586974, 3.0248393748599, -1.99179034093117, 0.497968311312023, -2.81715929717732, -5.40489448084913, -3.45901458528559, -0.0572886655433645, -1.91868357426064, 0.204361325012841, -2.38277377856168, -6.44578847881636, -3.27895820348538, -0.48614153375383, -1.41534859376467), .Dim = c(6, 20))
"tau_obs" <- 1.73114182256557
"tau_proc" <- 0.725211970991188
"y" <- structure(c(NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, -5, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, -5, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA), .Dim = c(6, 20))
".RNG.name" <- "base::Mersenne-Twister"
}

inits{
".RNG.state" <- c(21357, 28695, 14259)
"mu" <- structure(c(-4.87423010691093, -4.78418384772349, -5.07554879545373, -4.88397562627781, -5.04564049812701, -4.95416130482253, -4.43185716767147, -3.14824049335809, -4.96513439419249, -5.74119037198584, -5.26068288300076, -4.88826346981288, -4.18876579359831, -3.16091585059195, -5.21784643027555, -3.50009847125957, -5.00550166018927, -5.56703288318192, -4.04102415452975, -4.02952552733471, -6.12982046639246, -1.5127271674798, -4.11545238976084, -2.60518629287438, -4.36600907190068, -2.43185191487249, -5.78278734341099, -0.929462136368985, -3.56901911605743, -0.597474135993718, -5.36854103534455, -0.413308879154218, -4.89518593496655, -3.07314825576169, -3.32520142089229, 0.654880742433449, -2.93455140972034, -2.4159244405333, -5.02354364591846, -1.81060740722232, -2.18932648668158, 0.512021673342876, -2.07411640716807, -2.42961465060904, -2.84309342056706, -2.63099084704564, -2.16541882820879, -0.508078714700469, -0.923376191517725, -0.955058226049022, -2.08353675578929, -1.74821380706273, -2.21048652294872, 0.739757021985487, 0.195258477760734, -0.917812898155806, -1.91718255721019, -0.702556994825985, -2.02065322018807, -0.0484985568996134, -1.2169467665308, 2.49924181803324, -0.51828192616747, -0.0309188654769226, -1.06152189027422, 0.494992709807842, -2.40718116302202, 3.70960463073214, -1.06218822245837, -0.324161596494285, -0.646769301834482, 0.112999453169812, -0.0209478702754305, 3.89072204215922, -0.0491618661220511, -1.18639089231894, -1.98179109695288, 1.17301825863381, -1.02621796763256, 2.12417303305637, 0.261514022866803, -0.28458167550798, 0.563975637424152, -0.11255336564367, -0.362408935153616, -0.403946728524566, -0.155428427251247, -0.666141876203615, 1.20821069431725, -0.388138466313971, -1.70947998726164, -1.2336605912244, -1.55793035070611, -0.741553872811511, 1.14852748693714, -0.723471530280448, -0.60884834684677, -1.08539214108545, -3.01055948515748, -0.388281471973656, 1.60699638456502, -0.48434083890916, 0.793556655069932, -3.1659652420494, -4.21861615246494, -0.375816960702458, 3.28767079028552, -2.50559281095885, -0.688698916262053, -3.90389050543876, -6.39275458651022, -2.18796564711568, -0.118172167702526, -2.42194694241439, 0.0553682066623913, -2.83241429452244, -4.36539817783152, -3.49640831572466, -0.995138856393584, -2.14159547491617), .Dim = c(6, 20))
"tau_obs" <- 1.92948374317005
"tau_proc" <- 0.601991891051389
"y" <- structure(c(NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, -5, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, -5, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA), .Dim = c(6, 20))
".RNG.name" <- "base::Wichmann-Hill"
}

inits{
".RNG.state" <- c(2118419721, 43609180)
"mu" <- structure(c(-5.04452307934416, -5.1462672141258, -4.98130780692737, -5.00387840405012, -4.92982682982689, -4.97313991041502, -4.57730615870289, -3.30487655430814, -4.02690819525349, -4.64809060554291, -5.44685890496157, -3.97498487377929, -4.70819888033169, -3.66773662295419, -4.7227793820764, -3.4391765288999, -5.65314740165061, -4.55547184671224, -3.90999818546017, -4.05245161766747, -5.18352319083469, -2.24832652148181, -3.83339196719847, -3.04231535421462, -3.82989186173078, -2.87137240287262, -5.13720208457267, -1.02852999577876, -3.83729667601936, -2.26403060406116, -4.33767555217189, -0.946407633085713, -5.42414252198133, -2.66863844153578, -2.4055499659092, -0.0918549179964013, -2.47775683872297, -1.93552447343747, -5.61910162020772, -0.362509890638692, -3.52902735637215, 0.442709001975338, -2.18879183185622, -2.13902263854155, -1.57390051843354, -2.15906305353629, -2.96940251100292, -0.146913167233855, -0.978939514418344, -1.30972779552587, -1.34374373787822, -1.46319091333829, -2.89590048073979, -0.271936879362426, -1.76426327593911, -1.3293590979904, -0.456481026482309, -0.973095791613011, -0.741552865622435, 0.0446882216307879, -0.883451761013015, 1.5079671038538, -0.513681306222372, -1.58220829523072, 0.0614275481118191, 0.570581091845301, -1.26383864678883, 2.76067703124934, -1.13863431679532, -0.790032918904923, -0.423339218153467, -1.01206738210987, 0.625101270413889, 3.44185810484707, 1.14814938732667, -0.696169208446711, -0.71061086079979, 0.748601787155486, -0.495296321207276, 2.02638706943959, 0.666843466800073, -0.498038595552569, 0.612735406246888, 0.304809035028224, -0.511621137678784, -0.00910856484015626, -0.955788306213719, -0.666252758302224, 0.833162073667458, -0.175162456272378, -0.819492067404868, -1.81046303867116, -1.30530554733878, -0.288500068174846, 2.44203315074349, 0.113421391365768, -1.2750424691146, -1.93014083158019, -3.19704718548075, 0.302207801832655, 2.50428295773884, -0.0270784705364101, 0.664445945598294, -3.00374342022397, -4.24309306549949, -0.608582440942981, 3.64392096665103, -2.55644003942645, -0.967213326199793, -3.6872899846325, -6.1052468001349, -3.60474833525972, 0.544193182924273, -3.03599440233027, 0.432141349366908, -2.13210424749215, -5.59404956308339, -3.70268529898404, -1.45144098570751, -1.95351068533024), .Dim = c(6, 20))
"tau_obs" <- 2.04078600790238
"tau_proc" <- 0.724914876548165
"y" <- structure(c(NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, -5, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, -5, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA), .Dim = c(6, 20))
".RNG.name" <- "base::Marsaglia-Multicarry"
}



######################################################################################################
######################################################################################################
#### Data 
######################################################################################################
######################################################################################################

data{
"y" <- structure(c(-4.06591991745718, -2.94665209430014, -5.80914299031403, -5.80914299031403, -5.80914299031403, -5.80914299031403, -4.59783674154387, -1.88686814833501, -4.59783674154387, -5.80914299031403, -5.80914299031403, -4.59783674154387, NA, -4.06591991745718, -5.80914299031403, -2.94665209430014, -5.80914299031403, -5.80914299031403, -3.26053097886945, -3.72054301540761, -5.80914299031403, -1.93466900116998, -3.72054301540761, -1.98486998368036, -4.06591991745718, -2.60726358981506, -4.59783674154387, -0.668845883547919, -3.72054301540761, -1.47248282297889, -5.80914299031403, 0.655974922329534, -5.80914299031403, -4.59783674154387, -3.72054301540761, 0.281988862342713, -2.51565896414186, -2.70811366311588, -5.80914299031403, -1.18037030439171, -2.70811366311588, 1.31661982654987, -1.53614971441768, -2.82028710501947, -1.53614971441768, -2.15263466474332, -2.60726358981506, -0.0653754237762429, -0.589253733521219, -0.711150923698861, -1.8412483567478, -1.25195872848308, -2.51565896414186, 0.543420073956604, -0.211473338919426, -2.21545316410442, -1.47248282297889, -0.696849461552251, -1.01127799732093, 0.265852896722762, -1.03091569138165, 2.75676687558721, -0.168704041457194, -0.382628870687186, -0.615086916013517, 0.535170022761435, -2.60726358981506, 3.57821555646438, -1.75581432451179, 0.163154257134424, -0.833582703939862, -0.53950714937723, 1.18076288241878, 3.79205461642565, 1.4123738990455, -1.8412483567478, -0.60208690792214, 0.8962786165969, -0.013864711444381, 1.55353770544924, 0.869955466752787, -1.27700755822547, 1.06823942041139, -1.18037030439171, -0.576583164939999, -0.696849461552251, 0.0554034869116419, -0.382628870687186, 0.462152453642488, 0.138825724259713, -1.32906996434575, -0.900920880514602, -0.770494290290964, -0.56407113301186, 1.43788878016486, -0.900920880514602, -2.28248391223017, -1.88686814833501, -2.82028710501947, -0.43587591418692, 2.24561904248638, 0.677760368893093, 1.5185224738127, -2.94665209430014, -4.06591991745718, -1.1135661849228, 4.40231277434833, -2.28248391223017, NA, -4.06591991745718, -5.80914299031403, -3.72054301540761, -0.770494290290964, -4.06591991745718, -0.274600501197854, -3.09132676577126, -5.80914299031403, -3.46431559990757, -1.44210761092232, -2.0377249228153), .Dim = c(6, 20))
"year_no" <- c(1, 2, 3, 4, 5, 6)
"season_weeks" <- c(1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20)
"x_ic" <- -5
"tau_ic" <- 100
"a_proc" <- 0.001
"r_proc" <- 0.001
"a_obs" <- 15.37
"r_obs" <- 7.84


}

######################################################################################################
######################################################################################################

######################################################################################################
######################################################################################################
#### JAGS model file written by runjags version 2.0.4-2 on 2020-02-06 11:35:06 
######################################################################################################
######################################################################################################

model{
for(k in 1:max(year_no)){
for(j in 1:max(season_weeks)){
#this fits the blended model to your observed data. 
y[k,j] ~ dnorm(mu[k,j],tau_obs)
}
#### Process Model
for(j in 2:max(season_weeks)){
mu[k,j]~dnorm(mu[k,j-1],tau_proc) 
}
#Loops through number of years and defines prior for each year
mu[k,1] ~ dnorm(x_ic,tau_ic) #keep in mind you'll need to index like a matrix 
}
#### Priors
tau_proc ~ dgamma(a_proc,r_proc)
tau_obs ~ dgamma(a_obs, r_obs)
}
#monitor# tau_proc, tau_obs, mu

######################################################################################################
######################################################################################################
#### Initial values 
######################################################################################################
######################################################################################################

inits{
".RNG.state" <- c(249, 1291521872, -1785846284, 847059589, -9023940, 390061274, 1854149578, -192887416, 929214681, 1753521904, -1425408762, 423456059, -580594647, 143719955, -1046473988, 1622402361, -78978836, -229844599, -938203531, -1708622500, -1946914380, -61989773, -755717481, -248252761, -289529193, 1453533779, 356317578, 1124207078, 1198537665, -113016088, -713128526, -256614326, 819712931, -378125448, -1791533542, -1680737140, 1315596272, 78147450, 1731570720, -1198913758, 1800145267, -576433583, -1957066256, -189868913, 1742082707, -831091234, 581938064, -851100962, -1305613771, 1193307806, -1264497859, -153271086, -1429763135, 1784605934, -1024482483, 1015110452, 728072323, 1305730595, -1459977510, 1169481434, -971876516, 1163230284, 358190643, 1079929392, 1539874649, 702969204, -732334572, 793433281, 703053208, -476171510, -1665133659, 1144281124, -1069624887, 1134925007, 970658851, 1312510800, 2068644897, 413475007, 329241309, -159065706, 936472926, -595816764, -1927695167, 621695397, -40813228, -1760820571, -891155817, -1152847878, 82957474, 175046193, -2116372720, -749357071, -145982367, 787371232, 1913392869, 1799051244, 1572462327, -786154767, 1761711193, 1704414571, -935839184, -1827480182, 293536446, 300760498, -1815844415, -1953042806, -605041640, 177752447, 1092916394, 884794770, 1632642266, -893769939, -331732868, 15975003, 2055839283, -2049220891, -1372897500, 257422442, -1761254893, 1489138935, 995899783, 1563681126, 1109970248, -895387198, -1850168714, -1517122702, -1592328408, 1896562400, -588088775, -829445268, -1842650022, 920922626, -984212363, -379271786, -708699898, -1832473598, -251043979, 1164453799, 506487430, 603230147, 1429502691, -1808324764, 1545719497, -1507169544, 1929587745, 1534627890, -663021033, 1571029795, 1343054009, -2034311783, -292451595, -2127185220, -1374914668, 1654872437, -546242740, -1702446922, 1242117132, 1562599935, -1031102863, -516859348, 1601914259, -976580869, -1367126341, -444765213, 1789625250, 91238146, -1680481162, -1095703348, 1977199854, 657402384, 716195738, 214845722, 390085170, -1048801444, 731083132, -1480728279, 1338263047, -1651318889, -1593612480, 1463144761, -1869682187, -633997893, 1652680288, 1607985662, 1192569651, 1531527326, -1097163543, -1890504965, 944879409, 1235997051, 1331377875, 47138957, -67533754, -654375063, -95564853, -252112255, -1799040253, -1265332756, 1282617087, -29606843, 944179339, -781216687, 534009797, -1767096142, 274259943, 691177741, 1494107528, 790585648, -78693007, 1402060985, 270705988, -1450996860, 194362598, 1513754462, 1232393515, 1296413420, 976820451, 1853555827, 382471845, 1620274802, 1388127793, -1425107583, 127057520, 1844821261, -711481571, -77235364, -549020967, 829840953, -1421235867, -1053591885, -679556347, 1053839983, -1673873617, -1188019865, 2055709094, 483832755, -343675047, 1051288122, 451852092, -738056506, 869160487, -1207326243, -1775059234, 1946127198, 488023668, 762544206, -1900503099, -636394559, 1097601250, -192886986, 2070605319, 1201759117, -1194506876, -686956456, 252519403, 1578883163, -948429763, -1865490072, -236945781, -205588857, -1274829907, -590494273, 1627804131, -546860295, 1568129345, 1315737366, -14271305, -1140964692, 314144741, 853619022, -387659212, 2079421234, -299338675, -1536020118, -1408194615, 769578443, 1701441661, -720529451, 1319321180, -2033802335, -1122314854, 1984600199, 1043472516, 94600569, -1790798169, 2120740471, -1091464682, -1154889146, -992317402, 1196287040, 919556136, 1937216936, 481079489, 2028864451, 329203184, 833930624, 199209233, 1606963304, -625437765, 294992948, -427594000, -1384490403, 1327706608, 1253870864, 1438500636, 1700622780, 1584312122, 1132021600, 787946916, 299638009, -1399930922, -959131292, -689283477, 2077059491, -548382076, 127685719, 1941629170, -1712844005, -1895356435, 435232588, 1083029171, -1498726033, 26353256, 1444945128, -319771665, 70436660, -1508585525, 1333446362, -278462150, 809898909, -1699376814, -981495561, -203480642, 760355792, 1340338818, 1104892526, -1190452511, -1180457239, 2070423142, 518425006, 408320756, 938298127, -1422864194, -1314349182, -561362733, 1831980318, 59823331, 277891531, 1048517888, 1413125885, -1510193766, -2095949279, -47211094, -1413938867, -1830589296, -528445496, -65605877, -1338692132, -230368931, 745646981, -1701728099, 351734545, 347097237, -1881903709, 308319630, -459634270, -1742609655, -906717548, -825187179, -342281393, 1235363370, -728488853, -734320735, -1687808499, -583442336, 1651116742, 58755685, 655311791, -1551997173, -773648444, 1198790511, 469509426, 1051585091, -1452682071, 1109698305, 1923761756, 1944941626, -1862676586, 154639845, 391649594, 1972459004, -1709292978, 1654789871, 535373717, 1781940525, -1894997003, -1818952532, 1419968129, -27817600, 1629833253, -1886022808, 1166598251, 1351953817, -2067321376, 16023562, 244750681, 1153039861, -1384056426, 1568109442, -571095063, 449075075, 414961273, 1852522256, -997168394, -1787228094, -942288061, 1095565040, 346619810, 851593964, 2001795758, -104932217, 119281418, 519060983, 100255921, -2131312365, 962530661, 300707388, -1086265979, 1313036650, -1073595230, 760152433, -615461779, -1171682159, -292995751, -229997361, -1946465133, 1357802487, 1913620925, 1362215653, 1876185460, -1526628891, 468358647, 505695136, -470857597, -275156868, -1192814980, 1871726603, 2081122547, -1400690491, -75416299, -117343794, 1720349846, -503351012, -418217971, -1939425601, -1447724455, -1831695667, -2044275687, -575384065, 1498931590, -726107011, -621525550, 1286799489, -2019520036, 170169482, -2053997605, 1521774494, -482753924, 1818951458, -36744296, 1813137701, -58007644, -774915961, -1377346032, -664190238, -1418412971, -1503817911, 1389409536, 1053953925, -1066316285, 2137369248, 2051621887, -430951364, -429225086, 1215678476, -1679573901, 1921515156, 1737541775, -22107141, 2133132036, -583974346, -1154685344, 625006302, 2064278697, 378906536, -169832778, -704988794, 1764534229, 778257472, 79431502, -1305166082, 482764950, -2056222597, -2052986104, 1810109891, 778711421, -728336043, -1924434340, 906127553, 757873396, -747977793, -739257710, -1059382801, -642260011, 1397399776, 388854899, 1055171903, -599360838, -1104861034, 1405946142, 1283164550, 1116916205, -1142648163, -944025548, 268125393, -579777968, -1947192006, 1565275047, -1107897391, -1071149479, -2029081521, 1412819098, 1120529118, -344550658, -1579596997, 951319169, -1932557139, 682309707, 1030309669, 1042198610, -970216718, 1723661909, -1010911617, -1870763631, -736396462, 1656283756, 1124223019, -1661868422, 119904550, 1342303573, 1011120789, 2061893403, -1666563055, 699357511, -1231960179, -428210856, -1001803861, 2033248451, -1680020721, -1865848872, -186311923, 686643712, 2025181539, 199805404, -1426275995, -1251627460, -1597152208, -323727197, -1959194028, -787796706, -676541146, 20910042, 1095732749, 673506435, -589063010, -262849444, -563772075, -1325460707, 31007768, -2130819931, -968752223, -932541945, 95789318, 679912636, 192870843, -2060071098, 1562248103, -782629471, 463822672, 1037366959, -1028746601, 683759551, -1496479120, 371094300, -1462040283, 1092576166, 2144347080, -1037239402, 1458212901, 1715591994, 2113968734, -709174545, -1971993189, 1695218015, 732591080, 1992497041, -317604527, -781586439, -53879296, -601706054, -1650892994, -2043613062, 1779591890, 783355047, -235213772, 262419232, -469758834, -1009048405, 1640669548, 1880518843, -731507850, -480830561, -968573707, -1205171394, 1927248169)
"mu" <- structure(c(-4.985294811065, -4.98714252758241, -4.88295464514756, -5.03488456666276, -5.0230351522719, -5.06809493765331, -4.61247051360776, -3.7924554611034, -4.89221729483371, -4.65562439308925, -5.73115308930243, -4.037784620237, -2.97295576961054, -3.04450944208954, -5.69117349495921, -2.98452538163902, -5.37097570934214, -4.87684965631936, -2.91848003356387, -3.07455729061129, -4.71264865857191, -3.06569040768949, -5.52747432782087, -2.16700113653701, -4.90915159902103, -2.43109671185278, -4.1218616352187, -2.60813017444615, -5.16725421244167, -1.71497652514396, -4.7363830077368, -0.468509712890568, -5.05494305377477, -3.74404890521527, -5.18867817884158, -0.28248267205782, -1.22050841294737, -1.3876204869477, -4.76376517949295, -3.18792174254556, -4.80895431398929, 1.51684491699761, -0.925527505509449, -1.07141165286988, -2.06585735416161, -2.03080737126431, -1.84137958653626, 0.572099316260389, -0.612936252197255, -1.14115543963446, -1.9993463575723, -1.7296086729677, -1.66503464204191, 1.29773507674382, 0.141165992700531, -0.619825436515871, -1.40547121037968, -0.598228037583809, -1.3952595123092, -0.0334543745649276, 0.568197121657118, 2.43839054493141, 0.0176648982999689, -0.137635518193746, -0.80627979067005, -0.913811174401599, -0.346198126655007, 3.44792184366431, -1.27465737935114, -0.278820942154088, -0.746298044433124, -0.743671836204827, 0.933396031713886, 3.29759778665189, -0.0235174829544864, -1.13528842027457, -1.06003246195692, 0.363819809855695, -0.881404193189887, 2.89944965454091, -0.369414858863824, 0.0725128177113036, 1.28804256156333, -0.588661643348986, -0.876753339882284, 0.181116542851692, -0.0468408308753816, -0.214212884637809, 1.23156249184727, -1.0685025323976, -1.90949697739977, -1.36807970011256, -1.05519432950144, -0.918374044382267, 1.09849964312192, -1.94905247635873, -1.53936541960607, -2.37444257663687, -0.81312045492747, -0.380490668513654, 1.50611409631672, 0.28041764391634, 0.834883020921357, -2.66164861646862, -3.89072990787222, 0.198795382632295, 3.23375590388992, -2.39328419555368, 1.38908416683698, -2.93947464868652, -5.63195280138559, -3.96431169978993, 1.87496652737854, -3.87047263203477, 0.620099884122173, -3.04931033134296, -4.2488651078735, -3.05414519142182, -0.632128338563499, -2.40794761211266), .Dim = c(6, 20))
"tau_obs" <- 1.5059065988788
"tau_proc" <- 0.615962045645954
"y" <- structure(c(NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, -5, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, -5, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA), .Dim = c(6, 20))
".RNG.name" <- "base::Mersenne-Twister"
}

inits{
".RNG.state" <- c(12867, 26166, 24373)
"mu" <- structure(c(-4.88455888225516, -4.79381821276947, -5.06492364960481, -5.01701421797166, -5.02424668156988, -4.99784416917427, -3.854730964888, -3.87762214218026, -4.47180430392985, -5.35781917044489, -5.29587858988137, -5.69729839969287, -4.22170023184095, -3.1918622082291, -5.97087751941497, -3.6732044803268, -5.0256447991571, -5.24440764757115, -3.18857959954597, -3.94678316613002, -4.15127310066379, -1.88681024300646, -5.7633051671962, -3.83625960100621, -2.50831140322582, -2.6335479248267, -4.52412377319785, -1.24640333840546, -5.03882538046685, -3.80091493258111, -3.53934460251562, -1.55695185663615, -5.36455711644872, -2.52382285581626, -3.69076470669969, -0.315462510439641, -3.04556250970142, -2.53492540932704, -5.29086279036562, -1.3381314507746, -2.68336946258536, 1.28969466326883, -1.69815840970386, -2.79301640203541, -1.87546675941557, -1.39606898927292, -2.58746015932411, 0.56781843979186, -0.266229583115327, -1.54704678314635, -2.32863164547437, -0.467452781695277, -2.69141513723856, 1.45011263290791, 0.199015195061099, -1.34393169103821, -1.72143514271971, -0.799131588934284, -1.28550618901925, 0.71404015513125, -0.795207661672467, 1.76183914578518, -0.895740157011703, -0.236822750249673, -0.232107169142862, 0.37395081519022, -1.45847894429541, 2.68208612425755, -1.17860344262522, 0.139228353224645, -0.563769783349345, -0.256315388361792, -1.03655463169732, 2.28124875914121, -0.801657762910374, -2.02753052519185, -0.37420167119116, -0.509703776841086, -0.512957165275158, 1.25961359126229, -0.0240673435078371, -0.957587244875197, 0.468647822904437, -0.0494603520202558, -1.2482772632052, -0.66060852513194, -0.621620349530675, -0.161665238763162, 1.29732810034702, 0.908620461074217, -1.34422372899772, -1.48509938357387, -1.07315829682987, -0.601664432295545, 0.178946959602385, 0.413820748157765, -1.1701065259687, -1.73056205551054, -2.09394238837479, 0.41828746793121, 2.7958562639622, 0.679142599279279, 1.08270962244906, -3.32744715107047, -3.394601856751, -1.05601604820934, 2.64241272236752, -0.286256185375211, 0.547972910043341, -3.51656972401625, -5.35256237854994, -3.87518210603572, -0.337077411261033, -2.13905073043546, 0.787312310348443, -4.01280390857447, -6.22376624389242, -3.47347704387916, -2.48813583027863, -2.41933288562192), .Dim = c(6, 20))
"tau_obs" <- 1.2489071727692
"tau_proc" <- 0.846829173697272
"y" <- structure(c(NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, -5, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, -5, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA), .Dim = c(6, 20))
".RNG.name" <- "base::Wichmann-Hill"
}

inits{
".RNG.state" <- c(1934990758, 100428719)
"mu" <- structure(c(-4.94712755430799, -4.95971661597828, -5.27596154066015, -5.04045871495082, -5.04089914233807, -5.04826503442383, -5.0864025882015, -4.78410096240387, -3.71817177756974, -4.25407866391034, -5.82480684350004, -4.63013652832121, -6.57136426842813, -4.59384992472273, -4.7418415712034, -3.74052577765625, -3.68535867094869, -5.1338484986403, -4.61951298041846, -4.01381858173997, -4.624737709663, -2.06859735252382, -3.01255581996842, -2.45427060212837, -4.9847977582137, -3.18430043540944, -5.05394599949389, -2.24390278957753, -3.19159687453929, -1.6734806832444, -4.46614347265238, -0.469600891389858, -5.66700564187089, -3.72739577369257, -3.02736861830781, -0.00593455738578479, -2.0670075999539, -2.47535862516666, -4.43979728829438, -1.66036803805971, -2.86399755555274, 0.482822198765859, -1.09372538065932, -1.83465425454029, -1.63582482426674, -0.709389253456903, -3.06814523573667, -0.626741395816887, -0.557912657567061, -0.734089628825136, -0.427753828513967, 0.0849012735516607, -2.45760951257621, -0.994257246806677, -0.649718451561026, -0.896454754419168, -1.22301273641907, 0.980050897570809, -0.745477743866587, -0.607684632289424, -1.26925759729962, 1.15189042534177, -0.506012385774156, -0.179361943736822, -0.307339658517797, 0.0791430662741666, -1.06230232213377, 3.12215847876503, -0.116920181537365, -1.24551634368881, -0.275756737427588, -0.335425915500931, 0.464192300135372, 3.51359782752479, 0.417610862519115, -1.33889764370116, -0.858267796717808, -0.748419655688979, -0.23013750685347, 2.27080969973403, 1.24323802285325, -1.237112990318, 0.938202227594919, -0.91719444417802, 0.0477522243311091, -0.496453526565476, 0.222531972560849, -0.803891890652594, 1.95661708283457, 0.00511407041370754, -2.10510167473167, -1.14810651969119, -0.636496120060299, -0.873900458086045, 1.36507186893852, -0.61346242550354, -2.02261285681147, -2.26551259576423, -2.20503918545628, -0.732691441600265, 2.67530519244322, -0.178489889846944, 0.600277197711831, -3.72862376506317, -4.26819968222384, -0.817768378075162, 3.64436980987688, -2.55112098231999, 0.192559259274485, -4.08928382991583, -4.54195113106191, -1.96015981313864, 0.47769723538058, -4.13609351171378, 0.136910098321351, -2.26482804824422, -5.23668624594897, -2.49009498900554, -1.80132885816058, -1.93920141379016), .Dim = c(6, 20))
"tau_obs" <- 1.60258183091843
"tau_proc" <- 0.812712413531914
"y" <- structure(c(NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, -5, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, -5, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA), .Dim = c(6, 20))
".RNG.name" <- "base::Marsaglia-Multicarry"
}



######################################################################################################
######################################################################################################
#### Data 
######################################################################################################
######################################################################################################

data{
"y" <- structure(c(-4.06591991745718, -2.94665209430014, -5.80914299031403, -5.80914299031403, -5.80914299031403, -5.80914299031403, -4.59783674154387, -1.88686814833501, -4.59783674154387, -5.80914299031403, -5.80914299031403, -4.59783674154387, NA, -4.06591991745718, -5.80914299031403, -2.94665209430014, -5.80914299031403, -5.80914299031403, -3.26053097886945, -3.72054301540761, -5.80914299031403, -1.93466900116998, -3.72054301540761, -1.98486998368036, -4.06591991745718, -2.60726358981506, -4.59783674154387, -0.668845883547919, -3.72054301540761, -1.47248282297889, -5.80914299031403, 0.655974922329534, -5.80914299031403, -4.59783674154387, -3.72054301540761, 0.281988862342713, -2.51565896414186, -2.70811366311588, -5.80914299031403, -1.18037030439171, -2.70811366311588, 1.31661982654987, -1.53614971441768, -2.82028710501947, -1.53614971441768, -2.15263466474332, -2.60726358981506, -0.0653754237762429, -0.589253733521219, -0.711150923698861, -1.8412483567478, -1.25195872848308, -2.51565896414186, 0.543420073956604, -0.211473338919426, -2.21545316410442, -1.47248282297889, -0.696849461552251, -1.01127799732093, 0.265852896722762, -1.03091569138165, 2.75676687558721, -0.168704041457194, -0.382628870687186, -0.615086916013517, 0.535170022761435, -2.60726358981506, 3.57821555646438, -1.75581432451179, 0.163154257134424, -0.833582703939862, -0.53950714937723, 1.18076288241878, 3.79205461642565, 1.4123738990455, -1.8412483567478, -0.60208690792214, 0.8962786165969, -0.013864711444381, 1.55353770544924, 0.869955466752787, -1.27700755822547, 1.06823942041139, -1.18037030439171, -0.576583164939999, -0.696849461552251, 0.0554034869116419, -0.382628870687186, 0.462152453642488, 0.138825724259713, -1.32906996434575, -0.900920880514602, -0.770494290290964, -0.56407113301186, 1.43788878016486, -0.900920880514602, -2.28248391223017, -1.88686814833501, -2.82028710501947, -0.43587591418692, 2.24561904248638, 0.677760368893093, 1.5185224738127, -2.94665209430014, -4.06591991745718, -1.1135661849228, 4.40231277434833, -2.28248391223017, NA, -4.06591991745718, -5.80914299031403, -3.72054301540761, -0.770494290290964, -4.06591991745718, -0.274600501197854, -3.09132676577126, -5.80914299031403, -3.46431559990757, -1.44210761092232, -2.0377249228153), .Dim = c(6, 20))
"year_no" <- c(1, 2, 3, 4, 5, 6)
"season_weeks" <- c(1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20)
"x_ic" <- -5
"tau_ic" <- 100
"a_proc" <- 0.001
"r_proc" <- 0.001
"a_obs" <- 15.37
"r_obs" <- 7.84


}

######################################################################################################
######################################################################################################

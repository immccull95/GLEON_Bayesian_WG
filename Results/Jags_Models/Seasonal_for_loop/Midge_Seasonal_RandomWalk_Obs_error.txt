######################################################################################################
######################################################################################################
#### JAGS model file written by runjags version 2.0.4-2 on 2019-08-10 17:15:34 
######################################################################################################
######################################################################################################

model{
for(k in 1:max(year_no)){
for(j in 1:max(season_weeks)){
#this fits the blended model to your observed data. 
y[k,j] ~ dnorm(mu[k,j],tau_obs)
}
#### Process Model
for(j in 2:max(season_weeks)){
mu[k,j]~dnorm(mu[k,j-1],tau_proc) 
}
#Loops through number of years and defines prior for each year
mu[k,1] ~ dnorm(x_ic,tau_ic) #keep in mind you'll need to index like a matrix 
}
#### Priors
tau_proc ~ dgamma(a_proc,r_proc)
tau_obs ~ dgamma(a_obs, r_obs)
}
#monitor# tau_proc, tau_obs, mu

######################################################################################################
######################################################################################################
#### Initial values 
######################################################################################################
######################################################################################################

inits{
".RNG.state" <- c(268, 919006237, 937475668, -18859567, 2009211344, 1420626449, 781907251, 1103568515, -945317522, -1472038590, -1120351963, 340785849, -1181725619, 1050732589, -246774404, -497352712, -1791276822, -4379082, 1539061552, -784455952, 362024247, 1993192687, 1567034193, -1077992743, 225164642, -960864750, 579961069, 1695190216, 1917413069, 706650657, 343727204, -1299624574, 2050947306, -1701619713, 435663751, -1322727402, 1719988935, 2069087507, 726684678, 1814646847, 1685826894, 1448594548, 470112539, -674662010, 871857316, 341645883, -776057013, 1130234001, 909799697, 1882411066, 239825699, -1727273235, -647220200, -1182490819, -245433136, -655227111, 403836146, 787836205, -1720583159, 1148667976, -520953097, 2069254276, -1814687270, -851077774, -1229003771, 1362056418, 1507931641, 1128531459, -508794963, 1994637781, 1643202199, -1094839742, -3259113, -1407303343, 807241545, -79577252, -1035761619, 1018654070, -1549639714, 804377144, 2086606698, -1360757951, -387777917, -1241766507, 1871107928, 1385247030, 1312044064, 322678308, -1179586895, -633637642, 1009476518, 633165947, -1377041333, 485412375, -1647730764, 961881159, 1783547784, -985109855, 554297376, 436353896, 31185730, -1719666189, 2102903440, 1488508949, 1343762721, -1927298192, 1559504114, 1681550255, 14368571, -1565521632, -1284496603, -835002779, 312191043, -929014829, -1626198680, 950581214, 762463881, -438363974, 583901397, 135262223, -1522011066, 210117185, 992955866, -1698607886, -1410545315, 1378139127, -286324984, 1815166881, 722053056, 374320174, -865003797, -1021173161, 2145799224, 360133057, 1881448448, 1166203926, -1705275400, 977549232, -1143343909, -1775414839, -1658135216, 574568200, -2059771081, -415523387, 31275550, 716391594, 1262534366, -356585295, 385651365, 194883370, -1432443261, 1859824834, 1280691962, 2050904651, 1795140605, -925418774, -1175320498, 1196473062, 1817765749, 977162416, -31473312, -686554932, 949935182, -1318617554, -1161975359, 343437558, 1241979914, -1882493262, 1168428506, 1845311610, -2141477725, -1962405062, -1597388645, 1219535251, -680061048, -447333287, -1034029970, 99769930, 1703618478, -640583819, -757119235, 450976050, 1279342777, 1340612068, 1751519786, -1391284902, 1470673041, 1863800609, -1213240798, 973592122, -1309526885, 1963917619, 1651719271, 1590048880, 527276420, 1799351694, -739452434, -916886677, 1255144416, 158973829, -1634270725, 1220936285, -361546160, 1466984613, 1839267644, -1319349745, 2021573230, -2107212278, -1882710927, 1811336528, 2109668197, -552394036, -115990564, -685541814, -1313110806, 251000164, -1053319196, -1269033782, 1515874268, -2053021968, 1616107636, -260051097, -474721373, -532012800, 1373595284, -1040754933, 117861061, 116955173, 311828746, 581027166, 32053890, 1119625704, -768680130, -1898093003, 1247770274, 1619671732, 1727514884, 1467551950, -1402539324, -473095809, -1356692822, 100657859, -337976834, -74782650, -2054818032, 1602047040, 1761868428, -1469980029, -2037984763, -395794885, -1739659837, 740678796, 524578297, -1484723787, -1733209439, -520547568, -1598945515, 749402226, 220029771, 1092577182, -203866538, 86842796, 1408258057, 1428888083, 1332339046, 1494471465, 731269148, -895663808, -543294867, 910964826, 1216523941, 2083591753, -296361670, 1946037528, 43291404, 2026123823, 225421592, 439132875, 710731650, -294918938, -1156165055, 1437325668, 1761727574, -541751553, -259157880, 493225397, 979624981, 1570917248, 860184556, -1772115395, -423704288, -213731746, 339713486, -1286052427, 1020092073, 274438900, 196607469, 1645608408, 1110760161, 695332780, 68185136, -62026056, 1316957706, -2112497670, -234659564, 71208406, -1952025005, 1257600529, -669533939, 488715699, 77521041, -15536958, -2065865252, 1842792256, -1270796371, -1741443603, 1621733647, -49959070, -1432376462, 1358569555, -326967765, -398451332, -1295070152, -1270444672, 370510849, 1177188811, 1106487290, -1545100799, -1037036201, -180144409, 703134198, 627232405, -1988728, -518340585, 1315125733, 2017124821, -613469690, -1969233460, -235261946, 931632886, -169745918, -1312629456, -400888004, 1996092476, 561551620, -1366250202, -1684833453, 1595748334, -2146386831, -1127872824, -1289464932, 531240399, -1860718923, 1002870584, 1790173113, -149502614, 2021006449, 444444359, 105944303, -1251963779, 248861650, -1963287073, 86436319, 1789218043, -2087748292, -1760681134, 363167680, -1305560782, -228669192, 250859892, 412480807, 2015787753, 10406157, 476110046, -1087852486, -507325464, 1672510455, -2007987333, -676277834, -242830401, -257214731, -344992849, 1399198561, 1465068622, -1996395236, 1258414506, -418511549, 1654550471, 671501118, 1427690867, -1964236128, 664573880, 1221653050, -1585089177, -45940826, -2061991926, -1255944324, -1389825835, 1369667670, 1635538726, 1574179780, 1859239628, 484872064, -1708320221, -173263054, -1507898734, -21402664, 1498227046, 250998154, 1439691198, -427289122, 1509602411, 1893648824, 1527473386, -505424497, -2132389633, -2106995379, -1947749912, 1296825770, 856668404, -1385213910, -1865028591, 1856138381, 1320802348, 1144148039, 1965625107, -774775688, 1247686694, -1807803148, 1047520966, 344615072, -38164416, -814103301, 521474832, 1242418462, 786839401, -2010489741, 19007881, 120115672, 766650640, -729323248, -1960132359, -1099249244, -1438112267, 431191419, 1879924767, -1774537072, 1266932291, -1348455995, 1750536154, 1667835646, 985245241, -1274661194, 2020114019, 1311107490, -1719189992, -784892797, 832804830, -452117364, -1918378516, 1335267772, -82608619, 41350216, 1467105782, 1752142347, 13227629, -1320273771, -43617407, 598308299, -1863718645, 1121638456, 985549740, -492720903, -843007427, 107026910, -596192802, 540647341, -1174706744, 800718838, -320967924, 1122574425, -1467527631, 1114593079, 661175870, -1205234099, 881374927, -2029931045, -776431879, -106818079, 411877294, 2001113934, -677606160, -1569526650, 784732678, -1885726346, 475138354, 484585367, -896087030, -789772569, -1732491007, -2040042353, 606331367, 1837806457, -271846980, -1898596309, 1441314966, -1954831131, -1227929177, -1181858366, -42849653, -1667097654, -1319701582, -1121358624, -941313988, 1993841016, -2015637775, -516686023, 1788625572, 1543874747, 1224780937, -1668950606, -1875156255, 1436572114, -678402507, 494261862, 1061178308, -109561181, 198513956, 1879226862, -642160671, 56086521, -757124065, 509379285, -1350877103, 200920521, 1108158385, -137894814, -1510947005, -430113339, 1560827548, 936829427, 1103364440, -644437339, -1103816253, -1144676678, 387593073, -1648778493, -1954327057, -2000426289, -243972235, -1726276290, -1149116666, -1016059385, 1406342499, -1719235534, 416835233, -1827727166, -776126986, 871818176, -1563487155, -28323225, 1193964326, 1965097994, 1300000411, 1882698886, -1853131336, -1102838308, -2026190387, 1817755474, 1294811704, 1343904540, 810831090, -914305365, -168846357, -1129849859, 1223825875, 1088897454, 2075172133, 1746821204, -326937874, -1678874938, 1868843672, -1054431397, -1178096817, -40753349, -2116238029, -1547224456, 1177812484, -727252012, -178663943, -165717035, -654782130, 650866587, -189101221, -478110748, -1089761860, -1030166989, 91864451, -481099439, 979536291, -661772127, 1123587662, 917071884, -1996685277, 843673232, -1579019729, -714018913, -1473984212, 1576021554, -531760895, -417370495, 46046064, -1091148043, 1862188465, 1047245550, 762444351, 916438538, 759889584, 678279341, -1980033288, 399239138, -1421265297, 1544015973, 1945982462, 792933892)
"mu" <- structure(c(0.0777497030661686, 0.206863841080331, -0.020899370924624, 0.0201255751322285, 0.182400511681481, 0.0403149988748016, 0.866892771239902, -0.557584294351452, 2.84540248511669, -0.142776238853738, -0.553964683160995, -0.876743019422471, 4.38686726937181, -2.60882555464762, -1.93539572899149, -1.56641195537176, 1.06236234747624, 0.516262672913938, 1.03723985528997, -0.420135646420482, 1.23391779804515, -0.833571441038132, -1.08203110204576, 1.01839113440964, 0.240052263987781, 1.12867133481815, 0.38628825956905, 0.65901248875745, -2.89670508442857, -2.18463490262737, -1.46469833138736, 1.91962023303892, 0.131203318249254, -0.250557656997929, -0.579222618100533, -0.395039916177246, -0.921911891037517, -1.03909788412537, 1.12840154726785, 0.53067618743457, -0.994953028654682, 4.06890276131532, 0.251970137885178, 1.8230334686959, -0.69431031845758, 0.225811204128299, -0.259355260143254, 1.5120315630575, 2.3828025728468, 0.311126162670376, 1.47045034407057, 0.297963556074069, -0.955569062231948, 2.83258565487952, 1.47825143150955, 0.409189884808479, 0.664498357475057, 1.74751688625467, -1.43785808126099, 1.94035262048818, 1.29522830901342, 14.1474750677182, 2.20230945242586, 1.58154224511836, 1.29906152360895, 3.49741930961379, 0.271643402903231, 35.6351220098847, 1.50790831142481, 1.93522612928913, 0.592684742497782, 1.89981407880121, 3.17434798158419, 42.3575219512577, 3.88892066774146, 1.08088089453299, 1.4900998145209, 2.16900765894896, 1.02750345320553, 6.38348740096732, 2.97063613354354, -0.439824554462127, 3.35460774206548, 3.05936943864872, -0.322256304261852, 1.83773843015292, 1.62581067688647, 0.0988885303864928, 2.62820219128464, 0.176375303867289, 1.91457669317071, -1.79695253003966, 0.328708025956061, -0.50759613067926, 4.29618304057818, 0.459065355347214, -0.446915286950511, 0.646791279086033, -1.86899321266877, 0.823379349968677, 9.54576863329264, 1.28542259428819, 4.57830995496938, 1.10057089814654, -1.79038091374684, 1.13182272375314, 80.7392524363468, 0.951615003115194, 4.75405709993263, 1.5283509513801, 1.21089784732025, 0.583668925544456, 0.965180836364439, 0.772702695819833, 1.79364035796126, -1.85005856977567, 1.27044624556133, -1.73936727830071, 0.366469371424739, 0.192718032477116), .Dim = c(6, 20))
"tau_obs" <- 0.780532941229058
"tau_proc" <- 0.00998013362966472
"y" <- structure(c(NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, 0.1, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, 0.1, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA), .Dim = c(6, 20))
".RNG.name" <- "base::Mersenne-Twister"
}

inits{
".RNG.state" <- c(14960, 6623, 28541)
"mu" <- structure(c(0.104845648538914, 0.173377254843666, 0.0698968626513895, 0.264183517208682, 0.155217353660199, 0.0025495533658853, -2.22021496348217, -0.328975048284478, -0.422600042846201, 0.751359269423734, -0.736982144425639, -0.581904612887983, 1.03000945210462, -1.07932228053745, -1.39676047663929, 1.33517948007817, -1.02100275450574, -0.381322410062282, -0.0277571121264081, -1.10853503791043, 2.07528559266386, -0.144317361020061, 1.60246053437673, -1.56572935428166, 1.29624874817824, -0.672879068401902, 0.49015323163684, 2.29407555895613, -2.17262003552199, -1.84949465479091, 0.280130331338033, 1.68972378224771, 0.962089706562316, 0.649570277869708, -0.016342518594587, 0.302590492107858, 0.342983095180245, 2.13969608960489, -2.36146895642752, -0.899790044837703, -0.0174423208334073, 4.98528816598797, -0.0685841516387268, 1.1609096093975, 1.63737823547224, 0.672595062761569, 1.61370027815245, 2.43006278134901, 1.04338246464317, 2.37676398469716, -1.39046631445905, 0.927994347352896, 1.02551398426641, 1.95627587176918, 3.71512228838355e-05, 0.425503557206001, 0.368918201019149, 1.93009671728437, 1.56027126979261, 0.424522618330276, 0.288247341685582, 17.6090428290292, -0.173745050771327, 0.557944393669462, -0.132844490317888, 4.78352668128762, -0.16416246813181, 32.8989208968117, -1.12938566244047, 1.50149908084275, 2.16477409300721, 1.67110974315378, 5.13173053672146, 43.4185565437655, 4.82924058057506, -0.0699601213203959, 1.60163490424898, 3.71060773034335, 0.617649154510574, 3.74006334943575, 3.02099087081268, 0.268711808341997, 1.5151136179815, 1.49916811580087, 0.842896202056972, 1.28550706078477, -0.0467720579417032, 1.16771806741852, 0.817422119890399, 1.83285783342132, -0.175895688124169, 0.621004945022646, 0.463127504465693, 2.16326130875456, 2.56488588665635, 0.57711064610614, 0.412644576816267, -0.0608783490069429, 2.55248234671933, -0.413996263326816, 12.3659075204999, 2.16073996466327, 2.3810543936071, 1.45497443332351, 1.63810516688296, 0.44503619362014, 78.9004848109437, -0.665315153603479, -8.76873427457653, 1.69992022500282, -0.538294921570778, -1.89894789394771, 0.716891061152867, -1.88616294699337, 3.00036333870578, -0.976687235563363, 0.119706763849324, 1.00599965191728, -0.174016381767516, 0.371254782983733), .Dim = c(6, 20))
"tau_obs" <- 0.632617048135449
"tau_proc" <- 0.00739584217625588
"y" <- structure(c(NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, 0.1, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, 0.1, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA), .Dim = c(6, 20))
".RNG.name" <- "base::Wichmann-Hill"
}

inits{
".RNG.state" <- c(1625814360, 70811180)
"mu" <- structure(c(0.144094830080864, 0.257047543319157, 0.326398223065053, -0.0257073819506284, 0.1543615770709, 0.370972464147805, 0.28738867229117, -1.7392925960117, 0.494700937021541, -1.72771728171233, -0.339975181667941, 0.430669985251465, -0.439286288657402, -0.284151345397049, 0.797027846706057, 1.43514722342103, -0.383859306403897, 1.1203801269946, 0.245815895683403, -0.340026714387229, 0.493003775938536, 0.245886010016094, 0.417088206205868, 0.0675586285562159, -1.32549771062598, 2.51110359000434, -1.1755124427373, 0.981466271895007, 0.219964947828988, 2.52282129398259, 0.812767694174271, 1.98746457149508, -0.732593338527022, -1.01016855041425, -0.0927757902405892, 3.31620355252805, -0.427941746757457, -0.550480947359558, 1.26892128004636, 1.01064412443378, -1.34086973315699, 4.13639613511295, -0.809691403749201, -1.09486633042973, -0.922528515389594, 1.15533704466772, 0.45916818657566, 1.2353278315112, -1.05925939358046, -0.545055217894555, -0.270819796045685, -0.028503729371533, 0.92123796555601, 2.40081784459986, 1.7558679184107, 0.378317763566275, -1.31675125139961, 1.73655396510998, 2.44298672519025, 0.814768202879205, 0.553074574990011, 16.0795312028357, 1.22270634743555, 1.68384473365803, 0.678821156056541, 1.85035683504631, -0.911203012906134, 38.0239614874168, 0.326942013690012, 1.65635131534219, -0.188413421091137, -1.27636520251982, 2.67309534085622, 43.2317671585816, 3.57182547613102, -0.104499064387677, 0.225519742611487, 2.55987811238719, 0.440862815039913, 4.01114788516032, 4.3067429237265, -0.853467004700298, 3.44898230048257, -0.434810999654098, 0.438009325318767, 0.316035642625417, 2.24372495533895, -0.139514734600806, 1.92277618741567, 1.69251314424339, 1.66859232225642, 0.102795979436842, 2.30380562955007, 0.315958829824337, 3.83281880420241, 1.68734670975309, 0.143208227271777, 0.989360530812931, 0.112845858828568, -0.167119491720206, 10.2974677919055, 2.81751501664233, 4.29443940767691, -0.689754671452202, 0.840099247508546, 1.00686537484411, 80.6534733939112, 0.614628721478454, 5.25394477992382, 0.0120092650093673, -1.97576218925087, -0.307680011284726, 1.57709674544067, 0.689157340646338, 1.29447515490208, -0.995657148212574, -0.765821864726796, -0.689917621731278, 2.15478754891787, 1.68471419222122), .Dim = c(6, 20))
"tau_obs" <- 1.1118901165166
"tau_proc" <- 0.00912908523779363
"y" <- structure(c(NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, 0.1, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, 0.1, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA), .Dim = c(6, 20))
".RNG.name" <- "base::Marsaglia-Multicarry"
}



######################################################################################################
######################################################################################################
#### Data 
######################################################################################################
######################################################################################################

data{
"y" <- structure(c(0.014147208, 0.049515228, 0, 0, 0, 0, 0.007073604, 0.148545685, 0.007073604, 0, 0, 0.007073604, NA, 0.014147208, 0, 0.049515228, 0, 0, 0.03536802, 0.021220812, 0, 0.141472081, 0.021220812, 0.134398477, 0.014147208, 0.07073604, 0.007073604, 0.50929949, 0.021220812, 0.226355329, 0, 1.924020297, 0, 0.007073604, 0.021220812, 1.322763954, 0.077809644, 0.063662436, 0, 0.304164973, 0.063662436, 3.727789325, 0.212208121, 0.056588832, 0.212208121, 0.113177665, 0.07073604, 0.933715732, 0.551741115, 0.488078678, 0.155619289, 0.282944161, 0.077809644, 1.71888578, 0.80639086, 0.106104061, 0.226355329, 0.495152282, 0.360753806, 1.301543142, 0.353680202, 15.74584258, 0.84175888, 0.679065987, 0.537593907, 1.704738572, 0.07073604, 35.80658362, 0.169766497, 1.17421827, 0.431489846, 0.580035531, 3.253857855, 44.34442368, 4.102690339, 0.155619289, 0.544667511, 2.447466995, 0.983230961, 4.725167494, 2.383804559, 0.275870557, 2.907251258, 0.304164973, 0.558814719, 0.495152282, 1.053967001, 0.679065987, 1.584487303, 1.145923853, 0.261723349, 0.40319543, 0.459784262, 0.565888323, 4.2087944, 0.40319543, 0.099030457, 0.148545685, 0.056588832, 0.643697967, 9.443261384, 1.966461921, 4.562474601, 0.049515228, 0.014147208, 0.325385786, 81.63646415, 0.099030457, NA, 0.014147208, 0, 0.021220812, 0.459784262, 0.014147208, 0.756875632, 0.042441624, 0, 0.028294416, 0.233428933, 0.127324873), .Dim = c(6, 20))
"year_no" <- c(1, 2, 3, 4, 5, 6)
"season_weeks" <- c(1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20)
"x_ic" <- 0.1
"tau_ic" <- 100
"a_proc" <- 0.001
"r_proc" <- 0.001
"a_obs" <- 29.5
"r_obs" <- 39.4


}

######################################################################################################
######################################################################################################

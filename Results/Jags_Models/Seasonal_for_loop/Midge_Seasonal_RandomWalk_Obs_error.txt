######################################################################################################
######################################################################################################
#### JAGS model file written by runjags version 2.0.4-2 on 2019-08-16 11:15:26 
######################################################################################################
######################################################################################################

model{
for(k in 1:max(year_no)){
for(j in 1:max(season_weeks)){
#this fits the blended model to your observed data. 
y[k,j] ~ dnorm(mu[k,j],tau_obs)
}
#### Process Model
for(j in 2:max(season_weeks)){
mu[k,j]~dnorm(mu[k,j-1],tau_proc) 
}
#Loops through number of years and defines prior for each year
mu[k,1] ~ dnorm(x_ic,tau_ic) #keep in mind you'll need to index like a matrix 
}
#### Priors
tau_proc ~ dgamma(a_proc,r_proc)
tau_obs ~ dgamma(a_obs, r_obs)
}
#monitor# tau_proc, tau_obs, mu

######################################################################################################
######################################################################################################
#### Initial values 
######################################################################################################
######################################################################################################

inits{
".RNG.state" <- c(8, 747298924, -2006902074, -1108951079, -1355162603, 1362878053, 150606250, 1760099628, -142384736, 109227298, 514810689, -2124377326, 508492347, 437901948, 1445744601, 885943462, 1759130110, -536034471, -2145754619, 2144305114, -450441709, 400325911, 1030299363, -811450832, 36205879, 839122128, 1394170877, -1552287514, 211727842, 660777135, 1296945547, -180360344, -406402710, 1659501986, 1860786810, 58976961, -1241884553, 232707859, -1403953600, -953856067, -139379955, -2102468241, 1376922744, -1811761874, -1142548628, 629092355, -186850797, 1429936545, 58177036, -511563111, 155480830, -397487813, 279670455, 918810863, -1903664909, 1875080128, 254252841, 2057794123, 1503158311, 1626833565, 1229717667, -1889556550, -1840583380, 1547884510, 1125423657, -2063619120, -455283175, 619500685, -2087075366, -1178413617, 846616677, -1124125813, 1331959438, -2093681553, -229601714, 704356646, 2015903339, -2051336635, 1045730786, 2080321129, -2079875771, -316945251, -1049797468, -147304277, 523523501, 236787176, -1226452623, -980779255, -933859653, 1629130920, -1181514633, 1342360759, 1881191326, -359360445, -982682829, -188343116, -1027510196, -1057135217, 268289033, 2102239445, -697329661, 322278725, 2092829251, -1555383033, -1542890585, 1654524834, -607065139, 369779873, -235061828, 127463795, 343098379, 1483054379, -724383699, -1760614672, -1770167191, 516658873, -98837861, -1042743822, -1902422205, 1631190512, -930427156, 724741607, -1063500959, -2035343459, 2136204885, -1218072441, -1427523738, -466406145, 1431953900, -204041113, 748446845, 1804747843, -505787405, -2087637324, 1671083192, -1154842848, 1110815278, -1024159431, 1230553872, 428821324, -992628870, 2090239011, 832025906, -1853502093, -160995595, -1142331024, 1104310417, 229765879, 1281512831, -1872574768, 834779424, 55050678, -2087095621, -558104155, -1618035131, 667190967, 575511004, 1997310865, -493897188, 850572627, -141692, -153081844, -2102820004, -730232994, 1492441908, 1823860704, -2109502003, -1258738912, 1763380842, 168601341, 995465208, 1499300332, -1561532913, -743199186, -1925820854, -661399478, -928967565, -70411778, -585698055, -365900238, 831342563, -1208980382, -2115671802, -216672638, -2045578696, 1020485769, 1759738809, -2129813838, -448298584, -356780993, -316087452, -565035055, 989057300, 124217461, 733449548, 632118001, -1455472374, 1222991536, 117238489, -1740078753, 160701768, 51483911, -917146179, -1863964949, 1312777704, 153579365, -1352039515, -589788545, -2143094477, 1451765293, -544992387, 633788370, 1283079515, -1430019658, -48615050, -78528498, 1858260218, 210635240, 408727324, 1570318253, -1639694337, -1957618358, 1064009243, 1522692229, 1769710062, 2050960128, -310370036, -1204522688, -1208084982, 1967490603, 681804561, -1759130737, -1989851622, -1617253200, 972043067, -1905026246, 1750879913, 772382937, 222961663, 436497291, 47545764, -1860666522, -1017248150, 1023332021, 679642213, 442018511, 920823335, 1145757545, -1282822660, 885305666, 206855295, 908800189, 1884139877, -1286452478, 569131364, 1244991160, 1021943367, 702167844, 897689220, 1461490232, 607116413, 179242554, 1766434496, -912243939, 1027110367, -906942287, -395408939, -632964269, -1057871685, -739489668, -810993845, 1292796943, 190528086, -1377118785, -2142076730, -917924650, 197851299, 2031094888, -1834424133, -1261672139, 1478237316, -2115387559, -107174643, -486631593, 969138445, 2093978286, -2032661023, -190599844, 1517731514, 1599088560, 1239704281, -1680223599, -1084695207, -2047957860, -750561379, 1965411598, -1915256039, 132650138, 416799079, -717555829, -1958839288, 1146640840, 763564671, -1543886758, -1409172843, -645098953, 185893190, -1112235458, 1289624599, 1040630645, 1630865522, -1786268487, -1757237497, 1650576818, 888047688, -1151840441, 1944480722, -1676009601, -72412915, -880749629, 495449771, 155654134, -1313824811, -914325983, 721694997, -757887990, -173007725, -997728768, 673135486, -1514365960, -411961266, -290314873, 1475016653, 1651123820, -1646783611, -904831125, -93240685, -591192676, -1197597055, -222051780, 1443345070, 753304757, -15348928, 242630874, 241415765, -1819901375, 862314050, -691529439, 936525119, 1196219291, 1026629096, 1759009768, 1096872113, -738936898, 1770254577, 271470126, 499903644, 603928976, 1645355924, -341468844, -813750600, -1021583867, -183231993, -2082342049, -1784692910, 161229557, 451184033, -1222231377, -989543450, -332544443, 4718795, -755303466, 1180715885, 331011184, -1237560252, 379117327, 1865991247, 614774796, 1363963638, 413989587, -443481387, 1175704631, -476953885, 1697172584, -1236213848, -1311155506, -1984962591, 17687624, -1282188893, 983745946, -1720471341, -1183264390, 1927976350, -779981033, 644040251, -1303461637, 1796778298, -1770691225, -1688547704, 1856229990, 621827462, -1022192843, -1675698388, -396480450, -1507823777, -1675367676, 799157370, -1423192607, -1568012449, -1475635065, 1057872990, 1902128269, -1310123557, 1014826851, -577744251, 249368498, -603700317, -294350492, 1978072993, -1319799993, 1324982742, -461454359, -441940771, 124814198, 301920232, 1742851037, -1356685529, 1304138198, 1794050760, -282509177, -2007601588, 1927317995, 1655423632, 1811455260, -179947243, -89006686, 290433968, -568759036, -514484684, -1292156439, 1929733393, -201082793, 1582293435, 1975185650, 56860654, 522766102, 380759835, -1271974926, 664580366, 634562798, 993350093, -550099663, 982370588, -1345239991, -1243435782, -1123775816, 349382219, -1648399857, 57047275, -2138144074, -1525268637, -1704847404, -1948485547, 1290387813, 938313189, -1445511466, 1811572664, 1828431861, 2118611568, -2146095853, -1871945351, 1748558804, 718116143, -111924640, 1213763778, -678484208, 1245535867, 1373049966, 1283607551, -355403922, -1933788032, -2074415420, -318406493, 978034535, -639352857, 923934032, -1608069383, 1659179626, 1712992359, -770360681, -1249835590, -242615372, 327946925, -1430409360, -1972276740, 569978443, -1074669843, 345253876, -167708773, -1521784484, 406290211, 29931740, 287951488, -1725414137, -740069064, 1105121588, 1815913695, 1661939018, -1221787844, -558300113, 1746876337, 1027222191, 2087888789, -1160224909, 668476090, -483980042, 952238758, -1582089234, 813607825, 1867663124, 805218090, 1435117593, -131915545, -1481131457, 94644695, -321776072, 2062979435, -706627308, -1925036914, 1242729400, -1011957274, -2135058070, 445625878, -1517957800, -7394674, 1994511767, -1254282610, -893700537, 1557727937, -1186907407, -1572111161, -1232455658, -803057815, 1278414531, 978953712, -1579410839, 1382158924, 1259074124, -1316887930, 79909546, 1494306040, 1600372289, -895298497, -777274981, -1371454800, -1173827967, -751321286, 985827628, -1398340057, -540706499, 2128137817, 20192782, -1699487287, 566168640, 1312096620, -370912288, -715011839, 487249680, 1460812616, -816380360, 1075567504, -1155211762, 816864175, -1594279291, 1851325670, -831815276, -2100230599, 1723301648, -1140162684, -1452413283, -1685920381, -1033896305, 1852247196, -403625196, -723689823, -1834700881, -342265263, -231756994, -904143169, 1745485984, 120483930, -852100101, 748411222, 447448747, -954486303, 701847575, -538543818, -918829278, -2139498790, -1506672505, 2111051610, 1443710247, 1200325981, -1572494314, -1540796546, -2005169127, 2997382, 880371985, -744888513, 1023623189, 1449442515, -1733494242, 1776091895, 338819953, -1211168513, 768347326, 693188401, -223469257, -402219809, 1843343603, -442232102, -753327062, -1749445765, -1300091240, -1070590639)
"mu" <- structure(c(-4.88936531656459, -4.78859523413736, -5.11293412976443, -4.82889972191399, -5.19304852117762, -4.96072410500308, -5.19216491745182, -2.95507195620857, -4.89330103052346, -4.72804614388435, -5.42915871171826, -4.86797244042026, -5.44153378486353, -4.24838277347807, -5.65056249261298, -2.57349617275887, -5.13164667110811, -4.63830969589135, -4.52576052069002, -4.11423808080416, -5.67051714363817, -1.04659236821028, -4.19528322063682, -1.92288077470532, -3.95317783393054, -1.57368052527749, -4.57986320879199, -1.80337484910689, -3.72428061549528, -0.461608667985699, -5.0650207227148, -1.04617940890656, -4.59573589272631, -3.74259944535382, -3.07096888083195, -0.00977942174423329, -2.51088415238715, -2.60503577061578, -4.08142107339734, -1.84773778695559, -3.69033876927384, 0.806580952291049, -0.336539436763139, -2.82451179789003, -2.9192440567253, -1.77117417041126, -2.84891818685433, 0.312905829051785, -0.411913946033351, -1.57832976581157, -2.72487494503062, -1.01736632715529, -1.83869441128626, 1.41888916809566, -1.13956837365155, -1.21259930427228, -1.01367134088284, 0.468475528514039, -1.11154366083157, -0.794231833066047, -1.2489799754809, 1.81340713536866, -0.566422671062262, 0.316415958717542, -0.523404693146268, 0.251467307402985, -1.64598235292042, 2.92072450991896, -0.169626711818104, 0.123646546353424, -0.765957548774104, -0.477617024358905, 1.50744400246102, 2.87992201482621, 0.754339573772216, -1.49638044490711, -0.0427416305820443, -0.196030982185315, -0.242916267876325, 1.20644013369078, 1.70340592890248, -0.907058342606422, 1.15216212860362, -0.316221882067534, -0.306329286133971, -0.199415498674911, 0.682421991290233, -0.524481795152412, 1.17945484922208, -0.366951649465281, -1.08607692871365, -0.950658480526329, -1.53899979548742, 0.583259456484238, 1.48855888107287, -0.190762794461101, -1.42299513809144, -1.93089813461866, -1.75335576948079, -0.681010005102557, 1.80290643536286, -0.577533210026208, 0.726610738712047, -2.4967276104998, -4.33949366290914, -0.77912216353701, 2.32260897443818, -1.09305556089202, -0.104168620463348, -3.81885397225072, -6.03651008317721, -2.66976176073021, -0.343406880808734, -3.83725356182114, 0.94464267429793, -3.28483288016874, -3.99787017662393, -1.96562684655502, -0.856210632028287, -3.2906840030454), .Dim = c(6, 20))
"tau_obs" <- 1.71711802798328
"tau_proc" <- 0.56655795380459
"y" <- structure(c(NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, -5, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, -5, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA), .Dim = c(6, 20))
".RNG.name" <- "base::Mersenne-Twister"
}

inits{
".RNG.state" <- c(2945, 24540, 19604)
"mu" <- structure(c(-5.06805270144551, -4.98380795651871, -5.08110521916522, -5.17816468512596, -4.9327712060034, -4.98818701311834, -5.12514986852598, -1.76162089846862, -5.1885300660758, -5.26561754305574, -5.51605541340965, -4.31200529503205, -5.71801296944328, -3.02100162802821, -5.76757719197136, -3.65054645881503, -6.47521574274094, -4.27075410006705, -4.11101192536652, -3.34427709390715, -6.54736150442745, -2.06018119104992, -5.21128377073869, -2.75839518551413, -4.24361173404747, -2.32366386517042, -5.46431948398943, -2.03206656887811, -3.96588940109256, -0.211718086421131, -4.71580347621796, -0.412301316019413, -5.22651805375664, -3.71409957997613, -3.58763284341915, -0.426259318926862, -2.84051586652236, -2.54286986987977, -6.4209143609036, -3.20869376720734, -2.40413338062769, 0.658271963756956, -1.26370630781277, -1.56970656036332, -2.84347807016561, -1.85550753123331, -3.68217733372545, 0.0532983664375639, 0.0521305003491801, -2.07700403303893, -2.22587107592771, -1.46801330723306, -2.54258073896551, 1.58432239701418, -0.671378954672501, -1.04452423753655, -2.00017712809567, -0.964690075814772, 0.075863572224105, 0.185478304200107, -0.0661190156770038, 1.85996540467827, -1.35593279189546, -0.396436255865761, -2.11781246654069, 0.930237496213378, 0.146384959834778, 3.89088427943364, -1.52132348104888, 0.058737847453496, -2.07206252441711, -1.77359120800391, 0.118182703554366, 2.77324039486725, 0.592077850935736, -1.49672971319441, -0.562978040885427, -0.286999362496337, -0.760235235479853, 1.72847933091947, 0.939591401420111, -0.64505204059888, 0.59505014274556, -0.469317564896572, -0.189977907882424, -0.0421737115142428, 0.982846532539714, -0.388449133316161, 1.32192034566029, -0.329916392144803, -1.66773409829755, -0.968542403064514, -2.38629335381356, -1.283135736782, 1.71009954607194, -1.29412094214586, -2.03856110144696, -2.07025119727756, -3.12313849835401, -0.784267445710034, 3.06506470768623, -0.463091327655467, -0.619902256266563, -2.67943220377824, -4.22776391448486, -0.979345674278484, 3.56334705148207, -1.73282125362508, -1.59760594156979, -1.97850131990032, -6.27340237147508, -3.7462504328312, 0.0416900551003066, -3.99181751236622, -1.29520556317925, -2.55318977994897, -6.75319398940132, -3.29481067067915, -2.28773762699797, -3.111002260525), .Dim = c(6, 20))
"tau_obs" <- 1.45644385386153
"tau_proc" <- 0.663546772442381
"y" <- structure(c(NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, -5, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, -5, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA), .Dim = c(6, 20))
".RNG.name" <- "base::Wichmann-Hill"
}

inits{
".RNG.state" <- c(237648864, 217424689)
"mu" <- structure(c(-5.19233172596036, -5.01274837067518, -5.0849183637371, -5.08753184109007, -4.97360430057806, -4.96045079133594, -5.36778727156541, -2.69836728343351, -5.12211904119801, -4.84189324520827, -5.45810831773853, -5.02876702871672, -3.31724745060883, -3.82383585445073, -5.61346335596361, -3.13677187034037, -4.98069587257747, -4.73343284296283, -3.69034559242406, -3.31821507028462, -4.84017439418268, -0.972804862069935, -3.09236763065782, -2.49542296084043, -4.40820730453606, -1.58224086461434, -4.42435649422458, -1.5616928770923, -3.47566140146709, -1.20697742637624, -5.81577585601789, -0.219773534382322, -4.65934511746197, -3.78860319272128, -3.23091168982993, 0.961776110617289, -2.70655334314, -1.45149582160393, -4.92891846889155, -2.34689770954367, -2.27813873204984, 0.922195335360183, -1.47536816525337, -3.41190851554201, -1.07232788091455, -1.65800688076109, -2.03203082687391, 1.86170533305984, -1.02418525327362, -2.23899778321966, -1.91612685267471, -1.01395482259052, -1.68822613391213, 1.24598222170949, 0.222152513443814, -1.43308267600085, -1.77325385072657, -0.106419325341346, -1.64587976521098, 0.819481354886114, -0.472327730028941, 2.7194611084481, 0.199763219370237, 0.11870702270302, -1.17629641085367, 1.1590352521702, -3.02086884199338, 3.12278947086446, -0.0911489857692681, -1.45504882897827, -0.996125724238685, -0.452444046919827, 0.479726553224117, 2.4165225006576, 0.707829359105674, -2.50901636796538, 0.71597436884514, -0.645786437285372, 0.204889219817089, 1.6313733167112, 1.87317619534024, -1.20924114900381, 1.30153055504606, -1.18064568555358, -0.171533438018804, -0.4102670388592, -0.813403672937927, -0.00902616793807176, 0.799091025001417, -1.54298624649701, -0.0172325910111846, -2.28010780131027, -2.06688350562509, -0.661558542006353, 2.02667887619676, -0.176216327106317, -0.992268495106868, -2.39815812853614, -3.23015272684005, -0.128364352343879, 3.24073545752098, -1.01087002949519, 1.56358891536937, -3.96999929404756, -3.78823882005048, -1.46593440639719, 3.89809168322691, -2.45713195374894, -1.44961738441579, -3.4859678234997, -4.7650936383429, -3.90095622872605, 0.110299965389442, -3.06884758311948, -1.1642233221334, -3.96499252532207, -4.89206504297525, -4.40916791842531, -0.979183839660579, -2.72109155010145), .Dim = c(6, 20))
"tau_obs" <- 1.49255144220034
"tau_proc" <- 0.55978275370817
"y" <- structure(c(NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, -5, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, -5, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA), .Dim = c(6, 20))
".RNG.name" <- "base::Marsaglia-Multicarry"
}



######################################################################################################
######################################################################################################
#### Data 
######################################################################################################
######################################################################################################

data{
"y" <- structure(c(-4.06591991745718, -2.94665209430014, -5.80914299031403, -5.80914299031403, -5.80914299031403, -5.80914299031403, -4.59783674154387, -1.88686814833501, -4.59783674154387, -5.80914299031403, -5.80914299031403, -4.59783674154387, NA, -4.06591991745718, -5.80914299031403, -2.94665209430014, -5.80914299031403, -5.80914299031403, -3.26053097886945, -3.72054301540761, -5.80914299031403, -1.93466900116998, -3.72054301540761, -1.98486998368036, -4.06591991745718, -2.60726358981506, -4.59783674154387, -0.668845883547919, -3.72054301540761, -1.47248282297889, -5.80914299031403, 0.655974922329534, -5.80914299031403, -4.59783674154387, -3.72054301540761, 0.281988862342713, -2.51565896414186, -2.70811366311588, -5.80914299031403, -1.18037030439171, -2.70811366311588, 1.31661982654987, -1.53614971441768, -2.82028710501947, -1.53614971441768, -2.15263466474332, -2.60726358981506, -0.0653754237762429, -0.589253733521219, -0.711150923698861, -1.8412483567478, -1.25195872848308, -2.51565896414186, 0.543420073956604, -0.211473338919426, -2.21545316410442, -1.47248282297889, -0.696849461552251, -1.01127799732093, 0.265852896722762, -1.03091569138165, 2.75676687558721, -0.168704041457194, -0.382628870687186, -0.615086916013517, 0.535170022761435, -2.60726358981506, 3.57821555646438, -1.75581432451179, 0.163154257134424, -0.833582703939862, -0.53950714937723, 1.18076288241878, 3.79205461642565, 1.4123738990455, -1.8412483567478, -0.60208690792214, 0.8962786165969, -0.013864711444381, 1.55353770544924, 0.869955466752787, -1.27700755822547, 1.06823942041139, -1.18037030439171, -0.576583164939999, -0.696849461552251, 0.0554034869116419, -0.382628870687186, 0.462152453642488, 0.138825724259713, -1.32906996434575, -0.900920880514602, -0.770494290290964, -0.56407113301186, 1.43788878016486, -0.900920880514602, -2.28248391223017, -1.88686814833501, -2.82028710501947, -0.43587591418692, 2.24561904248638, 0.677760368893093, 1.5185224738127, -2.94665209430014, -4.06591991745718, -1.1135661849228, 4.40231277434833, -2.28248391223017, NA, -4.06591991745718, -5.80914299031403, -3.72054301540761, -0.770494290290964, -4.06591991745718, -0.274600501197854, -3.09132676577126, -5.80914299031403, -3.46431559990757, -1.44210761092232, -2.0377249228153), .Dim = c(6, 20))
"year_no" <- c(1, 2, 3, 4, 5, 6)
"season_weeks" <- c(1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20)
"x_ic" <- -5
"tau_ic" <- 100
"a_proc" <- 0.001
"r_proc" <- 0.001
"a_obs" <- 15.37
"r_obs" <- 7.84


}

######################################################################################################
######################################################################################################

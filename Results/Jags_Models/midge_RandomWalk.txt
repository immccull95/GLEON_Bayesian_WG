######################################################################################################
######################################################################################################
#### JAGS model file written by runjags version 2.0.4-2 on 2019-04-10 19:40:20 
######################################################################################################
######################################################################################################

model{
for(i in 1:N){
#this fits the blended model to your observed data. 
y[i] ~ dpois(m[i])
#when comparing these values to the data, we need to exponentiate
m[i] <- exp(mu[i]) 
}
#### Process Model
for(i in 2:N){
mu[i]~dnorm(mu[i-1],tau_add) #mu's here are on log scale
}
#### Priors
mu[1] ~ dnorm(x_ic,tau_ic) 
tau_add ~ dgamma(a_add,r_add)
}
#monitor# tau_add, mu

######################################################################################################
######################################################################################################
#### Initial values 
######################################################################################################
######################################################################################################

inits{
".RNG.state" <- c(-483928918, 2009599433)
"mu" <- c(-2.23698655230056, 0.718274216847387, 3.65363219539751, 1.45471510861064, 3.53436680004891, 4.71804469993378, 6.45500395295365, 7.72430447216018, 5.47230553518429, 4.46315925616279, 8.06809269709811, 6.50231437353387, 6.18809148014352, 5.82584345443332, -0.615744254264315, 2.33249603243558, 4.32374317961603, 3.41803484955383, 6.02304458306012, 4.83932814460003, 6.24814330328835, 4.12863664097967, 7.35712485213524, 4.93906724320945, 3.88827435697856, 4.62438965260889, 2.56970752188277, 4.58441962636369, 1.13042835325881, 3.54576164147874, 3.31083224888788, -0.484887831187195, 1.11774326180721, 0.771257448466328, 1.33826611313105, 0.484352242044098, -0.352626835206266, 2.11862435583124, 3.22370160638301, 4.12925398234418, 4.68712054529207, 3.99639916347096, 2.35910537884485, 6.15479269533067, 5.030858606835, 4.59319743241592, 3.76703246693012, 2.86603818150611, 6.45616178054148, 4.64128986981577, 1.32227566969165, 2.27752995913007, -1.09682043967479, 2.1347356588599, 2.90390578052714, 0.278482212600399, 0.795974624555394, 2.12555274779525, 5.612854268546, 2.14207688015584, 2.45271030006479, 4.29444791381826, 2.82259267621766, 7.64545159731539, 8.52388775721968, 8.73816340480465, 6.53425967875065, 4.43846148426052, 4.11046088367583, 3.18916411439301, 1.77313636521878, 1.41088946071, 1.28803240262752, -2.13407343703789, -5.53928724380257, -6.22315623030859, -2.085511966822, -0.947937513533629, -1.07622783460467, -5.18593394221912, -2.48741548889178, -0.27176915766037, -1.45813724768651, -1.39875217843761, 3.23481021755603, 2.88751471283087, 3.30012933455608, 4.86596562951729, 3.23939224963521, 6.36215270200985, 5.81087084062411, 4.94048023073652, 3.95542725866737, 2.10374902632382, -1.14470222433484, -1.3479437677517, -3.58002581314483, -3.69644316969849, -3.00386049601408, -4.14105680347319, -7.27798350651288, -10.0478100818947, -6.98273632689066, -1.6729467481935, -1.8963780708881, -3.68995708404475, -1.77895260304668, 1.62727368135458, 2.79099942311166, 4.29008522161678, 0.303510797530362, 3.76071076050698, 2.61230628545198, 4.03567303130062, 4.35107556471712, 4.50964337675806, 5.22155397512834, 3.09260639367836, 3.86748540159214, 4.60527370987973, 4.33794857131363, 4.53890407746523, 4.01119683043165, 1.0122427018563, 2.00567407370159, -3.00775520959518, -3.82753247663278, -3.61660100153165, -1.64465179298587, -0.878101346564075, -0.778670359294346, 0.994804722927985, 1.50494021602643, 1.79638547555893, 2.41217427779868, 2.27642641369545, 2.91768702639042, 4.03872445715174, 4.10630883693147, 4.00490957984419, 4.35208234246822, 6.0291425019658, 5.38307329423069, 6.33642215931015, 7.22106781351128, 9.34967859466787, 4.40460732547808, 3.20095128250419, 1.56299080889212, -1.26510377942832, -0.159573975570547, -0.169075135517227, 3.21487900751253, 3.55897916747409, 5.24739212402184, 6.2340113505478, 4.86800969435091, 5.45842712874172, 5.2470748884695, 5.52628479411292, 4.27521401611292, 5.87396753831174, 3.74052619313139, 4.88389370023702, 4.12178385187041, 5.74765653755605, 2.66134638505291, 0.747161599933358, 2.6724403688437, 0.595468827022416, 0.818446776304369, 2.97056411566387, -0.513220186373439, 0.569036029732504, 2.78705306756717, 2.54271994986116, 1.68710920067436, 3.39331189599516, 5.15404042240464, 3.42470484991576, 3.89247340515496, 4.73482079999439, 4.60689828825085, 4.89834367305735, 7.57541464107028, 5.73235706396144, 4.69215062778537, 4.00182577554366, 1.5607437145737)
"tau_add" <- 0.268601699101626
".RNG.name" <- "base::Super-Duper"
}

inits{
".RNG.state" <- c(7, 1130440855, 705839631, -333584062, -1715538429, -881428262, -599608785, -874508007, 428104174, 448579481, 1196433953, 1338166505, 1994890412, -549884218, 1927041641, -1356896974, 296047621, 672465115, 1786993818, 1940429565, 2082854423, 1156972167, -925599006, -1166866718, -163308235, 181136782, 1960838153, 1198595546, -850569923, 758902424, 111977384, -432681159, -744946179, -1019711388, -1346082596, -2078351891, 1215971686, -700447197, -40261091, -1957081858, -2028352748, -1694046966, -551427577, -1225475883, 505075945, -2109725470, 344124804, 636312488, -1733815521, -1758081988, 1483605612, -36124296, 101840311, 1299183916, 1560383405, 1504238679, 1936993139, -129830456, -1728885329, -1238671109, 682371538, -1301756748, -396084060, 91819222, 619819550, -337248960, -783380378, -857299732, -273133426, 559292160, 1755591259, 1950052212, -452074908, 1994398600, 1108256504, 1412109022, -908056251, -1652238241, -1624475203, 433485322, -1765364419, 136626897, 1416214247, -2079266289, 2100681155, 500355389, 1256792229, -535139599, 484285271, -1430734259, 472743591, 2094462904, 331379265, -926808940, 7018467, 1392223071, 195290826, 1458174887, 2144421012, 1522502590, -905129437, -822834220, 1475602958, -1910375070, -956121863, 1400377609, 914060140, -1753278485, 1373598731, 469034604, -864048022, -1476914494, 1313043150, 1864499193, 2142507947, -1204115724, -2024731780, -32455805, -1073619047, 120995674, -1365111811, -1078234615, -1345116315, 2050806600, 1151566556, -1730551199, 115092950, 1807438060, 483099721, 1416895005, 303814708, 986534001, 575806000, -1698111955, 1737647194, 1609683648, 1719084861, -977442248, -411232467, -83609259, 1318981058, -1378337565, 1750246911, -1549734440, 404218741, -1606856155, -1839554351, 1438243403, -513228439, -347205637, 598523779, 901637612, 1185440043, 2053571832, 1796479802, 2079766054, 1479747197, -1592666153, -902670427, 636676793, 1668842320, 1501828190, 133881776, 1239685161, 797307093, 2058676024, 1516653445, 1997436508, -1700441014, 30975793, -212350124, -132683003, -78487994, -2142959609, 1650686474, -836333985, -1379131720, -510313478, -849101732, 318336074, 393426755, 1692001027, -1480241485, -1727200769, 874881398, -97511629, -1331465552, 1124740876, -975226143, 897716268, -21137835, 1160718994, -114392606, -964840454, 1046032069, 1475648107, -1140508672, 1456904119, 42804569, 2099027160, 566476197, -225994611, 1324274421, -1614746773, -170787511, -304672720, 938754692, -769479407, 196627498, 291143610, 833437420, 1384798714, -244171873, -1957372447, -54440632, -891346298, -178742685, 1965432851, 627673382, -1599150652, -640392109, -1641810885, -396942039, 156103806, -1603455467, -977559353, 1413772387, -1541146752, 1695554274, 1153955593, 111557166, -1538093197, -1280407235, -1509240536, 1023939975, -2014823686, -2081847204, -272057418, -2133022326, -1279045400, 528577279, 1365966291, -2124778118, -1111290606, 2081131395, 1867706672, -941484866, -1547344958, -866798826, -61623746, -1003313505, -2080326578, -2127140204, -1294860927, -343234626, 1141019257, -263511447, 2131511240, -1241736725, 1424952686, -199118253, 884574543, -9528407, -418007598, 137034174, 2057855578, 396399559, -1508652914, 448488925, 1389634429, 928275502, -1181088218, -347264128, -1032635620, 359514997, 2141478735, -154044008, 1871104139, -1944045447, 1995204495, -843755958, 329888486, 1645364587, 1948821966, 1884824301, -585235381, 1665986480, -1581698402, -642707365, -2106845243, 2045936245, -1163127991, -361852954, 634927810, -406150324, 1401977421, 709573400, 33222435, 935565264, 130905097, 1283664138, -1351232949, -1712035645, 900091816, 1179455153, 1945498388, 1828983706, -1684922155, 1441854787, 1188782957, -692570593, -29573912, 488318123, -867335349, 605515460, 1242227141, -60942467, 508291304, 1458164536, 1828209912, -1808107242, 147069946, -1927293763, -165406100, 1012318148, 1525112165, 505092348, 1117018128, 1079638209, -560489596, 771101839, 325496028, 309662626, -1798494253, -1015240896, -739746445, 1577768729, 780214986, 1373895185, -599035225, 1966362881, -1696079625, -1620709968, -137414677, 350292923, -21877375, -2140111133, 1029110764, 1557677063, 595590289, 2142370624, -1728941507, -1356895534, -386690027, 293470913, 2133051445, 343728286, -678720229, -215534759, -1571428974, -1312064884, 1353488517, 94733530, 832290907, 828592287, 1335992838, -777320405, -1453711983, 1351870231, 1446697158, -349864788, -1801496328, 1680505694, 151625850, -261988928, 341572279, -1759218605, 171868626, 996941161, -791273861, 965016942, 2060655024, 1162799832, -760606527, -699556168, 2046552774, -985480499, 664048961, 1380556494, -1325673402, 832812983, -11026973, -1658348910, -2103348039, -184280472, -1490705489, -1763448169, 1367987505, -586382751, 1307248640, 747558017, -1204132206, -852818607, 110669036, 382171102, 1805807212, 461072710, -763107381, -543599679, 431732786, -1947758325, -1897377094, 1477254202, 1558492851, 1944622141, -2056909591, 1612205530, -737083011, 305539112, 1797950666, -40296197, -1717065976, -2115133329, 792467211, 1347394777, 2070099184, -1921714222, 1687164396, 2056695195, 682280130, 286548848, -951478569, -869485399, 1376960235, -2129213300, -711224545, -847764653, 1681846014, 1351604203, 2011922944, 1730794900, -1980279270, -1251567800, -1925463051, -248509811, 1298838608, -412593314, -702443425, -2072917910, -305516388, 1800671186, 1756492980, 304206351, -303503458, 704908490, 1024793728, -1054185727, -1888583427, 851579860, 1264839101, 1958675095, -541973044, 938740604, -180442608, 385421760, 11632001, 626644613, 1159938256, 1987153622, -302897867, -1501951234, 58506082, -276160206, -1988293205, 703597396, 526751557, 1521685546, -274137412, 1706242773, 138762662, -85967803, -1790646698, 1272346287, 512629844, -2109247316, -663686494, 860511702, -1242851561, 803473346, -949589856, 472014250, -448842048, 549382135, 255414586, -861546266, -1743857532, -319193525, 991593710, 299504370, -18202424, 1895191861, -1849545946, -1043632646, -588210772, -1355005308, 257431244, -1462775345, 1551964945, -1327605966, 211309919, -1469961177, -1284696630, 1108054359, 1244360449, 1483787183, 1478563321, -1950495115, -1034524828, -1338373793, -449728263, 1173847500, -2144285272, 1064271165, -1643611005, 399978916, 752052397, -1019608400, 1930028887, 2136653181, 1552299322, -243184542, 15652612, 1406598774, -115401641, -1911245095, -488116009, 1010897390, 1564234185, 906593729, -1263143965, 1157878834, 532029853, -969497377, -1818242368, 1377144129, 1392355463, 823504970, -1806901213, -920611126, -1649474189, 1490812152, -1065848074, -698468104, -1480703326, -1489356757, -870149449, -1729136152, 124809757, -391906152, 1625781985, 1501188019, 698374032, -1164777285, 960110331, -406264360, -20160725, -238264219, 382359351, -1740550557, 52378795, -1527564867, 1807463897, -2007444825, -1296216041, -175703972, 1804272453, 367230092, -322091052, -673906097, 775178578, 1832591450, 2127742557, 231637309, -2131853072, -2139791452, -227303972, 501800254, -2131599965, 1507002933, -1182127566, 1195556635, -48389721, 190918772, 1296498832, 2127468359, 294272193, -1076065555, 461569624, 185404771, -1002767320, 258743382, -1340091271, 118378438, 1520327080, 1433953985, -109196870, -2021987552, -771029358, -505825855, -985189014, 1744601218, -661182585, 2019031444, 1847291589, -1337553068, -72335410, -353343964, 1125543636, 747155015, 1395094849, -90332717, -408559225, 806215180, 114198647, -382602843)
"mu" <- c(-2.09380360745757, -0.38769571189556, 3.45075666446015, 2.0284573828964, 3.48869409130407, 4.68490936020339, 6.48934546814232, 7.70636131736691, 5.3647461393858, 4.52517386876711, 8.05808749675876, 6.47221873193553, 6.13211781019088, 5.83476373943531, 0.135376187883672, 1.79971397764366, 4.27562844036215, 3.35233828538218, 6.05086367996629, 4.98323801942791, 6.27617747610674, 4.26950235269044, 7.3957078250556, 5.04973076513143, 3.60800085940688, 4.6788688923674, 3.21833724612578, 4.56130616132926, 0.939861183573797, 3.27874171826449, 3.44475156895628, 0.218028385362943, 1.30761580541836, 1.35655535083949, 1.24969096886118, 0.0143830387149912, -0.778661746391338, 2.11028657866902, 3.67849271760534, 4.58647365237648, 4.67551800776234, 3.92972768039103, 2.03913775517003, 6.11798282072426, 4.80060074092982, 4.28176354504132, 3.69634098018686, 2.35272436696707, 6.50089423036865, 4.49978210917173, 1.59274375781853, 1.85615053000468, -1.9622333253349, 1.67113098751811, 2.89861069456019, 0.523882448587889, 1.50152049578955, 1.88781262479355, 5.66263839663445, 1.88507950997292, 2.49450695644522, 4.01673664892322, 2.46301351861632, 7.73457796958277, 8.54014636082153, 8.75104587948195, 6.51449430690519, 4.42841400047192, 3.96559167010939, 3.1227268091524, 2.01582783659311, 0.690703452651355, 1.40179603626625, -2.25534195615875, -2.48655738724438, -2.00142648895956, -3.11287172551259, -3.66911738892811, -3.42403250396322, -6.10852638290995, -4.13460021260303, -1.65906461444415, -2.1389897591836, -1.5281255746734, 3.25859930740112, 3.32493351152841, 3.28024607159753, 4.7289383879724, 3.13532957740987, 6.43446009231118, 5.90420245677118, 5.05763351604274, 3.90944421673949, 1.92295464842434, -1.83468844378264, -1.58311614525063, -4.91828787035179, -7.75545017181972, -4.94537138679838, -5.1677513027763, -4.079890731961, -2.795802357159, -2.28014829859821, -3.65714376525281, -4.5585349918293, -4.61808401033434, -2.80551836259252, 1.80685754262116, 2.95700877147271, 3.97534373313918, 1.31496873315963, 3.58061677137765, 2.60315022245288, 3.63254238650876, 4.37710502752112, 4.54353011032351, 5.27826726732675, 3.16980795239732, 3.66395898475775, 4.73511151568494, 4.42507859937657, 4.42932736509061, 4.068870453962, 1.71372663090081, 1.5617547205823, -2.3754911831971, -2.82100414965435, -4.28600094634582, -3.81839776191759, -0.937284086892458, -1.18051448595692, 0.963790224492788, 1.38346149115457, -0.452230000961578, 2.26094673851497, 2.31672171713328, 1.76036139397552, 3.96033780159707, 4.35689007825318, 3.76143671984307, 4.52781137657725, 6.05375774526472, 5.38862958941994, 6.3361393107508, 7.18950899584915, 9.36691046955901, 4.3233051354685, 3.55530563631427, 1.76482327946739, -0.65532169619566, -0.0963086957387756, -1.05784632543737, 3.15436579393376, 3.532967303674, 5.15788264394126, 6.29198086439359, 5.01625343200557, 5.46945552787408, 5.1083646879034, 5.54089223619591, 4.5673649531146, 5.84159306205317, 3.71895484918263, 5.08897747434527, 4.21108829838024, 5.59054374080387, 2.55347241719295, -0.146742959125155, 2.85512995474853, -0.904280112411588, -0.927792410241823, 3.06191970241619, 0.336181792951413, 0.429463025736098, 1.97180192249223, 2.64198321836759, 2.51359596110366, 3.33863366214715, 5.43709357768623, 3.83450842855936, 4.10485689283471, 4.68064076319414, 4.66436149886938, 4.76113298416529, 7.62783027333579, 5.64373776267563, 4.51315689300042, 3.89914992806326, 2.16996461275097)
"tau_add" <- 0.27335696143954
".RNG.name" <- "base::Mersenne-Twister"
}

inits{
".RNG.state" <- c(25780, 2677, 999)
"mu" <- c(-2.28507530060964, 0.804493946990688, 3.62917697371599, 2.37027348449516, 3.54596925722529, 4.61040367355095, 6.4847292286146, 7.69871842116835, 5.3688323153537, 4.53835659975499, 8.05559821148005, 6.46459561132814, 6.22251002555202, 5.7806589420629, 0.863928871819485, 2.02145810105476, 4.42570247007614, 3.7396283257148, 6.03303864953588, 4.81219575458172, 6.22323045757104, 4.37719693411403, 7.34127869094622, 5.12676268832675, 3.85832541178945, 4.5639823434062, 2.76114022562629, 4.64098260876561, 1.24048007608824, 3.1793479338655, 3.34316960085348, -0.650119509468578, 0.734150654234225, 1.32161973029519, 1.30409694395184, 1.6961624120222, -0.0728290736562835, 2.77652250552992, 3.47637282728088, 4.38447895083361, 4.76248786581932, 3.7249375921593, 2.15029888127857, 6.08374150877522, 4.81320318195795, 4.54375679448442, 3.80959441774603, 3.05597965805589, 6.46367756620072, 4.80193188498233, 1.4907665988321, 2.82902038562078, -0.203130026556662, 2.08859504784687, 3.12142301384931, 0.518201619264542, 1.21672024990127, 1.88923585432879, 5.61025854276311, 2.44745214862665, 1.92435395285043, 4.17994651833237, 3.18734071543343, 7.68599233159109, 8.54121502237795, 8.72175779607924, 6.47383679014212, 4.25588965374743, 3.82363938077856, 2.93234552447405, 1.95453791919206, 1.26796927658993, 1.91413536789854, 0.569799349178045, -0.311840582548255, -2.45071521877196, -2.59639892220104, -1.22240089448517, 0.49980191166109, -1.16513366405854, -1.47936376511229, 0.129017754300744, 0.538598805855635, -0.70704575379412, 3.47123801341909, 2.91236631560962, 3.44919035998162, 4.87214920096678, 3.42201535211158, 6.33130671201675, 5.90015610876862, 4.81688856531677, 4.14686387511252, 2.28592642094206, 0.531361035208382, -0.0757497204240509, -0.847593156446001, -2.17725853661868, -4.8335700165988, -8.06947386925475, -9.39323252922099, -6.79168992187139, -6.34428980891398, -3.93174413562016, -5.04396238021284, -3.13136337179156, -2.43486651339568, 2.10402649241922, 3.10788165989868, 4.41127315513637, 1.6589158062923, 4.06148702453863, 2.61102280716949, 3.61459710162971, 4.28284608287332, 4.573083943562, 5.11229420081692, 3.21429152382763, 3.87119688963072, 4.60539244707286, 4.51256634603824, 4.46227921216902, 3.81545627743803, 0.962691821647368, 2.01537246281075, 0.631040149482638, -0.192649334523966, -1.37816204316488, -0.726584389394797, -1.45238588793196, -1.47141344287364, 0.900157870399284, 0.999462501826945, 1.89002636863071, 1.75561834945914, 2.50568226951996, 1.97233485152158, 4.13434437498998, 4.40341929568625, 3.95772569843457, 4.49410049932251, 6.09228974161184, 5.47797195409308, 6.37854460977568, 7.24174980447381, 9.35376239089443, 3.94041392034477, 3.35987964111082, 1.64420734746541, -1.0718126183448, -0.0681728823249803, -1.06235659638049, 2.95532137804685, 3.34648080993628, 5.20282718995467, 6.22370638706554, 4.80759562332919, 5.58731187486527, 5.23262215131878, 5.47112459061051, 4.5828900270788, 5.78056400598966, 3.91314803251292, 5.13377744880608, 4.0461325860388, 5.56591947802802, 2.82051576642302, 1.65981266130857, 2.58261970914993, -0.627235451431247, 0.154556139945331, 2.81242731469809, 0.644646687657499, 0.531036313033067, 2.59381418445243, 2.30037081352303, 2.00595464568477, 3.27333604765706, 5.37640454158184, 2.89457819615709, 4.07986719230056, 4.68570348896775, 4.55352874469151, 4.85748330494711, 7.62954938804049, 5.65375366100368, 4.57583032263216, 3.8018088244105, 2.24210706768498)
"tau_add" <- 0.355990705567231
".RNG.name" <- "base::Wichmann-Hill"
}



######################################################################################################
######################################################################################################
#### Data 
######################################################################################################
######################################################################################################

data{
"y" <- c(0, 2, 34, 10, 40, 103, 664, 2293, 220, 93, 3194, 677, 490, 347, 0, 8, 81, 35, 416, 135, 527, 75, 1553, 169, 37, 90, 15, 106, 2, 28, 32, 0, 2, 1, 5, 2, 0, 11, 30, 78, 114, 50, 10, 460, 139, 79, 37, 14, 645, 107, 4, 14, 0, 7, 21, 2, 3, 10, 272, 9, 8, 69, 15, 2226, 5062, 6269, 668, 70, 57, 21, 7, 2, 6, 0, 0, 0, 0, 0, 1, 0, 0, 1, 0, 0, 30, 22, 32, 119, 24, 580, 337, 149, 65, 8, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 7, 20, 72, 1, 43, 16, 40, 70, 96, 166, 22, 39, 96, 80, 91, 46, 3, 4, 0, 0, 0, 0, 0, 0, 3, 3, 3, 9, 10, 11, 51, 76, 61, 77, 411, 224, 595, 1335, 11541, 65, 33, 4, 0, 1, 0, 19, 32, 187, 527, 132, 243, 184, 241, 82, 346, 43, 162, 57, 278, 14, 2, 18, 0, 1, 18, 1, 2, 13, 11, 6, 27, 198, 26, 54, 113, 94, 134, 1994, 297, 109, 54, 9)
"N" <- 189
"x_ic" <- -2.30258509299405
"tau_ic" <- 100
"a_add" <- 0.001
"r_add" <- 0.001


}

######################################################################################################
######################################################################################################

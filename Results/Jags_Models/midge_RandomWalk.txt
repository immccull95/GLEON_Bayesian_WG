######################################################################################################
######################################################################################################
#### JAGS model file written by runjags version 2.0.4-2 on 2019-02-25 11:39:32 
######################################################################################################
######################################################################################################

model{
for(i in 1:N){
#this fits the blended model to your observed data. 
y[i] ~ dpois(m[i])
#when comparing these values to the data, we need to exponentiate
m[i] <- exp(mu[i]) 
}
#### Process Model
for(i in 2:N){
mu[i]~dnorm(mu[i-1],tau_add) #mu's here are on log scale
}
#### Priors
mu[1] ~ dnorm(x_ic,tau_ic) 
tau_add ~ dgamma(a_add,r_add)
}
#monitor# tau_add, mu

######################################################################################################
######################################################################################################
#### Initial values 
######################################################################################################
######################################################################################################

inits{
".RNG.state" <- c(-170818674, -681757409)
"mu" <- c(-2.25883495902188, 0.709766951981436, 3.4036816533708, 2.34829296358508, 3.58734362525766, 4.62804153814253, 6.55250133485058, 7.78950106860226, 5.41508532668485, 4.65140874436929, 8.06836477079026, 6.51336819349725, 6.23021111055584, 5.90656571881319, 1.00357706213003, 2.44832837882613, 4.08993044493191, 3.52093393691705, 5.96391105620805, 4.91356640932571, 6.32828334352593, 4.22536549163995, 7.34107235340493, 5.03682173748001, 3.67551183326297, 4.45111463644075, 3.22095291327756, 4.66230242832149, 1.54074647283018, 3.39287517306031, 3.21114618823706, -0.153338527106786, -0.474408208729178, 0.722969105274115, 1.76496625691052, -0.068172464120992, -0.666650373823807, 2.60608051362949, 3.26394485041813, 4.25249634415658, 4.59461120651486, 3.7235645403949, 1.86470558822497, 6.02993394330058, 4.80172986074377, 4.15725877443556, 3.50239201420156, 2.88474690655034, 6.49673153855122, 4.56233392476652, 1.09580040273714, 2.36875296152763, -0.0493855802807254, 2.15217478378911, 3.05223680230133, -0.201661251304422, 0.505861872440969, 2.03976864605635, 5.60084145856395, 2.14016836154648, 2.07829394326865, 4.50233883292402, 2.80894715186328, 7.68900312553845, 8.54275522268746, 8.74963628457619, 6.449889306014, 4.13328340855629, 4.02392343591634, 2.7936967810566, 1.68080750555023, 1.3739052702244, 0.0855697062550551, -0.220716869410571, -0.414274088215293, -1.08582331911498, -2.61811046992911, -1.73770370473511, -0.0841102680974335, -0.345352669399001, -3.23478011890712, -2.36849809747609, -0.634320283932912, 0.690791296209725, 3.53287435528383, 3.06017389187648, 3.49745099773936, 4.87476992210352, 3.12448666273473, 6.2716857241624, 5.79221516984224, 5.13524741677944, 4.18992100433458, 2.63661833365329, 0.0139463530561103, -0.366830236352326, -2.75987258052685, -2.76918906940342, -4.08659277078584, -3.38428830005222, -2.7952805073157, -4.09627442491772, -3.97946099936493, -3.83621966796424, -1.54324172790102, -1.7006402730466, 0.553366099004414, 1.75756074040198, 2.85728298728298, 4.22603740936302, 1.95215026739063, 3.61478621543718, 2.8463448012827, 3.50284371216001, 4.23270854627439, 4.56331834346214, 5.19439799524097, 3.36234495557231, 3.49582455986732, 4.61242620585737, 4.42307576213471, 4.50921232946161, 3.82225772632389, 0.585264132082506, 1.52342746186409, -1.28156067751332, -1.42906845369067, -3.08051281894266, -3.46207879553094, -1.95128769306586, -1.50798165548109, 0.442231091023563, 1.17655412149596, 1.4336413631045, 1.87581851883084, 2.64319347531952, 2.84387611474456, 3.99336550589804, 4.2779897627293, 4.09852165423591, 4.50395868895628, 6.00856863575151, 5.39759276698884, 6.37145042681678, 7.18051489109627, 9.36935580455931, 3.93589000132746, 3.4621541990188, 0.772392662528058, -2.87766649043131, -0.201646279156563, 0.334489220666634, 3.20290525806251, 3.5960299954866, 5.26517711063878, 6.28842393524214, 4.83413663526501, 5.47126384747067, 5.24085156631933, 5.48807056234575, 4.50967139314529, 5.86545213818724, 3.97520857656818, 5.13943956435686, 3.75888871960806, 5.57550616132242, 2.64389703941438, 1.51297940550285, 3.2323359646241)
"tau_add" <- 0.298292901960729
".RNG.name" <- "base::Super-Duper"
}

inits{
".RNG.state" <- c(110, 1933933472, -1762760581, 1107669919, -1812390398, 625133481, 826888559, 1230775883, -430503237, -43842923, 1217365456, -499529763, 2114432545, 1216767162, -1009889641, -1928868299, 1106935698, -663325088, 5368395, 1506027227, -1187436154, -1620773349, 1703385496, -1714495373, -1743894842, 1015003000, 1716774618, -1375207915, 485664352, -1104630599, -1015587167, 1417563314, -1843758543, 2146013229, 954667817, -790069894, 863892354, -1850878735, -1051124739, 1061900767, -1657406141, -1018308329, 1403990780, 1799834969, 225723624, -390015269, -328103856, 412327188, 670018826, -1089415758, 1896023747, -561360008, 1044994732, 252471208, -1502591613, -762846444, 1062800703, 456490818, -1600210141, -849209555, 272062848, 481215247, -1261842543, 20192535, 1437944515, 724870229, -1258251260, 893140063, 1884029349, 495411988, -424961388, 1108459448, -411369798, 2101654637, 929041925, -643366842, 448600983, 66060642, 1878284377, -1047472985, -1148735169, -1583883966, -515963639, -1022668234, 1534604355, -1711079696, -1993685082, -1630473416, -927815769, -578151688, -2019732236, 1388576290, -41452973, -936789273, -1981887802, 1302527883, 78255931, 977299243, -943027534, 586029654, 68535410, -1571773370, 871658270, -1372119750, 1878904595, 1013663687, -625805196, 2053715084, -823595715, 895308029, 1631959303, 1041337386, -1682585282, 407430040, -1739465713, -2046976148, 1699088619, 1009366723, -1653815787, 2003502024, 725295982, -937257549, -501747208, -659884113, 1898956589, -591563020, -275227383, 2009885895, 502672716, -420690668, 1242664365, -44970284, 1719510645, 1901648929, -940534517, 106006069, -545208751, 1816639496, -1098773128, -420143811, 504924537, 58766889, 861026506, -611550866, -1999672538, -814980056, -1022173205, -1930319110, 634164674, -89348544, -1073805799, 1575562494, -1604732350, 145066569, 2027073702, 1519221752, 1611023712, -301802946, -390951691, -1887962882, 311065299, -967599896, -263090443, 119937553, -1519710947, 608818047, 1251837048, 559385466, -1464917829, 540879641, 36951761, 740300415, 1418653213, -1948032596, -1735012492, 391807865, -2040644429, 831531226, 1199794644, 2029418640, -1488605697, 1807070891, 470855068, -1330839701, -164390638, -1235623264, -862672563, 922202866, 305567529, 1030140778, 306174101, -1635593267, 1719782486, 2030920719, -837908732, 758130858, -1101480284, -1929089256, 1999375869, 1499573953, 890810093, -1071076802, -1368793528, 1830935819, 858257568, 1105188061, 777027015, 702699283, 745787185, 1022575816, -1209493452, -830560437, 757912996, 168604042, 187403760, 715161276, 691675203, -385034183, 8358300, -1015253623, 484953164, 991322002, -244886154, 305662555, 1251595169, 1739213323, 29647400, -9830347, 1662701796, 1337948331, 1532427549, -314208304, 1087712254, -206537784, -2027964972, 1196909730, -951137477, -264725843, -2085998705, -670191195, 255759010, 1998810436, -1483386391, -312748972, 1759814214, 998232278, -1987299319, -1678851773, 1561921946, 1773324053, -1019605974, 832883813, 101809210, 365159756, -1370851800, 760167457, 931385680, 523215188, 2036833694, -1749087309, 531021952, -2039323852, -125183829, -1139506152, 1956593559, 551843412, -103065043, 214757925, 1267120487, -142322043, -682675807, 334071209, -612307182, 1439624844, -810331921, -2104148095, 464651326, -239607314, -645136566, -1636403800, 1279131146, 1599056330, 2008518988, 1807844742, -401995251, 760643182, 851532270, 1792631082, -1879264115, -1869952549, 1150533104, -1621764922, -982661167, 1219418967, 779268537, 1123126343, -1051244073, 1148531325, 1820204059, 65495192, 1967004518, -1113858183, -1828434498, -1261829855, -1503000638, -1371306672, -506305696, -238602699, -17968751, 6804327, 969697262, -318377357, -880614550, 341991428, -1154573065, 1878254393, 1377930466, 1988556377, 546323339, 93835969, -1819766163, 2136354543, -853780926, -280601870, -914786243, -1527041163, 956591399, 1294441810, 1397589176, 1651088847, 1642078100, 357589650, -281610931, -614537286, 1829350799, -314216110, -1052146220, 767585042, 454231632, -1313901604, 1994877007, -676091846, 202716957, -564035550, 718573593, 952303140, -59813165, 68989797, 1367262025, 59262111, 458578969, 1656544179, -348384366, 830128269, 1713714649, 1711549913, -1364962964, -1964550135, -1204870556, -699612008, -1325072545, 189438333, -1785628775, -1391076900, -1386072025, 1266908483, -1351777722, -1944183133, 1549281313, 1315512523, 189328971, 1941632063, 322223149, 1857547414, -1522469220, -1777359385, -301949450, -1385636333, 1066226719, 459491218, -2000564396, 1252049983, -47976072, 1936048364, -1426819496, 1366295218, 552117262, -1639601773, 1698963912, 1800233300, 726785279, 918819656, 641505510, 1316960104, 562378989, 634620417, 1525150406, 1913885914, 1874372358, 1990075042, -1210364861, 1447434985, -2097136955, 969616206, 224040453, -1875131051, -1179386588, 1521479291, 319716883, -1098329749, -2020962481, 539329300, 1228879745, 1625331921, -2060884246, -472436262, -2029882717, -1085685881, -172431835, -1216907923, 2129997307, 1177832423, 1576926932, -712007176, 493973003, 1991803430, 1144349423, -449124736, 549554340, -1887449589, -1327464354, -932709521, 1919116245, 1764175050, -2089354868, 1390344399, 914538905, 970871413, -1359687595, -1445731385, -741371035, -403353663, 137943563, -515154793, -1296507709, 1839565904, -1588839715, -125780249, -2049804429, -1108226334, 959879819, -1928724479, 113504581, 1219648203, 1500611695, -381966785, -2021299637, -723454257, 308999218, -801636790, 935923387, -1787005421, -242172250, -1879581824, -113920851, 683561618, 1841902277, 1857655118, -1964439295, -1073240067, 510255757, 1108708755, -322187146, -581111130, -479874634, -779577846, -1027890089, 1263197842, 1158109106, -1449087185, -1787035605, -1820114712, 984866326, -1840637824, -827904095, 1527332927, 1357601691, 912303411, -760231428, 385862962, -412259867, 38665876, 1720457888, -1582351648, -1719019180, 926419781, -100431392, -2107398882, 523164592, 1603408078, 1370849144, 1670183042, 1739850172, 273742066, 1485705129, -1977203826, -751424356, -1359673489, -548926733, 2080488400, -1339296795, 84565037, 962788054, 1030860592, -694809886, 240643066, 576923931, -1723308740, 1584912187, -1340812184, -445249251, 800903211, 994272239, -1014051090, 1657090044, -1025918799, -1923559282, 1262323141, -1557860546, -1911562702, 524344616, -114038955, 1176312062, -441702251, 2120599180, 656261778, -2012621690, -1074986977, -1439065299, 821008973, -37306310, 576489690, -148741876, -757524386, -1522163354, 1847115917, 238285480, -1916052470, -608172178, 548285762, 1584909492, -714552306, -1828557059, -2005035560, 1142719796, 2085899035, 784791096, 1166618651, -596364497, -703277371, 698252955, 1630516070, 1435756009, 1443427824, -1381377100, -24689499, 2039972998, 1025860976, -827099545, -236126353, 1813148303, 1214941298, -281878030, -845358630, -933708890, -1623453874, 1753845366, -444389525, -924979305, -1048464005, 1584499057, 1295895600, -487508029, 1576960856, -1473619579, 805252932, 1971121770, -1680898339, -673520824, -881366885, 242614250, 1794748242, -460701000, -1931724483, 1093989187, -1721756344, -810304466, -1347933747, -769981805, -1316715576, -2134370783, 1590185265, -959948286, -2116029067, 100683961, 1413963483, -143279240, -833023294, 1991945484, 955578783, 467190053, -716097498, -229294647, 1976072141, 541785636, -1779801902, -1990654656, -177694554, 1240190686, 44699734, -2081045713, 1786370767, -788375924, -1988876807, 196159754)
"mu" <- c(-2.24395431818745, 0.987745880304148, 3.30440426456113, 2.33210955107187, 3.90412768954192, 4.79831818007916, 6.4899365750462, 7.75650737812316, 5.46272456369833, 4.51958660271361, 8.04369508127768, 6.47317891690476, 6.25797153535916, 5.92416907644796, 0.3625937189629, 2.36321652009749, 4.33323185259228, 3.46733461535339, 6.12579880531424, 4.83868726523102, 6.28975247233827, 4.32192895061772, 7.34685196738265, 5.13090523150997, 3.62804075187276, 4.50007553855186, 2.80096801583857, 4.60887300060749, 1.39023705909262, 3.02609121948465, 3.64626994664794, -0.617139386218227, 0.319946535816041, -0.245927743116028, 1.07542152877606, 0.266827438220564, 0.921981462346002, 1.7980191650895, 3.49128468803045, 4.24374860392628, 4.85262310277776, 3.67670816388236, 2.32305833008481, 6.08155777856383, 4.84636476334085, 4.16050104519223, 3.42215603242993, 3.04598092637612, 6.45180395512587, 4.92566101021931, 1.17428648903565, 2.92239671660401, 0.873981014320516, 1.56616221843286, 2.57867143579704, 1.0766804313074, 0.992724774709842, 1.6954438091825, 5.59496101555711, 1.5735333957041, 1.7338642041248, 4.01327856356269, 2.89002061115501, 7.73432422142566, 8.53412436639803, 8.73905123534681, 6.52887996158108, 4.18977572352498, 4.1931040740941, 3.15095988773416, 1.76262521386535, 1.2586746346848, 1.84735563869925, 0.274054762897231, -1.57510784383653, -0.228398972080318, -1.29633708136438, -2.61300518476432, -3.52014745662396, -4.71494573655503, -3.53198595182322, -0.833016653771282, -0.147622365497816, 1.21625813263695, 3.14641528083312, 3.21441915727049, 3.45610050976695, 4.62635556573904, 3.24031037071477, 6.33837438727376, 5.74687523051588, 4.95755572562766, 4.10569342177811, 1.66216901880687, 0.198365072733574, -3.92920098281419, -8.45260102203852, -4.7744943881515, -4.31868607948784, -4.83910056568446, -4.24925959339731, -2.4974668093448, -2.22033412269817, -2.10149446942255, -5.18211293951759, -3.86111599290036, -2.14528577197872, 1.7299235955257, 3.02370684568588, 4.16698768733643, 1.18249740850827, 3.83917858307509, 2.73146376064746, 3.67680226621893, 4.21419522773625, 4.36516796763166, 5.15755424697097, 2.99019709281096, 3.67978148707837, 4.61234977414877, 4.33880448861687, 4.48865027844689, 3.88451731707711, 0.982926053917657, 1.1401424094994, -1.00715091308679, -1.45005048313743, -1.88923898070315, -3.30296699084169, -2.53588988801831, -1.09079148701084, 1.09229770200228, 1.11696042360954, 1.96842593582206, 2.2435236772468, 2.17109212800066, 2.72528296965818, 3.83646010244143, 4.20015309823528, 4.01551280109352, 4.45837695576001, 5.94434129866442, 5.40405020352068, 6.3490691617332, 7.22507184804717, 9.36471605594891, 4.27984494891628, 3.34710392627129, 2.03880329573281, -0.740964640040843, -1.0107341340662, 0.97990602575611, 3.12760963146914, 3.57686417675384, 5.23058825427734, 6.2441615180116, 4.75357062809765, 5.47394231973875, 5.31817584158053, 5.49888716400275, 4.48312336022337, 5.90107651982408, 3.76377092368876, 5.10072486157958, 4.03931846600869, 5.55243754944747, 2.15859807203961, 0.972151833550768, 2.69488899603653)
"tau_add" <- 0.269983116867234
".RNG.name" <- "base::Mersenne-Twister"
}

inits{
".RNG.state" <- c(10191, 5739, 30247)
"mu" <- c(-2.41129160125933, 0.500537142874431, 3.75691046123855, 2.21709021903353, 3.78763041283335, 4.63475728365457, 6.4872119373474, 7.7304663787689, 5.48779970569702, 4.58699565965753, 8.07963311689958, 6.53018356673843, 6.2422523878187, 5.82946504138823, -0.488754533053781, 2.24784906534805, 4.46374397618762, 3.45639063342946, 6.01191667669331, 4.7539931520536, 6.21219200101809, 4.13694843483956, 7.35907930259629, 5.13316336992831, 3.76624153960572, 4.32355271057528, 2.55165470492581, 4.68620299074445, 0.334683008431962, 3.16964578137945, 3.63111443479243, -1.32740637203881, -0.0549283242938301, 0.780735039938628, 1.05755136524161, 0.682678863485208, 0.331721399067799, 2.20721549692331, 3.5698658447288, 4.35475470665386, 4.68492976215154, 3.91150844504779, 1.60844436879816, 6.11022733251297, 4.86330582050562, 4.36822335231574, 3.44344136935994, 2.83608813609673, 6.5053712253997, 4.69463980041795, 2.11049333654061, 2.70870287145024, 0.125422333717266, 2.12032340666407, 3.08526983976532, -0.000622106446598325, 1.67856667599168, 2.20201316677597, 5.50964365560773, 2.45770461513586, 1.28880661382079, 4.30892493412067, 2.4117785297889, 7.6838338021502, 8.54440843283339, 8.73831418549379, 6.49462465529001, 4.13681510483164, 4.3384699613123, 2.93086767404307, 1.70618799738503, 1.27973981557655, 1.79788613481486, -1.83775424631588, -0.0986727161391245, -3.75767931933969, -6.03504096483068, -2.97489364402652, -2.93189125596731, -1.60263709504035, -3.84590888937261, -3.25627983348368, -1.93611463160208, -2.39125782056013, 3.25442699545878, 3.07571179437979, 3.28312955754241, 4.77488826311467, 3.2678975920601, 6.34075683833798, 5.87101966648798, 5.01510319257089, 4.26677608995943, 1.64383248881207, 1.24360917555999, -2.83611699395323, -4.68910756984878, -2.40928842137286, -4.42760785252993, -4.50012937911894, -4.54589344161123, -6.88816857600783, -4.07645936198999, -2.89214621121439, -1.21134844739721, -1.44324593634603, 0.0192543260149614, 2.3266247182256, 3.08198604661309, 4.2465977650729, -0.437027031822447, 3.92191051330742, 3.09104896797617, 3.74719760782523, 4.29449514997989, 4.39279912660159, 4.99245378150911, 2.78029641881879, 3.80592418457697, 4.49897080854338, 4.38606116566547, 4.42104340291804, 3.8945402659572, 1.70127304695703, 0.833777685916089, -0.903269520981242, -1.30351645426136, -3.78722204470084, -3.51535407373411, -3.85916021760744, -1.2390300207028, 0.769506714137953, 0.972251451883634, 1.55641657541183, 1.75829835801883, 2.29178896465028, 2.62232791889331, 4.05798817496708, 4.51957014616585, 4.122599439917, 4.40035692311809, 6.05723903131976, 5.43414381688159, 6.46799313234261, 7.19180724939541, 9.3499195378027, 4.09291337401876, 3.73281600159673, 1.10055613797569, -2.5492949932671, -3.49861119134524, -1.97319479437392, 3.00636152473352, 3.26850047950992, 5.22568862691836, 6.23191760629441, 4.81073833769756, 5.53775666890869, 5.18675905801312, 5.54398066807741, 4.31610044651465, 5.99800963777394, 3.71862639737516, 5.03813558606838, 3.95512294906273, 5.46262929797685, 2.57358926806705, 2.20455268652542, 2.93014493963265)
"tau_add" <- 0.20468079483734
".RNG.name" <- "base::Wichmann-Hill"
}



######################################################################################################
######################################################################################################
#### Data 
######################################################################################################
######################################################################################################

data{
"y" <- c(0, 2, 34, 10, 40, 103, 664, 2293, 220, 93, 3194, 677, 490, 347, 0, 8, 81, 35, 416, 135, 527, 75, 1553, 169, 37, 90, 15, 106, 2, 28, 32, 0, 2, 1, 5, 2, 0, 11, 30, 78, 114, 50, 10, 460, 139, 79, 37, 14, 645, 107, 4, 14, 0, 7, 21, 2, 3, 10, 272, 9, 8, 69, 15, 2226, 5062, 6269, 668, 70, 57, 21, 7, 2, 6, 0, 0, 0, 0, 0, 1, 0, 0, 1, 0, 0, 30, 22, 32, 119, 24, 580, 337, 149, 65, 8, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 7, 20, 72, 1, 43, 16, 40, 70, 96, 166, 22, 39, 96, 80, 91, 46, 3, 4, 0, 0, 0, 0, 0, 0, 3, 3, 3, 9, 10, 11, 51, 76, 61, 77, 411, 224, 595, 1335, 11541, 65, 33, 4, 0, 1, 0, 19, 32, 187, 527, 132, 243, 184, 241, 82, 346, 43, 162, 57, 278, 14, 2, 18)
"N" <- 169
"x_ic" <- -2.30258509299405
"tau_ic" <- 100
"a_add" <- 0.001
"r_add" <- 0.001


}

######################################################################################################
######################################################################################################

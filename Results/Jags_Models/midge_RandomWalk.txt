######################################################################################################
######################################################################################################
#### JAGS model file written by runjags version 2.0.4-2 on 2019-03-04 11:14:06 
######################################################################################################
######################################################################################################

model{
for(i in 1:N){
#this fits the blended model to your observed data. 
y[i] ~ dpois(m[i])
#when comparing these values to the data, we need to exponentiate
m[i] <- exp(mu[i]) 
}
#### Process Model
for(i in 2:N){
mu[i]~dnorm(mu[i-1],tau_add) #mu's here are on log scale
}
#### Priors
mu[1] ~ dnorm(x_ic,tau_ic) 
tau_add ~ dgamma(a_add,r_add)
}
#monitor# tau_add, mu

######################################################################################################
######################################################################################################
#### Initial values 
######################################################################################################
######################################################################################################

inits{
".RNG.state" <- c(136725326, 230875493)
"mu" <- c(-2.29964677092945, 0.943844197746583, 3.51846963581611, 2.45963730613261, 3.59166299809226, 4.7445983563235, 6.50805305014898, 7.75279463795736, 5.34999139453503, 4.41097243423089, 8.07880199044083, 6.52211566573018, 6.13665856689826, 5.86053400353725, 0.430354492078748, 2.58282498544893, 4.41806776171242, 3.59463204426757, 5.98415342775279, 4.91343206041508, 6.21675458067094, 4.09938052599965, 7.3394786320675, 5.01071723626386, 3.68871547322716, 4.31616803615076, 3.21386465563783, 4.71515075386309, 0.160795224113053, 3.35755821084385, 3.16149813151262, 0.13957565369789, -1.13971071970059, 0.120979891936045, 2.08956471670969, 1.00171308201915, 0.0380742251821751, 2.01197659523113, 3.43117653052892, 4.27496877474366, 4.7529523666063, 3.94674144937372, 1.97360360003725, 6.12732741348792, 4.99496436315487, 4.29638974472553, 3.46761671041367, 2.66942176311568, 6.43615299162588, 4.43275708450265, 1.69235766331112, 2.7874888946506, -3.23960554483837, 1.87623281941439, 2.56560674132916, 1.41447267155764, 1.07189734869994, 1.94260266070595, 5.54147193345405, 2.33657223667417, 2.47772778925748, 4.33772589097797, 2.43774570233986, 7.71062679611447, 8.52470157341432, 8.76272571516708, 6.53865478302395, 4.21088403573895, 4.23815693180993, 2.96545522612691, 1.44492143545941, 0.433309760556332, 1.9740541524951, -0.711190898317731, -3.28022686037614, -4.33657809706736, -4.89110996734157, -2.26307083287976, -1.89926010534982, -2.66242909066535, -1.85839495604415, -2.19307741826285, -0.479400356852071, 0.680689186676715, 3.47517313419204, 2.81551955736923, 3.49888545860038, 4.8673154141072, 3.38566296266933, 6.44371373656317, 5.6996317680882, 5.01651907680553, 4.19668892269398, 1.87115601718257, -1.30855127024771, -3.16802680341167, -5.48561059284827, -4.58986521434784, -6.32019246909051, -6.50299541573742, -5.25848360595382, -6.87398372121395, -7.73584831115458, -2.43082773304416, -3.14940102331223, -1.02348163373245, -1.56170284956186, 2.08600827350626, 2.7919326586877, 4.06586087879394, 0.498975364847831, 3.94044048086196, 3.11568434265826, 3.94184747700586, 4.22721785498467, 4.49014365043674, 4.97081345715921, 2.92965022837281, 3.78789734803528, 4.46655291471998, 4.35701866900021, 4.48727462110405, 3.83901550340166, 0.773351593553601, 1.44220405391562, 1.11586496593678, -2.114666405971, -5.3826187979288, -4.57992587055835, 0.835586641815564, -1.08514716316922, 0.202747728558865, 0.29524968195181, -0.445140242158937, 1.619840876211, 1.75039300910375, 1.75291779882829, 3.96145990017312, 4.24692559552339, 4.14356491840236, 4.41542482936876, 5.9724636990616, 5.4490365370322, 6.36119148949339, 7.22035503085988, 9.35176179951333, 4.2363485013088, 3.41114507628292, 0.711964825060539, 0.0451490596650843, -1.00427627408095, -0.695240000511358, 3.10047323126428, 3.28051468080976, 5.2418293462685, 6.30059431530339, 4.86696813394239, 5.51452378872612, 5.22287420732691, 5.33806670899438, 4.42191529524366, 5.76182507238753, 3.5827258815271, 5.01746065671045, 3.89268754542046, 5.62839894297082, 2.75835262451653, 0.47421854602403, 2.61087367026657)
"tau_add" <- 0.206356051679
".RNG.name" <- "base::Marsaglia-Multicarry"
}

inits{
".RNG.state" <- c(-171316238, 1450120343)
"mu" <- c(-2.25344557375395, 1.5424749959754, 3.93576414376556, 1.876357786203, 3.59416265064721, 4.55781543456181, 6.49737631003875, 7.73883273500251, 5.33881698584982, 4.5699552745458, 8.10515320441029, 6.55226684476945, 6.18356238452649, 5.8652852640771, -0.605502415036255, 2.23440486519338, 4.24623757336371, 3.25034608383259, 6.06569441399677, 4.85429073425396, 6.2636015975677, 4.19484081514505, 7.32584819181895, 5.01738744714246, 3.55582394093174, 4.50641328804933, 2.36382270207439, 4.75480210291384, 1.35109188506815, 3.3370987417366, 3.72568408608497, 0.881267401143631, 0.77920478985361, 0.804936343638968, 2.12800585175615, 0.0428085921326452, 0.699631128079055, 1.99290900230957, 3.55174208589912, 4.33057479265565, 4.94455025969361, 4.25519621090509, 2.21879301310842, 6.10150957746772, 5.10027467931278, 4.46386769519874, 3.40581112897746, 2.23675606847041, 6.52418734369833, 4.66206902641065, 1.60911853109243, 2.59263542197917, -0.679433533450255, 2.03163400219991, 2.67553898445071, 0.823003045875687, -0.944591567576802, 1.97927793764864, 5.51185646284005, 2.64000072434849, 1.95838153618466, 4.23001347484687, 2.96108685943147, 7.73948244050853, 8.51438107674151, 8.73101449896787, 6.44818494353088, 4.0004625568781, 4.08385194222331, 2.96796943567459, 1.98716964128517, 1.15384740004077, 1.03654461802124, -3.32778048495773, -1.7492047577226, -3.44056454181016, -2.33288993127644, -2.49420995107713, -1.99013802253306, -3.23968081528104, -2.90459830800508, -3.01547272416675, -2.24777344409707, 0.955694960843247, 3.49516209472091, 3.2931996573915, 3.47468070106053, 4.7773046649491, 3.44898520407237, 6.39303812265744, 5.74731259947601, 5.01585628365203, 3.97136354826005, 2.13907057453407, 1.29048964469896, -1.82918994260317, -3.28830388147758, -4.41931649467372, -5.08550021307116, -4.12788998551558, -3.59858950631149, -2.98002638116076, -3.25708355040114, -2.57148790615946, -2.00536006321982, -0.326115423590617, -1.03596057125727, 2.17106593529575, 2.8506551089263, 4.41506664604255, 1.13378760167535, 3.81204115932417, 2.69477800686565, 3.79028074391142, 4.30108008838325, 4.3626412559386, 5.03337684545934, 3.32079329807625, 3.63278537146721, 4.59005330638581, 4.28640776305119, 4.62619718307364, 3.92189284324721, 0.737723327349504, 1.20091816485417, 0.713637870442311, -0.683681235776657, -1.32107974828163, -2.19954442990209, -0.620009201205459, -0.965984352616604, 0.665640200354661, 0.889753285062766, 1.4886789008371, 2.42194147587515, 2.25040971915676, 2.69970263044048, 4.05951581289155, 4.36918709591667, 3.92722386713249, 4.17824761731895, 6.04062196173716, 5.37931932438531, 6.422528949616, 7.15485372837511, 9.35532745012006, 4.26913390809322, 3.32317614922173, 1.21300308005139, 0.462815201062023, -0.168973113193074, -0.0282696603386343, 3.1628418654728, 3.38270677779927, 5.20062322574501, 6.32625189296293, 5.04828263612482, 5.4555248641237, 5.23047994702692, 5.503597195118, 4.67316852258467, 5.80315427337071, 3.58704898938799, 4.9822394216454, 3.98483655028164, 5.66471925780812, 2.77336671536133, 0.80767901088307, 2.81063784474656)
"tau_add" <- 0.30559004646262
".RNG.name" <- "base::Super-Duper"
}

inits{
".RNG.state" <- c(457, -1243801642, -1046451101, 735058500, -1145046116, 1828447050, -58731905, -1225441846, 307964841, 550614076, 60573802, 172244547, -1035869236, 78664922, -981898443, -1702689158, 304937112, -1206319886, 1834258777, 2010138664, -1464813628, 2141812575, -1445837143, -198763114, 185151435, -1287896595, -1810326654, 1136749487, 919812920, 2121489886, -513598857, -316349572, -1833672338, 707613904, -196679943, -1427847822, 2067461618, -111348962, 1280241332, -1534749955, -2090460728, -1864789355, 1603167904, 1746057144, -1868760686, -1060120412, -642439920, -1082139230, -892571573, 437041082, -139439920, -248380667, -1579154822, 306778607, -1009704816, 1790966250, -524464930, -1844105752, -588711906, -168545338, 2077024258, 792658690, 1152897187, 1796376072, -1984598062, 729011910, -1050528040, -864511179, 489254092, 1519302242, 1370913067, 918037807, 113399168, 1351283955, -1098235423, 306128069, -358710299, -1645804923, -627383398, 341610764, -1963018052, -2119433052, -127420456, -88626734, -2139855508, -1940057078, 1688169742, 896218173, 1764710973, -1048335937, -110491670, -666019671, -2047417908, 1408090742, 689120619, -1211795244, -590529970, -456866541, -949238989, -401567824, 580512380, -1907812672, -2124512413, 1791227786, -1691519771, -327959206, -1173954005, -246534625, 533127818, 1308997449, -1434755665, -538331840, -368385178, -1395272951, 465073694, 92253415, 2144999325, -198980234, 921059472, -1552132983, -1869413297, -888520385, 1532861157, -1351362883, -1732998945, 977128361, 233565581, 1035584648, -186519284, 1696415415, -266400302, 470270903, -184511634, 1405300398, -559591569, -602171322, -1032985565, -1879078949, 1874291338, 2143855263, 392400319, -1791858281, 558764445, 1885531125, -2035551242, -1791289184, -1128908543, -1323459646, 955680917, -1402290478, 1511314674, 658251740, -162003099, -2095463235, 697586522, -1878690713, 2112750569, 1188724281, 2097926586, 1635138571, -1449821404, -1065820387, 794864846, 1796440623, 435729123, -1520667094, 1139495262, 611356893, -1876565074, -1526407274, 778459883, -1787907270, 438710269, -581999881, 1021213647, 559486877, 1737650830, -92472773, 690238522, 1043500848, 1688928578, -1006038430, -49950530, 1319099337, -1589913823, 15488184, -24760312, 925395067, -726563649, -1542239505, 1900307883, 217091070, 708669079, 744198053, -506257244, 1056692921, -2034635626, -241176963, -1139861381, 452981919, 38397409, 668496235, -1411290923, -1126652003, -1337942635, -557962651, -2033190726, 37968189, 505575805, 260384310, 570930970, -693243732, 1301602517, 878594162, 1533254951, 810093838, 921844172, 1599709408, 1320225787, -1648139849, 2098313157, -1832271848, 1446970947, 245141004, 945842323, -936828243, -415825745, 40874387, -260625990, -1114228811, -1350184881, 1635012472, -1802815908, 685835079, -208538175, 1613450652, -1482634303, 1725216769, -231167109, -509368300, -1455116704, -811254988, 1626344694, -183404650, -2053513814, -1644299909, -1651530965, 313693295, -72047114, -195023274, 1514296010, -1600458753, -1862563212, 1334596587, 1210344210, 762348548, -470906419, -501020552, 1445809042, 882219029, -772876008, 1389783728, -335682103, -2054796152, 1385728015, 1096223191, 76678516, 438386211, -653343264, -1437406258, -1587566297, 463099552, 1018910806, 444223753, 1492527837, 1631645219, 673210588, -220957590, 44485071, 2114658419, -795083335, -1863265062, 569913808, 1054166215, -786757560, -2075099958, -957711238, -1289318132, 111972907, -1192730741, 1340935135, 2004085293, -385472552, 1268380207, -350940197, 1457966117, -789896380, -1862888351, 1769798168, -1227255488, 177685462, 553866060, 1322627032, -1200527462, 1534154495, -1651959790, 544711883, -1679846135, -1253364917, 16737056, 1373435063, 1232575771, 2107610100, -1251803918, -892510051, 1113151884, 1720822064, -1338590233, 1512409219, -2100137345, 1144255819, -207607265, 637634942, 2027938824, 302953104, -1704844910, -1519764148, -1748209425, 1570988829, -1155381122, -415113079, -200188776, 14988664, -1356429000, 21016362, 1193818536, -2141051118, 924162224, 976634761, -11565078, -1121186229, 2018338609, 1728974850, -1339193386, 2036525808, -822601528, -1780659903, 626773151, -949946768, 838951891, -260142779, -2005833233, -1842058421, 114750708, 1912998574, -232227133, -925904813, 1980295799, -1935051032, 371141021, -1842470207, 687115315, 1437389050, 172157963, -48610321, 436809011, -599613684, -584844655, -441337722, 882863605, -723122897, 662826259, -1283047247, 1372180537, -1660906416, -455045021, -2056137523, 422595675, -1832385499, -1612131550, 2129379852, -1318626978, -531787244, -2061026289, 2018181241, -657915084, -1133009939, -1867486185, 1389791878, 770449499, -1608728822, 1731323843, 1392002811, 452845740, 1682737365, -1580272871, 1224280290, 531560986, -595469123, -647638379, -518608525, 1265735058, -2144867503, 1372578675, -1381026079, -786491413, -1913506376, 1557287802, 1705572961, 1178985327, 1536858441, 522716432, 1406412243, 1882986685, -164921701, 880548421, 1846089092, 166276572, 1174410794, 170637623, 1949056097, -280878665, -678563637, 1331219276, 2147033490, -128123800, -1633339447, -1873245907, 1824982925, 1773330864, -312639560, 1491082852, 1537275017, -1223152563, -1503771096, 557133054, -1371666877, 499784238, 1729894915, 32443205, -1856003060, -1170132851, 1544412545, 1059186377, 944049348, 1674421614, -1672455785, -1583327929, -709614314, -19099339, -854069919, 259254491, -1433668707, -2112682805, 733900254, 2067396343, 169575062, -834161418, 1691158417, 1922139937, 1547860243, -304741367, -1519904675, 1238826488, -766367457, -2020317327, -993444304, 628696441, -1369589613, 1467982847, -1670103781, -1104082836, 1078069552, 1304407038, -807466349, -1192645196, 941436561, -1522149632, 1166502030, 213239799, -1163260765, -603849186, 1556715352, -1973299355, -332269551, -882331292, 2132299714, 2000604569, 2006699214, -971080621, -1257493307, -481929341, 804973060, 1905649420, -1446585115, 1498964516, -1771238655, -1068020281, 2010500470, -225315212, 257581946, 591724418, -522426433, -311463935, -38706609, -1984483266, -1745103784, -1771351056, 687722488, -1255697272, 69454392, 1547826337, -675147488, 973139569, 1652842696, 1519078373, -1865588107, -2066567575, -2071390008, 593129886, -1966214447, -1803365422, -286778203, -103200712, -1656324290, -255121448, 918892525, -1896856337, 239181165, 588433564, -157923831, 215761742, 1956993561, 462940952, -1301467769, -1880405580, 1916336354, 1846067612, 36137103, -1553815807, 1321161117, 1028331028, -1415284476, -206512009, -337801020, -1716910218, 150722631, -477269450, -689593079, 1812719517, -199189971, 1308175222, 364047070, -521850891, -1813137658, -1498047960, 489877936, 1114165483, 918642677, 1529435876, 628437102, 1172786816, 37114884, -552769424, 357792421, 1050596779, 1546448138, 1559703441, -500468893, 158746846, 1933554428, -447215629, 1886288354, -1918495336, -2017906439, -1952567516, -1626185931, -828634714, 813335515, 2098633601, -2018963359, 19791304, -909982805, -2023680384, 2060932256, 356108712, -1547546499, -206122527, 732932559, -1641831867, -232246996, -1829168676, 1243530677, 1455617586, -1111775255, 394422230, -801714688, 608805070, 123141632, -1531690046, 953731127, -671551227, 1395903610, 1723034394, 2069711258, 1676679662, -1906949823, 219006139, 1788867041, 736132944, 61868446, 1907616846, -1602132225, -658855706, -1729597959, 1602506176, -1810889154, -1222859581, 1513262893, 265794923, -1747751533, -374707433, 463392279, 1291005384, 1161851377)
"mu" <- c(-2.22938280827068, 1.26623783444447, 3.29705033957704, 2.5346880374235, 3.68014913474659, 4.68812700750801, 6.38792664926887, 7.73969369910016, 5.33170663515287, 4.34897843498934, 8.05677695069042, 6.57690591339888, 6.21376772701212, 5.88726149563035, 0.210048603498409, 1.95734792347609, 4.21106757131304, 3.45465468299559, 6.07006634169928, 4.74257833328056, 6.32625887737514, 4.30877224690666, 7.35204312288014, 5.23954930744009, 3.72916131111892, 4.54777333139883, 3.02771972063704, 4.75868670218583, 1.20519524304535, 3.06830840552629, 3.31355494484101, -1.14485981903169, 0.622920978245437, 1.15738139788178, 0.802192448780487, -0.684777731264017, -1.13166319417121, 2.74938668713593, 3.56212551310767, 4.35663172040792, 4.65754624631812, 3.81099854627105, 2.22820492146703, 6.18142461964542, 4.84086648725913, 4.18768888835741, 3.65834671330224, 2.6450029643043, 6.47008476154333, 4.58974421287754, 1.45811727823293, 2.84966170140547, 0.686979098435001, 2.38229287504156, 3.12383921295568, 2.23858337601627, 1.44463890113523, 2.50885933633513, 5.55604475467269, 1.96790800205341, 2.17828859206249, 4.11582101673224, 2.88821171243979, 7.70502728910046, 8.53591853515424, 8.72770059139015, 6.46672264052333, 4.33686077855045, 3.73609359655072, 2.7324210154087, 1.17596126100033, 1.97366497077558, 0.453880132984523, -1.28108594262286, -2.20784075496667, -2.70582066005148, -1.1412300966987, -0.8009311963538, 0.622032058538514, 0.00125809312605885, -1.68026831255804, -2.81199605733847, -2.58977553196394, -0.160920443322869, 3.04506142183278, 3.42469104395054, 3.4273618657354, 4.90564944795642, 3.37816965465138, 6.31561278151329, 5.86596571001144, 4.79566742958611, 4.52061064581884, 2.31183278373781, 1.06867538971945, -4.08758646342025, -5.52584314497382, -6.59111110929541, -7.13190767135614, -7.19158437904619, -7.32781669322669, -5.51587331012695, -3.3950874523966, -3.17840143116216, -3.39396833503459, -1.19423183245801, -2.27377398828224, 1.72370354893591, 3.01274660817576, 4.20068915003372, 0.350834248268019, 3.59838891592655, 3.10794999251981, 3.20209309106221, 4.05840926547957, 4.44216595312417, 4.98088748465731, 2.94770496943899, 3.95059023448699, 4.70657097783146, 4.3986175936635, 4.59090446092991, 3.85881046079384, 1.56478712055276, 1.19587295876161, -0.691127474454062, -0.866477762550084, -0.772309040088125, -2.43563082311485, -5.74406962662822, -1.74946688798906, 0.783741441810145, -1.26702736170666, 0.574107942271397, 1.51295772025659, 2.11968329474829, 2.20921663143699, 3.6365563052223, 4.14682295973492, 4.06775355900341, 4.591979587549, 6.06179824232582, 5.38657780517645, 6.41051205311351, 7.16271783770389, 9.35934535758291, 4.25094604486347, 3.3521038228798, 1.36025140019692, 0.251506945404369, -0.817214361550844, -0.0520196504319269, 2.71591198399355, 3.6370331981077, 5.09411254790113, 6.3109078908671, 4.68200139608722, 5.63007434411472, 5.28099675503284, 5.4291396011822, 4.45046171455164, 5.85688531107815, 3.71041933348413, 5.0007907805917, 3.9477018015148, 5.65563655066617, 2.49975110868203, 0.720611431209912, 2.75827879980953)
"tau_add" <- 0.294052283504456
".RNG.name" <- "base::Mersenne-Twister"
}



######################################################################################################
######################################################################################################
#### Data 
######################################################################################################
######################################################################################################

data{
"y" <- c(0, 2, 34, 10, 40, 103, 664, 2293, 220, 93, 3194, 677, 490, 347, 0, 8, 81, 35, 416, 135, 527, 75, 1553, 169, 37, 90, 15, 106, 2, 28, 32, 0, 2, 1, 5, 2, 0, 11, 30, 78, 114, 50, 10, 460, 139, 79, 37, 14, 645, 107, 4, 14, 0, 7, 21, 2, 3, 10, 272, 9, 8, 69, 15, 2226, 5062, 6269, 668, 70, 57, 21, 7, 2, 6, 0, 0, 0, 0, 0, 1, 0, 0, 1, 0, 0, 30, 22, 32, 119, 24, 580, 337, 149, 65, 8, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 7, 20, 72, 1, 43, 16, 40, 70, 96, 166, 22, 39, 96, 80, 91, 46, 3, 4, 0, 0, 0, 0, 0, 0, 3, 3, 3, 9, 10, 11, 51, 76, 61, 77, 411, 224, 595, 1335, 11541, 65, 33, 4, 0, 1, 0, 19, 32, 187, 527, 132, 243, 184, 241, 82, 346, 43, 162, 57, 278, 14, 2, 18)
"N" <- 169
"x_ic" <- -2.30258509299405
"tau_ic" <- 100
"a_add" <- 0.001
"r_add" <- 0.001


}

######################################################################################################
######################################################################################################
